"use strict";var Du=Object.create;var nn=Object.defineProperty;var Iu=Object.getOwnPropertyDescriptor;var Wu=Object.getOwnPropertyNames;var Fu=Object.getPrototypeOf,Nu=Object.prototype.hasOwnProperty;var nr=(o,t)=>()=>(o&&(t=o(o=0)),t);var G=(o,t)=>()=>(t||o((t={exports:{}}).exports,t),t.exports),fi=(o,t)=>{for(var n in t)nn(o,n,{get:t[n],enumerable:!0})},ci=(o,t,n,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of Wu(t))!Nu.call(o,a)&&a!==n&&nn(o,a,{get:()=>t[a],enumerable:!(s=Iu(t,a))||s.enumerable});return o};var at=(o,t,n)=>(n=o!=null?Du(Fu(o)):{},ci(t||!o||!o.__esModule?nn(n,"default",{value:o,enumerable:!0}):n,o)),qu=o=>ci(nn({},"__esModule",{value:!0}),o);var mi=G((on,hi)=>{(function(o,t){typeof on=="object"&&typeof hi<"u"?t(on):typeof define=="function"&&define.amd?define(["exports"],t):(o=typeof globalThis<"u"?globalThis:o||self,t(o.WebStreamsPolyfill={}))})(on,function(o){"use strict";let t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol:e=>`Symbol(${e})`;function n(){}function s(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global}let a=s();function l(e){return typeof e=="object"&&e!==null||typeof e=="function"}let f=n,m=Promise,c=Promise.prototype.then,h=Promise.resolve.bind(m),b=Promise.reject.bind(m);function g(e){return new m(e)}function w(e){return h(e)}function S(e){return b(e)}function y(e,r,i){return c.call(e,r,i)}function T(e,r,i){y(y(e,r,i),void 0,f)}function P(e,r){T(e,r)}function A(e,r){T(e,void 0,r)}function D(e,r,i){return y(e,r,i)}function q(e){y(e,void 0,f)}let I=(()=>{let e=a&&a.queueMicrotask;if(typeof e=="function")return e;let r=w(void 0);return i=>y(r,i)})();function M(e,r,i){if(typeof e!="function")throw new TypeError("Argument is not a function");return Function.prototype.apply.call(e,r,i)}function W(e,r,i){try{return w(M(e,r,i))}catch(u){return S(u)}}let ce=16384;class Y{constructor(){this._cursor=0,this._size=0,this._front={_elements:[],_next:void 0},this._back=this._front,this._cursor=0,this._size=0}get length(){return this._size}push(r){let i=this._back,u=i;i._elements.length===ce-1&&(u={_elements:[],_next:void 0}),i._elements.push(r),u!==i&&(this._back=u,i._next=u),++this._size}shift(){let r=this._front,i=r,u=this._cursor,d=u+1,p=r._elements,_=p[u];return d===ce&&(i=r._next,d=0),--this._size,this._cursor=d,r!==i&&(this._front=i),p[u]=void 0,_}forEach(r){let i=this._cursor,u=this._front,d=u._elements;for(;(i!==d.length||u._next!==void 0)&&!(i===d.length&&(u=u._next,d=u._elements,i=0,d.length===0));)r(d[i]),++i}peek(){let r=this._front,i=this._cursor;return r._elements[i]}}function Er(e,r){e._ownerReadableStream=r,r._reader=e,r._state==="readable"?Bn(e):r._state==="closed"?ul(e):Xo(e,r._storedError)}function xn(e,r){let i=e._ownerReadableStream;return me(i,r)}function ve(e){e._ownerReadableStream._state==="readable"?On(e,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")):fl(e,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")),e._ownerReadableStream._reader=void 0,e._ownerReadableStream=void 0}function _t(e){return new TypeError("Cannot "+e+" a stream using a released reader")}function Bn(e){e._closedPromise=g((r,i)=>{e._closedPromise_resolve=r,e._closedPromise_reject=i})}function Xo(e,r){Bn(e),On(e,r)}function ul(e){Bn(e),Jo(e)}function On(e,r){e._closedPromise_reject!==void 0&&(q(e._closedPromise),e._closedPromise_reject(r),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0)}function fl(e,r){Xo(e,r)}function Jo(e){e._closedPromise_resolve!==void 0&&(e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0)}let Ko=t("[[AbortSteps]]"),Zo=t("[[ErrorSteps]]"),Ln=t("[[CancelSteps]]"),Dn=t("[[PullSteps]]"),es=Number.isFinite||function(e){return typeof e=="number"&&isFinite(e)},cl=Math.trunc||function(e){return e<0?Math.ceil(e):Math.floor(e)};function dl(e){return typeof e=="object"||typeof e=="function"}function Ae(e,r){if(e!==void 0&&!dl(e))throw new TypeError(`${r} is not an object.`)}function de(e,r){if(typeof e!="function")throw new TypeError(`${r} is not a function.`)}function hl(e){return typeof e=="object"&&e!==null||typeof e=="function"}function ts(e,r){if(!hl(e))throw new TypeError(`${r} is not an object.`)}function ke(e,r,i){if(e===void 0)throw new TypeError(`Parameter ${r} is required in '${i}'.`)}function In(e,r,i){if(e===void 0)throw new TypeError(`${r} is required in '${i}'.`)}function Wn(e){return Number(e)}function rs(e){return e===0?0:e}function ml(e){return rs(cl(e))}function ns(e,r){let u=Number.MAX_SAFE_INTEGER,d=Number(e);if(d=rs(d),!es(d))throw new TypeError(`${r} is not a finite number`);if(d=ml(d),d<0||d>u)throw new TypeError(`${r} is outside the accepted range of ${0} to ${u}, inclusive`);return!es(d)||d===0?0:d}function Fn(e,r){if(!je(e))throw new TypeError(`${r} is not a ReadableStream.`)}function bt(e){return new $t(e)}function os(e,r){e._reader._readRequests.push(r)}function Nn(e,r,i){let d=e._reader._readRequests.shift();i?d._closeSteps():d._chunkSteps(r)}function Cr(e){return e._reader._readRequests.length}function ss(e){let r=e._reader;return!(r===void 0||!Me(r))}class $t{constructor(r){if(ke(r,1,"ReadableStreamDefaultReader"),Fn(r,"First parameter"),He(r))throw new TypeError("This stream has already been locked for exclusive reading by another reader");Er(this,r),this._readRequests=new Y}get closed(){return Me(this)?this._closedPromise:S(Pr("closed"))}cancel(r=void 0){return Me(this)?this._ownerReadableStream===void 0?S(_t("cancel")):xn(this,r):S(Pr("cancel"))}read(){if(!Me(this))return S(Pr("read"));if(this._ownerReadableStream===void 0)return S(_t("read from"));let r,i,u=g((p,_)=>{r=p,i=_});return zt(this,{_chunkSteps:p=>r({value:p,done:!1}),_closeSteps:()=>r({value:void 0,done:!0}),_errorSteps:p=>i(p)}),u}releaseLock(){if(!Me(this))throw Pr("releaseLock");if(this._ownerReadableStream!==void 0){if(this._readRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");ve(this)}}}Object.defineProperties($t.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty($t.prototype,t.toStringTag,{value:"ReadableStreamDefaultReader",configurable:!0});function Me(e){return!l(e)||!Object.prototype.hasOwnProperty.call(e,"_readRequests")?!1:e instanceof $t}function zt(e,r){let i=e._ownerReadableStream;i._disturbed=!0,i._state==="closed"?r._closeSteps():i._state==="errored"?r._errorSteps(i._storedError):i._readableStreamController[Dn](r)}function Pr(e){return new TypeError(`ReadableStreamDefaultReader.prototype.${e} can only be used on a ReadableStreamDefaultReader`)}let is=Object.getPrototypeOf(Object.getPrototypeOf(async function*(){}).prototype);class as{constructor(r,i){this._ongoingPromise=void 0,this._isFinished=!1,this._reader=r,this._preventCancel=i}next(){let r=()=>this._nextSteps();return this._ongoingPromise=this._ongoingPromise?D(this._ongoingPromise,r,r):r(),this._ongoingPromise}return(r){let i=()=>this._returnSteps(r);return this._ongoingPromise?D(this._ongoingPromise,i,i):i()}_nextSteps(){if(this._isFinished)return Promise.resolve({value:void 0,done:!0});let r=this._reader;if(r._ownerReadableStream===void 0)return S(_t("iterate"));let i,u,d=g((_,R)=>{i=_,u=R});return zt(r,{_chunkSteps:_=>{this._ongoingPromise=void 0,I(()=>i({value:_,done:!1}))},_closeSteps:()=>{this._ongoingPromise=void 0,this._isFinished=!0,ve(r),i({value:void 0,done:!0})},_errorSteps:_=>{this._ongoingPromise=void 0,this._isFinished=!0,ve(r),u(_)}}),d}_returnSteps(r){if(this._isFinished)return Promise.resolve({value:r,done:!0});this._isFinished=!0;let i=this._reader;if(i._ownerReadableStream===void 0)return S(_t("finish iterating"));if(!this._preventCancel){let u=xn(i,r);return ve(i),D(u,()=>({value:r,done:!0}))}return ve(i),w({value:r,done:!0})}}let ls={next(){return us(this)?this._asyncIteratorImpl.next():S(fs("next"))},return(e){return us(this)?this._asyncIteratorImpl.return(e):S(fs("return"))}};is!==void 0&&Object.setPrototypeOf(ls,is);function pl(e,r){let i=bt(e),u=new as(i,r),d=Object.create(ls);return d._asyncIteratorImpl=u,d}function us(e){if(!l(e)||!Object.prototype.hasOwnProperty.call(e,"_asyncIteratorImpl"))return!1;try{return e._asyncIteratorImpl instanceof as}catch{return!1}}function fs(e){return new TypeError(`ReadableStreamAsyncIterator.${e} can only be used on a ReadableSteamAsyncIterator`)}let cs=Number.isNaN||function(e){return e!==e};function jt(e){return e.slice()}function ds(e,r,i,u,d){new Uint8Array(e).set(new Uint8Array(i,u,d),r)}function kc(e){return e}function vr(e){return!1}function hs(e,r,i){if(e.slice)return e.slice(r,i);let u=i-r,d=new ArrayBuffer(u);return ds(d,0,e,r,u),d}function _l(e){return!(typeof e!="number"||cs(e)||e<0)}function ms(e){let r=hs(e.buffer,e.byteOffset,e.byteOffset+e.byteLength);return new Uint8Array(r)}function qn(e){let r=e._queue.shift();return e._queueTotalSize-=r.size,e._queueTotalSize<0&&(e._queueTotalSize=0),r.value}function Mn(e,r,i){if(!_l(i)||i===1/0)throw new RangeError("Size must be a finite, non-NaN, non-negative number.");e._queue.push({value:r,size:i}),e._queueTotalSize+=i}function bl(e){return e._queue.peek().value}function Ue(e){e._queue=new Y,e._queueTotalSize=0}class Ht{constructor(){throw new TypeError("Illegal constructor")}get view(){if(!Un(this))throw Hn("view");return this._view}respond(r){if(!Un(this))throw Hn("respond");if(ke(r,1,"respond"),r=ns(r,"First parameter"),this._associatedReadableByteStreamController===void 0)throw new TypeError("This BYOB request has been invalidated");vr(this._view.buffer),Or(this._associatedReadableByteStreamController,r)}respondWithNewView(r){if(!Un(this))throw Hn("respondWithNewView");if(ke(r,1,"respondWithNewView"),!ArrayBuffer.isView(r))throw new TypeError("You can only respond with array buffer views");if(this._associatedReadableByteStreamController===void 0)throw new TypeError("This BYOB request has been invalidated");vr(r.buffer),Lr(this._associatedReadableByteStreamController,r)}}Object.defineProperties(Ht.prototype,{respond:{enumerable:!0},respondWithNewView:{enumerable:!0},view:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(Ht.prototype,t.toStringTag,{value:"ReadableStreamBYOBRequest",configurable:!0});class yt{constructor(){throw new TypeError("Illegal constructor")}get byobRequest(){if(!tt(this))throw Vt("byobRequest");return jn(this)}get desiredSize(){if(!tt(this))throw Vt("desiredSize");return Rs(this)}close(){if(!tt(this))throw Vt("close");if(this._closeRequested)throw new TypeError("The stream has already been closed; do not close it again!");let r=this._controlledReadableByteStream._state;if(r!=="readable")throw new TypeError(`The stream (in ${r} state) is not in the readable state and cannot be closed`);Gt(this)}enqueue(r){if(!tt(this))throw Vt("enqueue");if(ke(r,1,"enqueue"),!ArrayBuffer.isView(r))throw new TypeError("chunk must be an array buffer view");if(r.byteLength===0)throw new TypeError("chunk must have non-zero byteLength");if(r.buffer.byteLength===0)throw new TypeError("chunk's buffer must have non-zero byteLength");if(this._closeRequested)throw new TypeError("stream is closed or draining");let i=this._controlledReadableByteStream._state;if(i!=="readable")throw new TypeError(`The stream (in ${i} state) is not in the readable state and cannot be enqueued to`);Br(this,r)}error(r=void 0){if(!tt(this))throw Vt("error");he(this,r)}[Ln](r){ps(this),Ue(this);let i=this._cancelAlgorithm(r);return xr(this),i}[Dn](r){let i=this._controlledReadableByteStream;if(this._queueTotalSize>0){let d=this._queue.shift();this._queueTotalSize-=d.byteLength,gs(this);let p=new Uint8Array(d.buffer,d.byteOffset,d.byteLength);r._chunkSteps(p);return}let u=this._autoAllocateChunkSize;if(u!==void 0){let d;try{d=new ArrayBuffer(u)}catch(_){r._errorSteps(_);return}let p={buffer:d,bufferByteLength:u,byteOffset:0,byteLength:u,bytesFilled:0,elementSize:1,viewConstructor:Uint8Array,readerType:"default"};this._pendingPullIntos.push(p)}os(i,r),rt(this)}}Object.defineProperties(yt.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},byobRequest:{enumerable:!0},desiredSize:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(yt.prototype,t.toStringTag,{value:"ReadableByteStreamController",configurable:!0});function tt(e){return!l(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledReadableByteStream")?!1:e instanceof yt}function Un(e){return!l(e)||!Object.prototype.hasOwnProperty.call(e,"_associatedReadableByteStreamController")?!1:e instanceof Ht}function rt(e){if(!wl(e))return;if(e._pulling){e._pullAgain=!0;return}e._pulling=!0;let i=e._pullAlgorithm();T(i,()=>{e._pulling=!1,e._pullAgain&&(e._pullAgain=!1,rt(e))},u=>{he(e,u)})}function ps(e){zn(e),e._pendingPullIntos=new Y}function $n(e,r){let i=!1;e._state==="closed"&&(i=!0);let u=_s(r);r.readerType==="default"?Nn(e,u,i):El(e,u,i)}function _s(e){let r=e.bytesFilled,i=e.elementSize;return new e.viewConstructor(e.buffer,e.byteOffset,r/i)}function Ar(e,r,i,u){e._queue.push({buffer:r,byteOffset:i,byteLength:u}),e._queueTotalSize+=u}function bs(e,r){let i=r.elementSize,u=r.bytesFilled-r.bytesFilled%i,d=Math.min(e._queueTotalSize,r.byteLength-r.bytesFilled),p=r.bytesFilled+d,_=p-p%i,R=d,k=!1;_>u&&(R=_-r.bytesFilled,k=!0);let B=e._queue;for(;R>0;){let O=B.peek(),L=Math.min(R,O.byteLength),U=r.byteOffset+r.bytesFilled;ds(r.buffer,U,O.buffer,O.byteOffset,L),O.byteLength===L?B.shift():(O.byteOffset+=L,O.byteLength-=L),e._queueTotalSize-=L,ys(e,L,r),R-=L}return k}function ys(e,r,i){i.bytesFilled+=r}function gs(e){e._queueTotalSize===0&&e._closeRequested?(xr(e),tr(e._controlledReadableByteStream)):rt(e)}function zn(e){e._byobRequest!==null&&(e._byobRequest._associatedReadableByteStreamController=void 0,e._byobRequest._view=null,e._byobRequest=null)}function Ss(e){for(;e._pendingPullIntos.length>0;){if(e._queueTotalSize===0)return;let r=e._pendingPullIntos.peek();bs(e,r)&&(kr(e),$n(e._controlledReadableByteStream,r))}}function yl(e,r,i){let u=e._controlledReadableByteStream,d=1;r.constructor!==DataView&&(d=r.constructor.BYTES_PER_ELEMENT);let p=r.constructor,_=r.buffer,R={buffer:_,bufferByteLength:_.byteLength,byteOffset:r.byteOffset,byteLength:r.byteLength,bytesFilled:0,elementSize:d,viewConstructor:p,readerType:"byob"};if(e._pendingPullIntos.length>0){e._pendingPullIntos.push(R),Cs(u,i);return}if(u._state==="closed"){let k=new p(R.buffer,R.byteOffset,0);i._closeSteps(k);return}if(e._queueTotalSize>0){if(bs(e,R)){let k=_s(R);gs(e),i._chunkSteps(k);return}if(e._closeRequested){let k=new TypeError("Insufficient bytes to fill elements in the given buffer");he(e,k),i._errorSteps(k);return}}e._pendingPullIntos.push(R),Cs(u,i),rt(e)}function gl(e,r){let i=e._controlledReadableByteStream;if(Gn(i))for(;Ps(i)>0;){let u=kr(e);$n(i,u)}}function Sl(e,r,i){if(ys(e,r,i),i.bytesFilled<i.elementSize)return;kr(e);let u=i.bytesFilled%i.elementSize;if(u>0){let d=i.byteOffset+i.bytesFilled,p=hs(i.buffer,d-u,d);Ar(e,p,0,p.byteLength)}i.bytesFilled-=u,$n(e._controlledReadableByteStream,i),Ss(e)}function ws(e,r){let i=e._pendingPullIntos.peek();zn(e),e._controlledReadableByteStream._state==="closed"?gl(e):Sl(e,r,i),rt(e)}function kr(e){return e._pendingPullIntos.shift()}function wl(e){let r=e._controlledReadableByteStream;return r._state!=="readable"||e._closeRequested||!e._started?!1:!!(ss(r)&&Cr(r)>0||Gn(r)&&Ps(r)>0||Rs(e)>0)}function xr(e){e._pullAlgorithm=void 0,e._cancelAlgorithm=void 0}function Gt(e){let r=e._controlledReadableByteStream;if(!(e._closeRequested||r._state!=="readable")){if(e._queueTotalSize>0){e._closeRequested=!0;return}if(e._pendingPullIntos.length>0&&e._pendingPullIntos.peek().bytesFilled>0){let u=new TypeError("Insufficient bytes to fill elements in the given buffer");throw he(e,u),u}xr(e),tr(r)}}function Br(e,r){let i=e._controlledReadableByteStream;if(e._closeRequested||i._state!=="readable")return;let u=r.buffer,d=r.byteOffset,p=r.byteLength,_=u;if(e._pendingPullIntos.length>0){let R=e._pendingPullIntos.peek();vr(R.buffer),R.buffer=R.buffer}if(zn(e),ss(i))if(Cr(i)===0)Ar(e,_,d,p);else{e._pendingPullIntos.length>0&&kr(e);let R=new Uint8Array(_,d,p);Nn(i,R,!1)}else Gn(i)?(Ar(e,_,d,p),Ss(e)):Ar(e,_,d,p);rt(e)}function he(e,r){let i=e._controlledReadableByteStream;i._state==="readable"&&(ps(e),Ue(e),xr(e),Xs(i,r))}function jn(e){if(e._byobRequest===null&&e._pendingPullIntos.length>0){let r=e._pendingPullIntos.peek(),i=new Uint8Array(r.buffer,r.byteOffset+r.bytesFilled,r.byteLength-r.bytesFilled),u=Object.create(Ht.prototype);Tl(u,e,i),e._byobRequest=u}return e._byobRequest}function Rs(e){let r=e._controlledReadableByteStream._state;return r==="errored"?null:r==="closed"?0:e._strategyHWM-e._queueTotalSize}function Or(e,r){let i=e._pendingPullIntos.peek();if(e._controlledReadableByteStream._state==="closed"){if(r!==0)throw new TypeError("bytesWritten must be 0 when calling respond() on a closed stream")}else{if(r===0)throw new TypeError("bytesWritten must be greater than 0 when calling respond() on a readable stream");if(i.bytesFilled+r>i.byteLength)throw new RangeError("bytesWritten out of range")}i.buffer=i.buffer,ws(e,r)}function Lr(e,r){let i=e._pendingPullIntos.peek();if(e._controlledReadableByteStream._state==="closed"){if(r.byteLength!==0)throw new TypeError("The view's length must be 0 when calling respondWithNewView() on a closed stream")}else if(r.byteLength===0)throw new TypeError("The view's length must be greater than 0 when calling respondWithNewView() on a readable stream");if(i.byteOffset+i.bytesFilled!==r.byteOffset)throw new RangeError("The region specified by view does not match byobRequest");if(i.bufferByteLength!==r.buffer.byteLength)throw new RangeError("The buffer of view has different capacity than byobRequest");if(i.bytesFilled+r.byteLength>i.byteLength)throw new RangeError("The region specified by view is larger than byobRequest");let d=r.byteLength;i.buffer=r.buffer,ws(e,d)}function Ts(e,r,i,u,d,p,_){r._controlledReadableByteStream=e,r._pullAgain=!1,r._pulling=!1,r._byobRequest=null,r._queue=r._queueTotalSize=void 0,Ue(r),r._closeRequested=!1,r._started=!1,r._strategyHWM=p,r._pullAlgorithm=u,r._cancelAlgorithm=d,r._autoAllocateChunkSize=_,r._pendingPullIntos=new Y,e._readableStreamController=r;let R=i();T(w(R),()=>{r._started=!0,rt(r)},k=>{he(r,k)})}function Rl(e,r,i){let u=Object.create(yt.prototype),d=()=>{},p=()=>w(void 0),_=()=>w(void 0);r.start!==void 0&&(d=()=>r.start(u)),r.pull!==void 0&&(p=()=>r.pull(u)),r.cancel!==void 0&&(_=k=>r.cancel(k));let R=r.autoAllocateChunkSize;if(R===0)throw new TypeError("autoAllocateChunkSize must be greater than 0");Ts(e,u,d,p,_,i,R)}function Tl(e,r,i){e._associatedReadableByteStreamController=r,e._view=i}function Hn(e){return new TypeError(`ReadableStreamBYOBRequest.prototype.${e} can only be used on a ReadableStreamBYOBRequest`)}function Vt(e){return new TypeError(`ReadableByteStreamController.prototype.${e} can only be used on a ReadableByteStreamController`)}function Es(e){return new Yt(e)}function Cs(e,r){e._reader._readIntoRequests.push(r)}function El(e,r,i){let d=e._reader._readIntoRequests.shift();i?d._closeSteps(r):d._chunkSteps(r)}function Ps(e){return e._reader._readIntoRequests.length}function Gn(e){let r=e._reader;return!(r===void 0||!nt(r))}class Yt{constructor(r){if(ke(r,1,"ReadableStreamBYOBReader"),Fn(r,"First parameter"),He(r))throw new TypeError("This stream has already been locked for exclusive reading by another reader");if(!tt(r._readableStreamController))throw new TypeError("Cannot construct a ReadableStreamBYOBReader for a stream not constructed with a byte source");Er(this,r),this._readIntoRequests=new Y}get closed(){return nt(this)?this._closedPromise:S(Dr("closed"))}cancel(r=void 0){return nt(this)?this._ownerReadableStream===void 0?S(_t("cancel")):xn(this,r):S(Dr("cancel"))}read(r){if(!nt(this))return S(Dr("read"));if(!ArrayBuffer.isView(r))return S(new TypeError("view must be an array buffer view"));if(r.byteLength===0)return S(new TypeError("view must have non-zero byteLength"));if(r.buffer.byteLength===0)return S(new TypeError("view's buffer must have non-zero byteLength"));if(vr(r.buffer),this._ownerReadableStream===void 0)return S(_t("read from"));let i,u,d=g((_,R)=>{i=_,u=R});return vs(this,r,{_chunkSteps:_=>i({value:_,done:!1}),_closeSteps:_=>i({value:_,done:!0}),_errorSteps:_=>u(_)}),d}releaseLock(){if(!nt(this))throw Dr("releaseLock");if(this._ownerReadableStream!==void 0){if(this._readIntoRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");ve(this)}}}Object.defineProperties(Yt.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(Yt.prototype,t.toStringTag,{value:"ReadableStreamBYOBReader",configurable:!0});function nt(e){return!l(e)||!Object.prototype.hasOwnProperty.call(e,"_readIntoRequests")?!1:e instanceof Yt}function vs(e,r,i){let u=e._ownerReadableStream;u._disturbed=!0,u._state==="errored"?i._errorSteps(u._storedError):yl(u._readableStreamController,r,i)}function Dr(e){return new TypeError(`ReadableStreamBYOBReader.prototype.${e} can only be used on a ReadableStreamBYOBReader`)}function Qt(e,r){let{highWaterMark:i}=e;if(i===void 0)return r;if(cs(i)||i<0)throw new RangeError("Invalid highWaterMark");return i}function Ir(e){let{size:r}=e;return r||(()=>1)}function Wr(e,r){Ae(e,r);let i=e?.highWaterMark,u=e?.size;return{highWaterMark:i===void 0?void 0:Wn(i),size:u===void 0?void 0:Cl(u,`${r} has member 'size' that`)}}function Cl(e,r){return de(e,r),i=>Wn(e(i))}function Pl(e,r){Ae(e,r);let i=e?.abort,u=e?.close,d=e?.start,p=e?.type,_=e?.write;return{abort:i===void 0?void 0:vl(i,e,`${r} has member 'abort' that`),close:u===void 0?void 0:Al(u,e,`${r} has member 'close' that`),start:d===void 0?void 0:kl(d,e,`${r} has member 'start' that`),write:_===void 0?void 0:xl(_,e,`${r} has member 'write' that`),type:p}}function vl(e,r,i){return de(e,i),u=>W(e,r,[u])}function Al(e,r,i){return de(e,i),()=>W(e,r,[])}function kl(e,r,i){return de(e,i),u=>M(e,r,[u])}function xl(e,r,i){return de(e,i),(u,d)=>W(e,r,[u,d])}function As(e,r){if(!gt(e))throw new TypeError(`${r} is not a WritableStream.`)}function Bl(e){if(typeof e!="object"||e===null)return!1;try{return typeof e.aborted=="boolean"}catch{return!1}}let Ol=typeof AbortController=="function";function Ll(){if(Ol)return new AbortController}class Xt{constructor(r={},i={}){r===void 0?r=null:ts(r,"First parameter");let u=Wr(i,"Second parameter"),d=Pl(r,"First parameter");if(xs(this),d.type!==void 0)throw new RangeError("Invalid type is specified");let _=Ir(u),R=Qt(u,1);Vl(this,d,R,_)}get locked(){if(!gt(this))throw Ur("locked");return St(this)}abort(r=void 0){return gt(this)?St(this)?S(new TypeError("Cannot abort a stream that already has a writer")):Fr(this,r):S(Ur("abort"))}close(){return gt(this)?St(this)?S(new TypeError("Cannot close a stream that already has a writer")):ge(this)?S(new TypeError("Cannot close an already-closing stream")):Bs(this):S(Ur("close"))}getWriter(){if(!gt(this))throw Ur("getWriter");return ks(this)}}Object.defineProperties(Xt.prototype,{abort:{enumerable:!0},close:{enumerable:!0},getWriter:{enumerable:!0},locked:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(Xt.prototype,t.toStringTag,{value:"WritableStream",configurable:!0});function ks(e){return new Jt(e)}function Dl(e,r,i,u,d=1,p=()=>1){let _=Object.create(Xt.prototype);xs(_);let R=Object.create(wt.prototype);return Fs(_,R,e,r,i,u,d,p),_}function xs(e){e._state="writable",e._storedError=void 0,e._writer=void 0,e._writableStreamController=void 0,e._writeRequests=new Y,e._inFlightWriteRequest=void 0,e._closeRequest=void 0,e._inFlightCloseRequest=void 0,e._pendingAbortRequest=void 0,e._backpressure=!1}function gt(e){return!l(e)||!Object.prototype.hasOwnProperty.call(e,"_writableStreamController")?!1:e instanceof Xt}function St(e){return e._writer!==void 0}function Fr(e,r){var i;if(e._state==="closed"||e._state==="errored")return w(void 0);e._writableStreamController._abortReason=r,(i=e._writableStreamController._abortController)===null||i===void 0||i.abort();let u=e._state;if(u==="closed"||u==="errored")return w(void 0);if(e._pendingAbortRequest!==void 0)return e._pendingAbortRequest._promise;let d=!1;u==="erroring"&&(d=!0,r=void 0);let p=g((_,R)=>{e._pendingAbortRequest={_promise:void 0,_resolve:_,_reject:R,_reason:r,_wasAlreadyErroring:d}});return e._pendingAbortRequest._promise=p,d||Yn(e,r),p}function Bs(e){let r=e._state;if(r==="closed"||r==="errored")return S(new TypeError(`The stream (in ${r} state) is not in the writable state and cannot be closed`));let i=g((d,p)=>{let _={_resolve:d,_reject:p};e._closeRequest=_}),u=e._writer;return u!==void 0&&e._backpressure&&r==="writable"&&no(u),Yl(e._writableStreamController),i}function Il(e){return g((i,u)=>{let d={_resolve:i,_reject:u};e._writeRequests.push(d)})}function Vn(e,r){if(e._state==="writable"){Yn(e,r);return}Qn(e)}function Yn(e,r){let i=e._writableStreamController;e._state="erroring",e._storedError=r;let u=e._writer;u!==void 0&&Ls(u,r),!Ml(e)&&i._started&&Qn(e)}function Qn(e){e._state="errored",e._writableStreamController[Zo]();let r=e._storedError;if(e._writeRequests.forEach(d=>{d._reject(r)}),e._writeRequests=new Y,e._pendingAbortRequest===void 0){Nr(e);return}let i=e._pendingAbortRequest;if(e._pendingAbortRequest=void 0,i._wasAlreadyErroring){i._reject(r),Nr(e);return}let u=e._writableStreamController[Ko](i._reason);T(u,()=>{i._resolve(),Nr(e)},d=>{i._reject(d),Nr(e)})}function Wl(e){e._inFlightWriteRequest._resolve(void 0),e._inFlightWriteRequest=void 0}function Fl(e,r){e._inFlightWriteRequest._reject(r),e._inFlightWriteRequest=void 0,Vn(e,r)}function Nl(e){e._inFlightCloseRequest._resolve(void 0),e._inFlightCloseRequest=void 0,e._state==="erroring"&&(e._storedError=void 0,e._pendingAbortRequest!==void 0&&(e._pendingAbortRequest._resolve(),e._pendingAbortRequest=void 0)),e._state="closed";let i=e._writer;i!==void 0&&Us(i)}function ql(e,r){e._inFlightCloseRequest._reject(r),e._inFlightCloseRequest=void 0,e._pendingAbortRequest!==void 0&&(e._pendingAbortRequest._reject(r),e._pendingAbortRequest=void 0),Vn(e,r)}function ge(e){return!(e._closeRequest===void 0&&e._inFlightCloseRequest===void 0)}function Ml(e){return!(e._inFlightWriteRequest===void 0&&e._inFlightCloseRequest===void 0)}function Ul(e){e._inFlightCloseRequest=e._closeRequest,e._closeRequest=void 0}function $l(e){e._inFlightWriteRequest=e._writeRequests.shift()}function Nr(e){e._closeRequest!==void 0&&(e._closeRequest._reject(e._storedError),e._closeRequest=void 0);let r=e._writer;r!==void 0&&to(r,e._storedError)}function Xn(e,r){let i=e._writer;i!==void 0&&r!==e._backpressure&&(r?tu(i):no(i)),e._backpressure=r}class Jt{constructor(r){if(ke(r,1,"WritableStreamDefaultWriter"),As(r,"First parameter"),St(r))throw new TypeError("This stream has already been locked for exclusive writing by another writer");this._ownerWritableStream=r,r._writer=this;let i=r._state;if(i==="writable")!ge(r)&&r._backpressure?zr(this):$s(this),$r(this);else if(i==="erroring")ro(this,r._storedError),$r(this);else if(i==="closed")$s(this),Zl(this);else{let u=r._storedError;ro(this,u),Ms(this,u)}}get closed(){return ot(this)?this._closedPromise:S(st("closed"))}get desiredSize(){if(!ot(this))throw st("desiredSize");if(this._ownerWritableStream===void 0)throw Kt("desiredSize");return Gl(this)}get ready(){return ot(this)?this._readyPromise:S(st("ready"))}abort(r=void 0){return ot(this)?this._ownerWritableStream===void 0?S(Kt("abort")):zl(this,r):S(st("abort"))}close(){if(!ot(this))return S(st("close"));let r=this._ownerWritableStream;return r===void 0?S(Kt("close")):ge(r)?S(new TypeError("Cannot close an already-closing stream")):Os(this)}releaseLock(){if(!ot(this))throw st("releaseLock");this._ownerWritableStream!==void 0&&Ds(this)}write(r=void 0){return ot(this)?this._ownerWritableStream===void 0?S(Kt("write to")):Is(this,r):S(st("write"))}}Object.defineProperties(Jt.prototype,{abort:{enumerable:!0},close:{enumerable:!0},releaseLock:{enumerable:!0},write:{enumerable:!0},closed:{enumerable:!0},desiredSize:{enumerable:!0},ready:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(Jt.prototype,t.toStringTag,{value:"WritableStreamDefaultWriter",configurable:!0});function ot(e){return!l(e)||!Object.prototype.hasOwnProperty.call(e,"_ownerWritableStream")?!1:e instanceof Jt}function zl(e,r){let i=e._ownerWritableStream;return Fr(i,r)}function Os(e){let r=e._ownerWritableStream;return Bs(r)}function jl(e){let r=e._ownerWritableStream,i=r._state;return ge(r)||i==="closed"?w(void 0):i==="errored"?S(r._storedError):Os(e)}function Hl(e,r){e._closedPromiseState==="pending"?to(e,r):eu(e,r)}function Ls(e,r){e._readyPromiseState==="pending"?zs(e,r):ru(e,r)}function Gl(e){let r=e._ownerWritableStream,i=r._state;return i==="errored"||i==="erroring"?null:i==="closed"?0:Ns(r._writableStreamController)}function Ds(e){let r=e._ownerWritableStream,i=new TypeError("Writer was released and can no longer be used to monitor the stream's closedness");Ls(e,i),Hl(e,i),r._writer=void 0,e._ownerWritableStream=void 0}function Is(e,r){let i=e._ownerWritableStream,u=i._writableStreamController,d=Ql(u,r);if(i!==e._ownerWritableStream)return S(Kt("write to"));let p=i._state;if(p==="errored")return S(i._storedError);if(ge(i)||p==="closed")return S(new TypeError("The stream is closing or closed and cannot be written to"));if(p==="erroring")return S(i._storedError);let _=Il(i);return Xl(u,r,d),_}let Ws={};class wt{constructor(){throw new TypeError("Illegal constructor")}get abortReason(){if(!Jn(this))throw eo("abortReason");return this._abortReason}get signal(){if(!Jn(this))throw eo("signal");if(this._abortController===void 0)throw new TypeError("WritableStreamDefaultController.prototype.signal is not supported");return this._abortController.signal}error(r=void 0){if(!Jn(this))throw eo("error");this._controlledWritableStream._state==="writable"&&qs(this,r)}[Ko](r){let i=this._abortAlgorithm(r);return qr(this),i}[Zo](){Ue(this)}}Object.defineProperties(wt.prototype,{abortReason:{enumerable:!0},signal:{enumerable:!0},error:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(wt.prototype,t.toStringTag,{value:"WritableStreamDefaultController",configurable:!0});function Jn(e){return!l(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledWritableStream")?!1:e instanceof wt}function Fs(e,r,i,u,d,p,_,R){r._controlledWritableStream=e,e._writableStreamController=r,r._queue=void 0,r._queueTotalSize=void 0,Ue(r),r._abortReason=void 0,r._abortController=Ll(),r._started=!1,r._strategySizeAlgorithm=R,r._strategyHWM=_,r._writeAlgorithm=u,r._closeAlgorithm=d,r._abortAlgorithm=p;let k=Zn(r);Xn(e,k);let B=i(),O=w(B);T(O,()=>{r._started=!0,Mr(r)},L=>{r._started=!0,Vn(e,L)})}function Vl(e,r,i,u){let d=Object.create(wt.prototype),p=()=>{},_=()=>w(void 0),R=()=>w(void 0),k=()=>w(void 0);r.start!==void 0&&(p=()=>r.start(d)),r.write!==void 0&&(_=B=>r.write(B,d)),r.close!==void 0&&(R=()=>r.close()),r.abort!==void 0&&(k=B=>r.abort(B)),Fs(e,d,p,_,R,k,i,u)}function qr(e){e._writeAlgorithm=void 0,e._closeAlgorithm=void 0,e._abortAlgorithm=void 0,e._strategySizeAlgorithm=void 0}function Yl(e){Mn(e,Ws,0),Mr(e)}function Ql(e,r){try{return e._strategySizeAlgorithm(r)}catch(i){return Kn(e,i),1}}function Ns(e){return e._strategyHWM-e._queueTotalSize}function Xl(e,r,i){try{Mn(e,r,i)}catch(d){Kn(e,d);return}let u=e._controlledWritableStream;if(!ge(u)&&u._state==="writable"){let d=Zn(e);Xn(u,d)}Mr(e)}function Mr(e){let r=e._controlledWritableStream;if(!e._started||r._inFlightWriteRequest!==void 0)return;if(r._state==="erroring"){Qn(r);return}if(e._queue.length===0)return;let u=bl(e);u===Ws?Jl(e):Kl(e,u)}function Kn(e,r){e._controlledWritableStream._state==="writable"&&qs(e,r)}function Jl(e){let r=e._controlledWritableStream;Ul(r),qn(e);let i=e._closeAlgorithm();qr(e),T(i,()=>{Nl(r)},u=>{ql(r,u)})}function Kl(e,r){let i=e._controlledWritableStream;$l(i);let u=e._writeAlgorithm(r);T(u,()=>{Wl(i);let d=i._state;if(qn(e),!ge(i)&&d==="writable"){let p=Zn(e);Xn(i,p)}Mr(e)},d=>{i._state==="writable"&&qr(e),Fl(i,d)})}function Zn(e){return Ns(e)<=0}function qs(e,r){let i=e._controlledWritableStream;qr(e),Yn(i,r)}function Ur(e){return new TypeError(`WritableStream.prototype.${e} can only be used on a WritableStream`)}function eo(e){return new TypeError(`WritableStreamDefaultController.prototype.${e} can only be used on a WritableStreamDefaultController`)}function st(e){return new TypeError(`WritableStreamDefaultWriter.prototype.${e} can only be used on a WritableStreamDefaultWriter`)}function Kt(e){return new TypeError("Cannot "+e+" a stream using a released writer")}function $r(e){e._closedPromise=g((r,i)=>{e._closedPromise_resolve=r,e._closedPromise_reject=i,e._closedPromiseState="pending"})}function Ms(e,r){$r(e),to(e,r)}function Zl(e){$r(e),Us(e)}function to(e,r){e._closedPromise_reject!==void 0&&(q(e._closedPromise),e._closedPromise_reject(r),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="rejected")}function eu(e,r){Ms(e,r)}function Us(e){e._closedPromise_resolve!==void 0&&(e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="resolved")}function zr(e){e._readyPromise=g((r,i)=>{e._readyPromise_resolve=r,e._readyPromise_reject=i}),e._readyPromiseState="pending"}function ro(e,r){zr(e),zs(e,r)}function $s(e){zr(e),no(e)}function zs(e,r){e._readyPromise_reject!==void 0&&(q(e._readyPromise),e._readyPromise_reject(r),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="rejected")}function tu(e){zr(e)}function ru(e,r){ro(e,r)}function no(e){e._readyPromise_resolve!==void 0&&(e._readyPromise_resolve(void 0),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="fulfilled")}let js=typeof DOMException<"u"?DOMException:void 0;function nu(e){if(!(typeof e=="function"||typeof e=="object"))return!1;try{return new e,!0}catch{return!1}}function ou(){let e=function(i,u){this.message=i||"",this.name=u||"Error",Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)};return e.prototype=Object.create(Error.prototype),Object.defineProperty(e.prototype,"constructor",{value:e,writable:!0,configurable:!0}),e}let su=nu(js)?js:ou();function Hs(e,r,i,u,d,p){let _=bt(e),R=ks(r);e._disturbed=!0;let k=!1,B=w(void 0);return g((O,L)=>{let U;if(p!==void 0){if(U=()=>{let E=new su("Aborted","AbortError"),x=[];u||x.push(()=>r._state==="writable"?Fr(r,E):w(void 0)),d||x.push(()=>e._state==="readable"?me(e,E):w(void 0)),J(()=>Promise.all(x.map(F=>F())),!0,E)},p.aborted){U();return}p.addEventListener("abort",U)}function pe(){return g((E,x)=>{function F(te){te?E():y(Et(),F,x)}F(!1)})}function Et(){return k?w(!0):y(R._readyPromise,()=>g((E,x)=>{zt(_,{_chunkSteps:F=>{B=y(Is(R,F),void 0,n),E(!1)},_closeSteps:()=>E(!0),_errorSteps:x})}))}if(xe(e,_._closedPromise,E=>{u?ie(!0,E):J(()=>Fr(r,E),!0,E)}),xe(r,R._closedPromise,E=>{d?ie(!0,E):J(()=>me(e,E),!0,E)}),Q(e,_._closedPromise,()=>{i?ie():J(()=>jl(R))}),ge(r)||r._state==="closed"){let E=new TypeError("the destination writable stream closed before all data could be piped to it");d?ie(!0,E):J(()=>me(e,E),!0,E)}q(pe());function Ge(){let E=B;return y(B,()=>E!==B?Ge():void 0)}function xe(E,x,F){E._state==="errored"?F(E._storedError):A(x,F)}function Q(E,x,F){E._state==="closed"?F():P(x,F)}function J(E,x,F){if(k)return;k=!0,r._state==="writable"&&!ge(r)?P(Ge(),te):te();function te(){T(E(),()=>Be(x,F),Ct=>Be(!0,Ct))}}function ie(E,x){k||(k=!0,r._state==="writable"&&!ge(r)?P(Ge(),()=>Be(E,x)):Be(E,x))}function Be(E,x){Ds(R),ve(_),p!==void 0&&p.removeEventListener("abort",U),E?L(x):O(void 0)}})}class Rt{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!jr(this))throw Vr("desiredSize");return oo(this)}close(){if(!jr(this))throw Vr("close");if(!Tt(this))throw new TypeError("The stream is not in a state that permits close");er(this)}enqueue(r=void 0){if(!jr(this))throw Vr("enqueue");if(!Tt(this))throw new TypeError("The stream is not in a state that permits enqueue");return Gr(this,r)}error(r=void 0){if(!jr(this))throw Vr("error");$e(this,r)}[Ln](r){Ue(this);let i=this._cancelAlgorithm(r);return Hr(this),i}[Dn](r){let i=this._controlledReadableStream;if(this._queue.length>0){let u=qn(this);this._closeRequested&&this._queue.length===0?(Hr(this),tr(i)):Zt(this),r._chunkSteps(u)}else os(i,r),Zt(this)}}Object.defineProperties(Rt.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},desiredSize:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(Rt.prototype,t.toStringTag,{value:"ReadableStreamDefaultController",configurable:!0});function jr(e){return!l(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledReadableStream")?!1:e instanceof Rt}function Zt(e){if(!Gs(e))return;if(e._pulling){e._pullAgain=!0;return}e._pulling=!0;let i=e._pullAlgorithm();T(i,()=>{e._pulling=!1,e._pullAgain&&(e._pullAgain=!1,Zt(e))},u=>{$e(e,u)})}function Gs(e){let r=e._controlledReadableStream;return!Tt(e)||!e._started?!1:!!(He(r)&&Cr(r)>0||oo(e)>0)}function Hr(e){e._pullAlgorithm=void 0,e._cancelAlgorithm=void 0,e._strategySizeAlgorithm=void 0}function er(e){if(!Tt(e))return;let r=e._controlledReadableStream;e._closeRequested=!0,e._queue.length===0&&(Hr(e),tr(r))}function Gr(e,r){if(!Tt(e))return;let i=e._controlledReadableStream;if(He(i)&&Cr(i)>0)Nn(i,r,!1);else{let u;try{u=e._strategySizeAlgorithm(r)}catch(d){throw $e(e,d),d}try{Mn(e,r,u)}catch(d){throw $e(e,d),d}}Zt(e)}function $e(e,r){let i=e._controlledReadableStream;i._state==="readable"&&(Ue(e),Hr(e),Xs(i,r))}function oo(e){let r=e._controlledReadableStream._state;return r==="errored"?null:r==="closed"?0:e._strategyHWM-e._queueTotalSize}function iu(e){return!Gs(e)}function Tt(e){let r=e._controlledReadableStream._state;return!e._closeRequested&&r==="readable"}function Vs(e,r,i,u,d,p,_){r._controlledReadableStream=e,r._queue=void 0,r._queueTotalSize=void 0,Ue(r),r._started=!1,r._closeRequested=!1,r._pullAgain=!1,r._pulling=!1,r._strategySizeAlgorithm=_,r._strategyHWM=p,r._pullAlgorithm=u,r._cancelAlgorithm=d,e._readableStreamController=r;let R=i();T(w(R),()=>{r._started=!0,Zt(r)},k=>{$e(r,k)})}function au(e,r,i,u){let d=Object.create(Rt.prototype),p=()=>{},_=()=>w(void 0),R=()=>w(void 0);r.start!==void 0&&(p=()=>r.start(d)),r.pull!==void 0&&(_=()=>r.pull(d)),r.cancel!==void 0&&(R=k=>r.cancel(k)),Vs(e,d,p,_,R,i,u)}function Vr(e){return new TypeError(`ReadableStreamDefaultController.prototype.${e} can only be used on a ReadableStreamDefaultController`)}function lu(e,r){return tt(e._readableStreamController)?fu(e):uu(e)}function uu(e,r){let i=bt(e),u=!1,d=!1,p=!1,_=!1,R,k,B,O,L,U=g(Q=>{L=Q});function pe(){return u?(d=!0,w(void 0)):(u=!0,zt(i,{_chunkSteps:J=>{I(()=>{d=!1;let ie=J,Be=J;p||Gr(B._readableStreamController,ie),_||Gr(O._readableStreamController,Be),u=!1,d&&pe()})},_closeSteps:()=>{u=!1,p||er(B._readableStreamController),_||er(O._readableStreamController),(!p||!_)&&L(void 0)},_errorSteps:()=>{u=!1}}),w(void 0))}function Et(Q){if(p=!0,R=Q,_){let J=jt([R,k]),ie=me(e,J);L(ie)}return U}function Ge(Q){if(_=!0,k=Q,p){let J=jt([R,k]),ie=me(e,J);L(ie)}return U}function xe(){}return B=so(xe,pe,Et),O=so(xe,pe,Ge),A(i._closedPromise,Q=>{$e(B._readableStreamController,Q),$e(O._readableStreamController,Q),(!p||!_)&&L(void 0)}),[B,O]}function fu(e){let r=bt(e),i=!1,u=!1,d=!1,p=!1,_=!1,R,k,B,O,L,U=g(E=>{L=E});function pe(E){A(E._closedPromise,x=>{E===r&&(he(B._readableStreamController,x),he(O._readableStreamController,x),(!p||!_)&&L(void 0))})}function Et(){nt(r)&&(ve(r),r=bt(e),pe(r)),zt(r,{_chunkSteps:x=>{I(()=>{u=!1,d=!1;let F=x,te=x;if(!p&&!_)try{te=ms(x)}catch(Ct){he(B._readableStreamController,Ct),he(O._readableStreamController,Ct),L(me(e,Ct));return}p||Br(B._readableStreamController,F),_||Br(O._readableStreamController,te),i=!1,u?xe():d&&Q()})},_closeSteps:()=>{i=!1,p||Gt(B._readableStreamController),_||Gt(O._readableStreamController),B._readableStreamController._pendingPullIntos.length>0&&Or(B._readableStreamController,0),O._readableStreamController._pendingPullIntos.length>0&&Or(O._readableStreamController,0),(!p||!_)&&L(void 0)},_errorSteps:()=>{i=!1}})}function Ge(E,x){Me(r)&&(ve(r),r=Es(e),pe(r));let F=x?O:B,te=x?B:O;vs(r,E,{_chunkSteps:Pt=>{I(()=>{u=!1,d=!1;let vt=x?_:p;if(x?p:_)vt||Lr(F._readableStreamController,Pt);else{let ui;try{ui=ms(Pt)}catch(ao){he(F._readableStreamController,ao),he(te._readableStreamController,ao),L(me(e,ao));return}vt||Lr(F._readableStreamController,Pt),Br(te._readableStreamController,ui)}i=!1,u?xe():d&&Q()})},_closeSteps:Pt=>{i=!1;let vt=x?_:p,rn=x?p:_;vt||Gt(F._readableStreamController),rn||Gt(te._readableStreamController),Pt!==void 0&&(vt||Lr(F._readableStreamController,Pt),!rn&&te._readableStreamController._pendingPullIntos.length>0&&Or(te._readableStreamController,0)),(!vt||!rn)&&L(void 0)},_errorSteps:()=>{i=!1}})}function xe(){if(i)return u=!0,w(void 0);i=!0;let E=jn(B._readableStreamController);return E===null?Et():Ge(E._view,!1),w(void 0)}function Q(){if(i)return d=!0,w(void 0);i=!0;let E=jn(O._readableStreamController);return E===null?Et():Ge(E._view,!0),w(void 0)}function J(E){if(p=!0,R=E,_){let x=jt([R,k]),F=me(e,x);L(F)}return U}function ie(E){if(_=!0,k=E,p){let x=jt([R,k]),F=me(e,x);L(F)}return U}function Be(){}return B=Qs(Be,xe,J),O=Qs(Be,Q,ie),pe(r),[B,O]}function cu(e,r){Ae(e,r);let i=e,u=i?.autoAllocateChunkSize,d=i?.cancel,p=i?.pull,_=i?.start,R=i?.type;return{autoAllocateChunkSize:u===void 0?void 0:ns(u,`${r} has member 'autoAllocateChunkSize' that`),cancel:d===void 0?void 0:du(d,i,`${r} has member 'cancel' that`),pull:p===void 0?void 0:hu(p,i,`${r} has member 'pull' that`),start:_===void 0?void 0:mu(_,i,`${r} has member 'start' that`),type:R===void 0?void 0:pu(R,`${r} has member 'type' that`)}}function du(e,r,i){return de(e,i),u=>W(e,r,[u])}function hu(e,r,i){return de(e,i),u=>W(e,r,[u])}function mu(e,r,i){return de(e,i),u=>M(e,r,[u])}function pu(e,r){if(e=`${e}`,e!=="bytes")throw new TypeError(`${r} '${e}' is not a valid enumeration value for ReadableStreamType`);return e}function _u(e,r){Ae(e,r);let i=e?.mode;return{mode:i===void 0?void 0:bu(i,`${r} has member 'mode' that`)}}function bu(e,r){if(e=`${e}`,e!=="byob")throw new TypeError(`${r} '${e}' is not a valid enumeration value for ReadableStreamReaderMode`);return e}function yu(e,r){Ae(e,r);let i=e?.preventCancel;return{preventCancel:Boolean(i)}}function Ys(e,r){Ae(e,r);let i=e?.preventAbort,u=e?.preventCancel,d=e?.preventClose,p=e?.signal;return p!==void 0&&gu(p,`${r} has member 'signal' that`),{preventAbort:Boolean(i),preventCancel:Boolean(u),preventClose:Boolean(d),signal:p}}function gu(e,r){if(!Bl(e))throw new TypeError(`${r} is not an AbortSignal.`)}function Su(e,r){Ae(e,r);let i=e?.readable;In(i,"readable","ReadableWritablePair"),Fn(i,`${r} has member 'readable' that`);let u=e?.writable;return In(u,"writable","ReadableWritablePair"),As(u,`${r} has member 'writable' that`),{readable:i,writable:u}}class ze{constructor(r={},i={}){r===void 0?r=null:ts(r,"First parameter");let u=Wr(i,"Second parameter"),d=cu(r,"First parameter");if(io(this),d.type==="bytes"){if(u.size!==void 0)throw new RangeError("The strategy for a byte stream cannot have a size function");let p=Qt(u,0);Rl(this,d,p)}else{let p=Ir(u),_=Qt(u,1);au(this,d,_,p)}}get locked(){if(!je(this))throw it("locked");return He(this)}cancel(r=void 0){return je(this)?He(this)?S(new TypeError("Cannot cancel a stream that already has a reader")):me(this,r):S(it("cancel"))}getReader(r=void 0){if(!je(this))throw it("getReader");return _u(r,"First parameter").mode===void 0?bt(this):Es(this)}pipeThrough(r,i={}){if(!je(this))throw it("pipeThrough");ke(r,1,"pipeThrough");let u=Su(r,"First parameter"),d=Ys(i,"Second parameter");if(He(this))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked ReadableStream");if(St(u.writable))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked WritableStream");let p=Hs(this,u.writable,d.preventClose,d.preventAbort,d.preventCancel,d.signal);return q(p),u.readable}pipeTo(r,i={}){if(!je(this))return S(it("pipeTo"));if(r===void 0)return S("Parameter 1 is required in 'pipeTo'.");if(!gt(r))return S(new TypeError("ReadableStream.prototype.pipeTo's first argument must be a WritableStream"));let u;try{u=Ys(i,"Second parameter")}catch(d){return S(d)}return He(this)?S(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked ReadableStream")):St(r)?S(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked WritableStream")):Hs(this,r,u.preventClose,u.preventAbort,u.preventCancel,u.signal)}tee(){if(!je(this))throw it("tee");let r=lu(this);return jt(r)}values(r=void 0){if(!je(this))throw it("values");let i=yu(r,"First parameter");return pl(this,i.preventCancel)}}Object.defineProperties(ze.prototype,{cancel:{enumerable:!0},getReader:{enumerable:!0},pipeThrough:{enumerable:!0},pipeTo:{enumerable:!0},tee:{enumerable:!0},values:{enumerable:!0},locked:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(ze.prototype,t.toStringTag,{value:"ReadableStream",configurable:!0}),typeof t.asyncIterator=="symbol"&&Object.defineProperty(ze.prototype,t.asyncIterator,{value:ze.prototype.values,writable:!0,configurable:!0});function so(e,r,i,u=1,d=()=>1){let p=Object.create(ze.prototype);io(p);let _=Object.create(Rt.prototype);return Vs(p,_,e,r,i,u,d),p}function Qs(e,r,i){let u=Object.create(ze.prototype);io(u);let d=Object.create(yt.prototype);return Ts(u,d,e,r,i,0,void 0),u}function io(e){e._state="readable",e._reader=void 0,e._storedError=void 0,e._disturbed=!1}function je(e){return!l(e)||!Object.prototype.hasOwnProperty.call(e,"_readableStreamController")?!1:e instanceof ze}function He(e){return e._reader!==void 0}function me(e,r){if(e._disturbed=!0,e._state==="closed")return w(void 0);if(e._state==="errored")return S(e._storedError);tr(e);let i=e._reader;i!==void 0&&nt(i)&&(i._readIntoRequests.forEach(d=>{d._closeSteps(void 0)}),i._readIntoRequests=new Y);let u=e._readableStreamController[Ln](r);return D(u,n)}function tr(e){e._state="closed";let r=e._reader;r!==void 0&&(Jo(r),Me(r)&&(r._readRequests.forEach(i=>{i._closeSteps()}),r._readRequests=new Y))}function Xs(e,r){e._state="errored",e._storedError=r;let i=e._reader;i!==void 0&&(On(i,r),Me(i)?(i._readRequests.forEach(u=>{u._errorSteps(r)}),i._readRequests=new Y):(i._readIntoRequests.forEach(u=>{u._errorSteps(r)}),i._readIntoRequests=new Y))}function it(e){return new TypeError(`ReadableStream.prototype.${e} can only be used on a ReadableStream`)}function Js(e,r){Ae(e,r);let i=e?.highWaterMark;return In(i,"highWaterMark","QueuingStrategyInit"),{highWaterMark:Wn(i)}}let Ks=e=>e.byteLength;Object.defineProperty(Ks,"name",{value:"size",configurable:!0});class Yr{constructor(r){ke(r,1,"ByteLengthQueuingStrategy"),r=Js(r,"First parameter"),this._byteLengthQueuingStrategyHighWaterMark=r.highWaterMark}get highWaterMark(){if(!ei(this))throw Zs("highWaterMark");return this._byteLengthQueuingStrategyHighWaterMark}get size(){if(!ei(this))throw Zs("size");return Ks}}Object.defineProperties(Yr.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(Yr.prototype,t.toStringTag,{value:"ByteLengthQueuingStrategy",configurable:!0});function Zs(e){return new TypeError(`ByteLengthQueuingStrategy.prototype.${e} can only be used on a ByteLengthQueuingStrategy`)}function ei(e){return!l(e)||!Object.prototype.hasOwnProperty.call(e,"_byteLengthQueuingStrategyHighWaterMark")?!1:e instanceof Yr}let ti=()=>1;Object.defineProperty(ti,"name",{value:"size",configurable:!0});class Qr{constructor(r){ke(r,1,"CountQueuingStrategy"),r=Js(r,"First parameter"),this._countQueuingStrategyHighWaterMark=r.highWaterMark}get highWaterMark(){if(!ni(this))throw ri("highWaterMark");return this._countQueuingStrategyHighWaterMark}get size(){if(!ni(this))throw ri("size");return ti}}Object.defineProperties(Qr.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(Qr.prototype,t.toStringTag,{value:"CountQueuingStrategy",configurable:!0});function ri(e){return new TypeError(`CountQueuingStrategy.prototype.${e} can only be used on a CountQueuingStrategy`)}function ni(e){return!l(e)||!Object.prototype.hasOwnProperty.call(e,"_countQueuingStrategyHighWaterMark")?!1:e instanceof Qr}function wu(e,r){Ae(e,r);let i=e?.flush,u=e?.readableType,d=e?.start,p=e?.transform,_=e?.writableType;return{flush:i===void 0?void 0:Ru(i,e,`${r} has member 'flush' that`),readableType:u,start:d===void 0?void 0:Tu(d,e,`${r} has member 'start' that`),transform:p===void 0?void 0:Eu(p,e,`${r} has member 'transform' that`),writableType:_}}function Ru(e,r,i){return de(e,i),u=>W(e,r,[u])}function Tu(e,r,i){return de(e,i),u=>M(e,r,[u])}function Eu(e,r,i){return de(e,i),(u,d)=>W(e,r,[u,d])}class Xr{constructor(r={},i={},u={}){r===void 0&&(r=null);let d=Wr(i,"Second parameter"),p=Wr(u,"Third parameter"),_=wu(r,"First parameter");if(_.readableType!==void 0)throw new RangeError("Invalid readableType specified");if(_.writableType!==void 0)throw new RangeError("Invalid writableType specified");let R=Qt(p,0),k=Ir(p),B=Qt(d,1),O=Ir(d),L,U=g(pe=>{L=pe});Cu(this,U,B,O,R,k),vu(this,_),_.start!==void 0?L(_.start(this._transformStreamController)):L(void 0)}get readable(){if(!oi(this))throw li("readable");return this._readable}get writable(){if(!oi(this))throw li("writable");return this._writable}}Object.defineProperties(Xr.prototype,{readable:{enumerable:!0},writable:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(Xr.prototype,t.toStringTag,{value:"TransformStream",configurable:!0});function Cu(e,r,i,u,d,p){function _(){return r}function R(U){return xu(e,U)}function k(U){return Bu(e,U)}function B(){return Ou(e)}e._writable=Dl(_,R,B,k,i,u);function O(){return Lu(e)}function L(U){return Kr(e,U),w(void 0)}e._readable=so(_,O,L,d,p),e._backpressure=void 0,e._backpressureChangePromise=void 0,e._backpressureChangePromise_resolve=void 0,Zr(e,!0),e._transformStreamController=void 0}function oi(e){return!l(e)||!Object.prototype.hasOwnProperty.call(e,"_transformStreamController")?!1:e instanceof Xr}function Jr(e,r){$e(e._readable._readableStreamController,r),Kr(e,r)}function Kr(e,r){si(e._transformStreamController),Kn(e._writable._writableStreamController,r),e._backpressure&&Zr(e,!1)}function Zr(e,r){e._backpressureChangePromise!==void 0&&e._backpressureChangePromise_resolve(),e._backpressureChangePromise=g(i=>{e._backpressureChangePromise_resolve=i}),e._backpressure=r}class rr{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!en(this))throw tn("desiredSize");let r=this._controlledTransformStream._readable._readableStreamController;return oo(r)}enqueue(r=void 0){if(!en(this))throw tn("enqueue");ii(this,r)}error(r=void 0){if(!en(this))throw tn("error");Au(this,r)}terminate(){if(!en(this))throw tn("terminate");ku(this)}}Object.defineProperties(rr.prototype,{enqueue:{enumerable:!0},error:{enumerable:!0},terminate:{enumerable:!0},desiredSize:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(rr.prototype,t.toStringTag,{value:"TransformStreamDefaultController",configurable:!0});function en(e){return!l(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledTransformStream")?!1:e instanceof rr}function Pu(e,r,i,u){r._controlledTransformStream=e,e._transformStreamController=r,r._transformAlgorithm=i,r._flushAlgorithm=u}function vu(e,r){let i=Object.create(rr.prototype),u=p=>{try{return ii(i,p),w(void 0)}catch(_){return S(_)}},d=()=>w(void 0);r.transform!==void 0&&(u=p=>r.transform(p,i)),r.flush!==void 0&&(d=()=>r.flush(i)),Pu(e,i,u,d)}function si(e){e._transformAlgorithm=void 0,e._flushAlgorithm=void 0}function ii(e,r){let i=e._controlledTransformStream,u=i._readable._readableStreamController;if(!Tt(u))throw new TypeError("Readable side is not in a state that permits enqueue");try{Gr(u,r)}catch(p){throw Kr(i,p),i._readable._storedError}iu(u)!==i._backpressure&&Zr(i,!0)}function Au(e,r){Jr(e._controlledTransformStream,r)}function ai(e,r){let i=e._transformAlgorithm(r);return D(i,void 0,u=>{throw Jr(e._controlledTransformStream,u),u})}function ku(e){let r=e._controlledTransformStream,i=r._readable._readableStreamController;er(i);let u=new TypeError("TransformStream terminated");Kr(r,u)}function xu(e,r){let i=e._transformStreamController;if(e._backpressure){let u=e._backpressureChangePromise;return D(u,()=>{let d=e._writable;if(d._state==="erroring")throw d._storedError;return ai(i,r)})}return ai(i,r)}function Bu(e,r){return Jr(e,r),w(void 0)}function Ou(e){let r=e._readable,i=e._transformStreamController,u=i._flushAlgorithm();return si(i),D(u,()=>{if(r._state==="errored")throw r._storedError;er(r._readableStreamController)},d=>{throw Jr(e,d),r._storedError})}function Lu(e){return Zr(e,!1),e._backpressureChangePromise}function tn(e){return new TypeError(`TransformStreamDefaultController.prototype.${e} can only be used on a TransformStreamDefaultController`)}function li(e){return new TypeError(`TransformStream.prototype.${e} can only be used on a TransformStream`)}o.ByteLengthQueuingStrategy=Yr,o.CountQueuingStrategy=Qr,o.ReadableByteStreamController=yt,o.ReadableStream=ze,o.ReadableStreamBYOBReader=Yt,o.ReadableStreamBYOBRequest=Ht,o.ReadableStreamDefaultController=Rt,o.ReadableStreamDefaultReader=$t,o.TransformStream=Xr,o.TransformStreamDefaultController=rr,o.WritableStream=Xt,o.WritableStreamDefaultController=wt,o.WritableStreamDefaultWriter=Jt,Object.defineProperty(o,"__esModule",{value:!0})})});var pi=G(()=>{if(!globalThis.ReadableStream)try{let o=require("node:process"),{emitWarning:t}=o;try{o.emitWarning=()=>{},Object.assign(globalThis,require("node:stream/web")),o.emitWarning=t}catch(n){throw o.emitWarning=t,n}}catch{Object.assign(globalThis,mi())}try{let{Blob:o}=require("buffer");o&&!o.prototype.stream&&(o.prototype.stream=function(n){let s=0,a=this;return new ReadableStream({type:"bytes",async pull(l){let m=await a.slice(s,Math.min(a.size,s+65536)).arrayBuffer();s+=m.byteLength,l.enqueue(new Uint8Array(m)),s===a.size&&l.close()}})})}catch{}});async function*lo(o,t=!0){for(let n of o)if("stream"in n)yield*n.stream();else if(ArrayBuffer.isView(n))if(t){let s=n.byteOffset,a=n.byteOffset+n.byteLength;for(;s!==a;){let l=Math.min(a-s,_i),f=n.buffer.slice(s,s+l);s+=f.byteLength,yield new Uint8Array(f)}}else yield n;else{let s=0;for(;s!==n.size;){let l=await n.slice(s,Math.min(n.size,s+_i)).arrayBuffer();s+=l.byteLength,yield new Uint8Array(l)}}}var Dc,_i,bi,Uu,lt,or=nr(()=>{Dc=at(pi(),1);_i=65536;bi=class uo{#e=[];#t="";#r=0;constructor(t=[],n={}){if(typeof t!="object"||t===null)throw new TypeError("Failed to construct 'Blob': The provided value cannot be converted to a sequence.");if(typeof t[Symbol.iterator]!="function")throw new TypeError("Failed to construct 'Blob': The object must have a callable @@iterator property.");if(typeof n!="object"&&typeof n!="function")throw new TypeError("Failed to construct 'Blob': parameter 2 cannot convert to dictionary.");n===null&&(n={});let s=new TextEncoder;for(let l of t){let f;ArrayBuffer.isView(l)?f=new Uint8Array(l.buffer.slice(l.byteOffset,l.byteOffset+l.byteLength)):l instanceof ArrayBuffer?f=new Uint8Array(l.slice(0)):l instanceof uo?f=l:f=s.encode(l),this.#r+=ArrayBuffer.isView(f)?f.byteLength:f.size,this.#e.push(f)}let a=n.type===void 0?"":String(n.type);this.#t=/^[\x20-\x7E]*$/.test(a)?a:""}get size(){return this.#r}get type(){return this.#t}async text(){let t=new TextDecoder,n="";for await(let s of lo(this.#e,!1))n+=t.decode(s,{stream:!0});return n+=t.decode(),n}async arrayBuffer(){let t=new Uint8Array(this.size),n=0;for await(let s of lo(this.#e,!1))t.set(s,n),n+=s.length;return t.buffer}stream(){let t=lo(this.#e,!0);return new globalThis.ReadableStream({type:"bytes",async pull(n){let s=await t.next();s.done?n.close():n.enqueue(s.value)},async cancel(){await t.return()}})}slice(t=0,n=this.size,s=""){let{size:a}=this,l=t<0?Math.max(a+t,0):Math.min(t,a),f=n<0?Math.max(a+n,0):Math.min(n,a),m=Math.max(f-l,0),c=this.#e,h=[],b=0;for(let w of c){if(b>=m)break;let S=ArrayBuffer.isView(w)?w.byteLength:w.size;if(l&&S<=l)l-=S,f-=S;else{let y;ArrayBuffer.isView(w)?(y=w.subarray(l,Math.min(S,f)),b+=y.byteLength):(y=w.slice(l,Math.min(S,f)),b+=y.size),f-=S,h.push(y),l=0}}let g=new uo([],{type:String(s).toLowerCase()});return g.#r=m,g.#e=h,g}get[Symbol.toStringTag](){return"Blob"}static[Symbol.hasInstance](t){return t&&typeof t=="object"&&typeof t.constructor=="function"&&(typeof t.stream=="function"||typeof t.arrayBuffer=="function")&&/^(Blob|File)$/.test(t[Symbol.toStringTag])}};Object.defineProperties(bi.prototype,{size:{enumerable:!0},type:{enumerable:!0},slice:{enumerable:!0}});Uu=bi,lt=Uu});var $u,zu,sr,fo=nr(()=>{or();$u=class extends lt{#e=0;#t="";constructor(t,n,s={}){if(arguments.length<2)throw new TypeError(`Failed to construct 'File': 2 arguments required, but only ${arguments.length} present.`);super(t,s),s===null&&(s={});let a=s.lastModified===void 0?Date.now():Number(s.lastModified);Number.isNaN(a)||(this.#e=a),this.#t=String(n)}get name(){return this.#t}get lastModified(){return this.#e}get[Symbol.toStringTag](){return"File"}},zu=$u,sr=zu});function Si(o,t=lt){var n=`${yi()}${yi()}`.replace(/\./g,"").slice(-28).padStart(32,"-"),s=[],a=`--${n}\r
Content-Disposition: form-data; name="`;return o.forEach((l,f)=>typeof l=="string"?s.push(a+co(f)+`"\r
\r
${l.replace(/\r(?!\n)|(?<!\r)\n/g,`\r
`)}\r
`):s.push(a+co(f)+`"; filename="${co(l.name,1)}"\r
Content-Type: ${l.type||"application/octet-stream"}\r
\r
`,l,`\r
`)),s.push(`--${n}--`),new t(s,{type:"multipart/form-data; boundary="+n})}var ir,ju,Hu,yi,Gu,gi,co,ut,At,ho=nr(()=>{or();fo();({toStringTag:ir,iterator:ju,hasInstance:Hu}=Symbol),yi=Math.random,Gu="append,set,get,getAll,delete,keys,values,entries,forEach,constructor".split(","),gi=(o,t,n)=>(o+="",/^(Blob|File)$/.test(t&&t[ir])?[(n=n!==void 0?n+"":t[ir]=="File"?t.name:"blob",o),t.name!==n||t[ir]=="blob"?new sr([t],n,t):t]:[o,t+""]),co=(o,t)=>(t?o:o.replace(/\r?\n|\r/g,`\r
`)).replace(/\n/g,"%0A").replace(/\r/g,"%0D").replace(/"/g,"%22"),ut=(o,t,n)=>{if(t.length<n)throw new TypeError(`Failed to execute '${o}' on 'FormData': ${n} arguments required, but only ${t.length} present.`)},At=class{#e=[];constructor(...t){if(t.length)throw new TypeError("Failed to construct 'FormData': parameter 1 is not of type 'HTMLFormElement'.")}get[ir](){return"FormData"}[ju](){return this.entries()}static[Hu](t){return t&&typeof t=="object"&&t[ir]==="FormData"&&!Gu.some(n=>typeof t[n]!="function")}append(...t){ut("append",arguments,2),this.#e.push(gi(...t))}delete(t){ut("delete",arguments,1),t+="",this.#e=this.#e.filter(([n])=>n!==t)}get(t){ut("get",arguments,1),t+="";for(var n=this.#e,s=n.length,a=0;a<s;a++)if(n[a][0]===t)return n[a][1];return null}getAll(t,n){return ut("getAll",arguments,1),n=[],t+="",this.#e.forEach(s=>s[0]===t&&n.push(s[1])),n}has(t){return ut("has",arguments,1),t+="",this.#e.some(n=>n[0]===t)}forEach(t,n){ut("forEach",arguments,1);for(var[s,a]of this)t.call(n,a,s,this)}set(...t){ut("set",arguments,2);var n=[],s=!0;t=gi(...t),this.#e.forEach(a=>{a[0]===t[0]?s&&(s=!n.push(t)):n.push(a)}),s&&n.push(t),this.#e=n}*entries(){yield*this.#e}*keys(){for(var[t]of this)yield t}*values(){for(var[,t]of this)yield t}}});var lr,Ri,Vu,Yu,an,Ti=nr(()=>{lr=require("node:fs"),Ri=require("node:worker_threads");fo();or();({stat:Vu}=lr.promises),Yu=globalThis.DOMException||(()=>{let o=new Ri.MessageChannel().port1,t=new ArrayBuffer(0);try{o.postMessage(t,[t,t])}catch(n){return n.constructor}})(),an=class{#e;#t;constructor(t){this.#e=t.path,this.#t=t.start,this.size=t.size,this.lastModified=t.lastModified}slice(t,n){return new an({path:this.#e,lastModified:this.lastModified,size:n-t,start:t})}async*stream(){let{mtimeMs:t}=await Vu(this.#e);if(t>this.lastModified)throw new Yu("The requested file could not be read, typically due to permission problems that have occurred after a reference to a file was acquired.","NotReadableError");yield*(0,lr.createReadStream)(this.#e,{start:this.#t,end:this.#t+this.size-1})}get[Symbol.toStringTag](){return"Blob"}}});var Ci={};fi(Ci,{toFormData:()=>tf});function ef(o){let t=o.match(/\bfilename=("(.*?)"|([^()<>@,;:\\"/[\]?={}\s\t]+))($|;\s)/i);if(!t)return;let n=t[2]||t[3]||"",s=n.slice(n.lastIndexOf("\\")+1);return s=s.replace(/%22/g,'"'),s=s.replace(/&#(\d{4});/g,(a,l)=>String.fromCharCode(l)),s}async function tf(o,t){if(!/multipart/i.test(t))throw new TypeError("Failed to fetch");let n=t.match(/boundary=(?:"([^"]+)"|([^;]+))/i);if(!n)throw new TypeError("no or bad content-type header, no multipart boundary");let s=new po(n[1]||n[2]),a,l,f,m,c,h,b=[],g=new At,w=A=>{f+=P.decode(A,{stream:!0})},S=A=>{b.push(A)},y=()=>{let A=new sr(b,h,{type:c});g.append(m,A)},T=()=>{g.append(m,f)},P=new TextDecoder("utf-8");P.decode(),s.onPartBegin=function(){s.onPartData=w,s.onPartEnd=T,a="",l="",f="",m="",c="",h=null,b.length=0},s.onHeaderField=function(A){a+=P.decode(A,{stream:!0})},s.onHeaderValue=function(A){l+=P.decode(A,{stream:!0})},s.onHeaderEnd=function(){if(l+=P.decode(),a=a.toLowerCase(),a==="content-disposition"){let A=l.match(/\bname=("([^"]*)"|([^()<>@,;:\\"/[\]?={}\s\t]+))/i);A&&(m=A[2]||A[3]||""),h=ef(l),h&&(s.onPartData=S,s.onPartEnd=y)}else a==="content-type"&&(c=l);l="",a=""};for await(let A of o)s.write(A);return s.end(),g}var Se,N,Ei,Ve,ln,un,Qu,ur,Xu,Ju,Ku,Zu,ft,po,Pi=nr(()=>{Ti();ho();Se=0,N={START_BOUNDARY:Se++,HEADER_FIELD_START:Se++,HEADER_FIELD:Se++,HEADER_VALUE_START:Se++,HEADER_VALUE:Se++,HEADER_VALUE_ALMOST_DONE:Se++,HEADERS_ALMOST_DONE:Se++,PART_DATA_START:Se++,PART_DATA:Se++,END:Se++},Ei=1,Ve={PART_BOUNDARY:Ei,LAST_BOUNDARY:Ei*=2},ln=10,un=13,Qu=32,ur=45,Xu=58,Ju=97,Ku=122,Zu=o=>o|32,ft=()=>{},po=class{constructor(t){this.index=0,this.flags=0,this.onHeaderEnd=ft,this.onHeaderField=ft,this.onHeadersEnd=ft,this.onHeaderValue=ft,this.onPartBegin=ft,this.onPartData=ft,this.onPartEnd=ft,this.boundaryChars={},t=`\r
--`+t;let n=new Uint8Array(t.length);for(let s=0;s<t.length;s++)n[s]=t.charCodeAt(s),this.boundaryChars[n[s]]=!0;this.boundary=n,this.lookbehind=new Uint8Array(this.boundary.length+8),this.state=N.START_BOUNDARY}write(t){let n=0,s=t.length,a=this.index,{lookbehind:l,boundary:f,boundaryChars:m,index:c,state:h,flags:b}=this,g=this.boundary.length,w=g-1,S=t.length,y,T,P=I=>{this[I+"Mark"]=n},A=I=>{delete this[I+"Mark"]},D=(I,M,W,ce)=>{(M===void 0||M!==W)&&this[I](ce&&ce.subarray(M,W))},q=(I,M)=>{let W=I+"Mark";W in this&&(M?(D(I,this[W],n,t),delete this[W]):(D(I,this[W],t.length,t),this[W]=0))};for(n=0;n<s;n++)switch(y=t[n],h){case N.START_BOUNDARY:if(c===f.length-2){if(y===ur)b|=Ve.LAST_BOUNDARY;else if(y!==un)return;c++;break}else if(c-1===f.length-2){if(b&Ve.LAST_BOUNDARY&&y===ur)h=N.END,b=0;else if(!(b&Ve.LAST_BOUNDARY)&&y===ln)c=0,D("onPartBegin"),h=N.HEADER_FIELD_START;else return;break}y!==f[c+2]&&(c=-2),y===f[c+2]&&c++;break;case N.HEADER_FIELD_START:h=N.HEADER_FIELD,P("onHeaderField"),c=0;case N.HEADER_FIELD:if(y===un){A("onHeaderField"),h=N.HEADERS_ALMOST_DONE;break}if(c++,y===ur)break;if(y===Xu){if(c===1)return;q("onHeaderField",!0),h=N.HEADER_VALUE_START;break}if(T=Zu(y),T<Ju||T>Ku)return;break;case N.HEADER_VALUE_START:if(y===Qu)break;P("onHeaderValue"),h=N.HEADER_VALUE;case N.HEADER_VALUE:y===un&&(q("onHeaderValue",!0),D("onHeaderEnd"),h=N.HEADER_VALUE_ALMOST_DONE);break;case N.HEADER_VALUE_ALMOST_DONE:if(y!==ln)return;h=N.HEADER_FIELD_START;break;case N.HEADERS_ALMOST_DONE:if(y!==ln)return;D("onHeadersEnd"),h=N.PART_DATA_START;break;case N.PART_DATA_START:h=N.PART_DATA,P("onPartData");case N.PART_DATA:if(a=c,c===0){for(n+=w;n<S&&!(t[n]in m);)n+=g;n-=w,y=t[n]}if(c<f.length)f[c]===y?(c===0&&q("onPartData",!0),c++):c=0;else if(c===f.length)c++,y===un?b|=Ve.PART_BOUNDARY:y===ur?b|=Ve.LAST_BOUNDARY:c=0;else if(c-1===f.length)if(b&Ve.PART_BOUNDARY){if(c=0,y===ln){b&=~Ve.PART_BOUNDARY,D("onPartEnd"),D("onPartBegin"),h=N.HEADER_FIELD_START;break}}else b&Ve.LAST_BOUNDARY&&y===ur?(D("onPartEnd"),h=N.END,b=0):c=0;if(c>0)l[c-1]=y;else if(a>0){let I=new Uint8Array(l.buffer,l.byteOffset,l.byteLength);D("onPartData",0,a,I),a=0,P("onPartData"),n--}break;case N.END:break;default:throw new Error(`Unexpected state entered: ${h}`)}q("onHeaderField"),q("onHeaderValue"),q("onPartData"),this.index=c,this.state=h,this.flags=b}end(){if(this.state===N.HEADER_FIELD_START&&this.index===0||this.state===N.PART_DATA&&this.index===this.boundary.length)this.onPartEnd();else if(this.state!==N.END)throw new Error("MultipartParser.end(): stream ended unexpectedly")}}});var Xe=G((Nd,Yi)=>{"use strict";Yi.exports={BINARY_TYPES:["nodebuffer","arraybuffer","fragments"],EMPTY_BUFFER:Buffer.alloc(0),GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",kForOnEventAttribute:Symbol("kIsForOnEventAttribute"),kListener:Symbol("kListener"),kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),NOOP:()=>{}}});var mr=G((qd,To)=>{"use strict";var{EMPTY_BUFFER:hf}=Xe();function Qi(o,t){if(o.length===0)return hf;if(o.length===1)return o[0];let n=Buffer.allocUnsafe(t),s=0;for(let a=0;a<o.length;a++){let l=o[a];n.set(l,s),s+=l.length}return s<t?n.slice(0,s):n}function Xi(o,t,n,s,a){for(let l=0;l<a;l++)n[s+l]=o[l]^t[l&3]}function Ji(o,t){for(let n=0;n<o.length;n++)o[n]^=t[n&3]}function Ki(o){return o.byteLength===o.buffer.byteLength?o.buffer:o.buffer.slice(o.byteOffset,o.byteOffset+o.byteLength)}function yn(o){if(yn.readOnly=!0,Buffer.isBuffer(o))return o;let t;return o instanceof ArrayBuffer?t=Buffer.from(o):ArrayBuffer.isView(o)?t=Buffer.from(o.buffer,o.byteOffset,o.byteLength):(t=Buffer.from(o),yn.readOnly=!1),t}try{let o=require("bufferutil");To.exports={concat:Qi,mask(t,n,s,a,l){l<48?Xi(t,n,s,a,l):o.mask(t,n,s,a,l)},toArrayBuffer:Ki,toBuffer:yn,unmask(t,n){t.length<32?Ji(t,n):o.unmask(t,n)}}}catch{To.exports={concat:Qi,mask:Xi,toArrayBuffer:Ki,toBuffer:yn,unmask:Ji}}});var ta=G((Md,ea)=>{"use strict";var Zi=Symbol("kDone"),Eo=Symbol("kRun"),Co=class{constructor(t){this[Zi]=()=>{this.pending--,this[Eo]()},this.concurrency=t||1/0,this.jobs=[],this.pending=0}add(t){this.jobs.push(t),this[Eo]()}[Eo](){if(this.pending!==this.concurrency&&this.jobs.length){let t=this.jobs.shift();this.pending++,t(this[Zi])}}};ea.exports=Co});var br=G((Ud,sa)=>{"use strict";var pr=require("zlib"),ra=mr(),mf=ta(),{kStatusCode:na}=Xe(),pf=Buffer.from([0,0,255,255]),wn=Symbol("permessage-deflate"),De=Symbol("total-length"),_r=Symbol("callback"),Je=Symbol("buffers"),Sn=Symbol("error"),gn,Po=class{constructor(t,n,s){if(this._maxPayload=s|0,this._options=t||{},this._threshold=this._options.threshold!==void 0?this._options.threshold:1024,this._isServer=!!n,this._deflate=null,this._inflate=null,this.params=null,!gn){let a=this._options.concurrencyLimit!==void 0?this._options.concurrencyLimit:10;gn=new mf(a)}}static get extensionName(){return"permessage-deflate"}offer(){let t={};return this._options.serverNoContextTakeover&&(t.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(t.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(t.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?t.client_max_window_bits=this._options.clientMaxWindowBits:this._options.clientMaxWindowBits==null&&(t.client_max_window_bits=!0),t}accept(t){return t=this.normalizeParams(t),this.params=this._isServer?this.acceptAsServer(t):this.acceptAsClient(t),this.params}cleanup(){if(this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate){let t=this._deflate[_r];this._deflate.close(),this._deflate=null,t&&t(new Error("The deflate stream was closed while data was being processed"))}}acceptAsServer(t){let n=this._options,s=t.find(a=>!(n.serverNoContextTakeover===!1&&a.server_no_context_takeover||a.server_max_window_bits&&(n.serverMaxWindowBits===!1||typeof n.serverMaxWindowBits=="number"&&n.serverMaxWindowBits>a.server_max_window_bits)||typeof n.clientMaxWindowBits=="number"&&!a.client_max_window_bits));if(!s)throw new Error("None of the extension offers can be accepted");return n.serverNoContextTakeover&&(s.server_no_context_takeover=!0),n.clientNoContextTakeover&&(s.client_no_context_takeover=!0),typeof n.serverMaxWindowBits=="number"&&(s.server_max_window_bits=n.serverMaxWindowBits),typeof n.clientMaxWindowBits=="number"?s.client_max_window_bits=n.clientMaxWindowBits:(s.client_max_window_bits===!0||n.clientMaxWindowBits===!1)&&delete s.client_max_window_bits,s}acceptAsClient(t){let n=t[0];if(this._options.clientNoContextTakeover===!1&&n.client_no_context_takeover)throw new Error('Unexpected parameter "client_no_context_takeover"');if(!n.client_max_window_bits)typeof this._options.clientMaxWindowBits=="number"&&(n.client_max_window_bits=this._options.clientMaxWindowBits);else if(this._options.clientMaxWindowBits===!1||typeof this._options.clientMaxWindowBits=="number"&&n.client_max_window_bits>this._options.clientMaxWindowBits)throw new Error('Unexpected or invalid parameter "client_max_window_bits"');return n}normalizeParams(t){return t.forEach(n=>{Object.keys(n).forEach(s=>{let a=n[s];if(a.length>1)throw new Error(`Parameter "${s}" must have only a single value`);if(a=a[0],s==="client_max_window_bits"){if(a!==!0){let l=+a;if(!Number.isInteger(l)||l<8||l>15)throw new TypeError(`Invalid value for parameter "${s}": ${a}`);a=l}else if(!this._isServer)throw new TypeError(`Invalid value for parameter "${s}": ${a}`)}else if(s==="server_max_window_bits"){let l=+a;if(!Number.isInteger(l)||l<8||l>15)throw new TypeError(`Invalid value for parameter "${s}": ${a}`);a=l}else if(s==="client_no_context_takeover"||s==="server_no_context_takeover"){if(a!==!0)throw new TypeError(`Invalid value for parameter "${s}": ${a}`)}else throw new Error(`Unknown parameter "${s}"`);n[s]=a})}),t}decompress(t,n,s){gn.add(a=>{this._decompress(t,n,(l,f)=>{a(),s(l,f)})})}compress(t,n,s){gn.add(a=>{this._compress(t,n,(l,f)=>{a(),s(l,f)})})}_decompress(t,n,s){let a=this._isServer?"client":"server";if(!this._inflate){let l=`${a}_max_window_bits`,f=typeof this.params[l]!="number"?pr.Z_DEFAULT_WINDOWBITS:this.params[l];this._inflate=pr.createInflateRaw({...this._options.zlibInflateOptions,windowBits:f}),this._inflate[wn]=this,this._inflate[De]=0,this._inflate[Je]=[],this._inflate.on("error",bf),this._inflate.on("data",oa)}this._inflate[_r]=s,this._inflate.write(t),n&&this._inflate.write(pf),this._inflate.flush(()=>{let l=this._inflate[Sn];if(l){this._inflate.close(),this._inflate=null,s(l);return}let f=ra.concat(this._inflate[Je],this._inflate[De]);this._inflate._readableState.endEmitted?(this._inflate.close(),this._inflate=null):(this._inflate[De]=0,this._inflate[Je]=[],n&&this.params[`${a}_no_context_takeover`]&&this._inflate.reset()),s(null,f)})}_compress(t,n,s){let a=this._isServer?"server":"client";if(!this._deflate){let l=`${a}_max_window_bits`,f=typeof this.params[l]!="number"?pr.Z_DEFAULT_WINDOWBITS:this.params[l];this._deflate=pr.createDeflateRaw({...this._options.zlibDeflateOptions,windowBits:f}),this._deflate[De]=0,this._deflate[Je]=[],this._deflate.on("data",_f)}this._deflate[_r]=s,this._deflate.write(t),this._deflate.flush(pr.Z_SYNC_FLUSH,()=>{if(!this._deflate)return;let l=ra.concat(this._deflate[Je],this._deflate[De]);n&&(l=l.slice(0,l.length-4)),this._deflate[_r]=null,this._deflate[De]=0,this._deflate[Je]=[],n&&this.params[`${a}_no_context_takeover`]&&this._deflate.reset(),s(null,l)})}};sa.exports=Po;function _f(o){this[Je].push(o),this[De]+=o.length}function oa(o){if(this[De]+=o.length,this[wn]._maxPayload<1||this[De]<=this[wn]._maxPayload){this[Je].push(o);return}this[Sn]=new RangeError("Max payload size exceeded"),this[Sn].code="WS_ERR_UNSUPPORTED_MESSAGE_LENGTH",this[Sn][na]=1009,this.removeListener("data",oa),this.reset()}function bf(o){this[wn]._inflate=null,o[na]=1007,this[_r](o)}});var yr=G(($d,vo)=>{"use strict";var ia=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0];function aa(o){return o>=1e3&&o<=1014&&o!==1004&&o!==1005&&o!==1006||o>=3e3&&o<=4999}function la(o){let t=o.length,n=0;for(;n<t;)if((o[n]&128)===0)n++;else if((o[n]&224)===192){if(n+1===t||(o[n+1]&192)!==128||(o[n]&254)===192)return!1;n+=2}else if((o[n]&240)===224){if(n+2>=t||(o[n+1]&192)!==128||(o[n+2]&192)!==128||o[n]===224&&(o[n+1]&224)===128||o[n]===237&&(o[n+1]&224)===160)return!1;n+=3}else if((o[n]&248)===240){if(n+3>=t||(o[n+1]&192)!==128||(o[n+2]&192)!==128||(o[n+3]&192)!==128||o[n]===240&&(o[n+1]&240)===128||o[n]===244&&o[n+1]>143||o[n]>244)return!1;n+=4}else return!1;return!0}try{let o=require("utf-8-validate");vo.exports={isValidStatusCode:aa,isValidUTF8(t){return t.length<150?la(t):o(t)},tokenChars:ia}}catch{vo.exports={isValidStatusCode:aa,isValidUTF8:la,tokenChars:ia}}});var Bo=G((zd,pa)=>{"use strict";var{Writable:yf}=require("stream"),ua=br(),{BINARY_TYPES:gf,EMPTY_BUFFER:fa,kStatusCode:Sf,kWebSocket:wf}=Xe(),{concat:Ao,toArrayBuffer:Rf,unmask:Tf}=mr(),{isValidStatusCode:Ef,isValidUTF8:ca}=yr(),gr=0,da=1,ha=2,ma=3,ko=4,Cf=5,xo=class extends yf{constructor(t={}){super(),this._binaryType=t.binaryType||gf[0],this._extensions=t.extensions||{},this._isServer=!!t.isServer,this._maxPayload=t.maxPayload|0,this._skipUTF8Validation=!!t.skipUTF8Validation,this[wf]=void 0,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._state=gr,this._loop=!1}_write(t,n,s){if(this._opcode===8&&this._state==gr)return s();this._bufferedBytes+=t.length,this._buffers.push(t),this.startLoop(s)}consume(t){if(this._bufferedBytes-=t,t===this._buffers[0].length)return this._buffers.shift();if(t<this._buffers[0].length){let s=this._buffers[0];return this._buffers[0]=s.slice(t),s.slice(0,t)}let n=Buffer.allocUnsafe(t);do{let s=this._buffers[0],a=n.length-t;t>=s.length?n.set(this._buffers.shift(),a):(n.set(new Uint8Array(s.buffer,s.byteOffset,t),a),this._buffers[0]=s.slice(t)),t-=s.length}while(t>0);return n}startLoop(t){let n;this._loop=!0;do switch(this._state){case gr:n=this.getInfo();break;case da:n=this.getPayloadLength16();break;case ha:n=this.getPayloadLength64();break;case ma:this.getMask();break;case ko:n=this.getData(t);break;default:this._loop=!1;return}while(this._loop);t(n)}getInfo(){if(this._bufferedBytes<2){this._loop=!1;return}let t=this.consume(2);if((t[0]&48)!==0)return this._loop=!1,$(RangeError,"RSV2 and RSV3 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_2_3");let n=(t[0]&64)===64;if(n&&!this._extensions[ua.extensionName])return this._loop=!1,$(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(this._fin=(t[0]&128)===128,this._opcode=t[0]&15,this._payloadLength=t[1]&127,this._opcode===0){if(n)return this._loop=!1,$(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(!this._fragmented)return this._loop=!1,$(RangeError,"invalid opcode 0",!0,1002,"WS_ERR_INVALID_OPCODE");this._opcode=this._fragmented}else if(this._opcode===1||this._opcode===2){if(this._fragmented)return this._loop=!1,$(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");this._compressed=n}else if(this._opcode>7&&this._opcode<11){if(!this._fin)return this._loop=!1,$(RangeError,"FIN must be set",!0,1002,"WS_ERR_EXPECTED_FIN");if(n)return this._loop=!1,$(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(this._payloadLength>125)return this._loop=!1,$(RangeError,`invalid payload length ${this._payloadLength}`,!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH")}else return this._loop=!1,$(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");if(!this._fin&&!this._fragmented&&(this._fragmented=this._opcode),this._masked=(t[1]&128)===128,this._isServer){if(!this._masked)return this._loop=!1,$(RangeError,"MASK must be set",!0,1002,"WS_ERR_EXPECTED_MASK")}else if(this._masked)return this._loop=!1,$(RangeError,"MASK must be clear",!0,1002,"WS_ERR_UNEXPECTED_MASK");if(this._payloadLength===126)this._state=da;else if(this._payloadLength===127)this._state=ha;else return this.haveLength()}getPayloadLength16(){if(this._bufferedBytes<2){this._loop=!1;return}return this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength()}getPayloadLength64(){if(this._bufferedBytes<8){this._loop=!1;return}let t=this.consume(8),n=t.readUInt32BE(0);return n>Math.pow(2,53-32)-1?(this._loop=!1,$(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009,"WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH")):(this._payloadLength=n*Math.pow(2,32)+t.readUInt32BE(4),this.haveLength())}haveLength(){if(this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0))return this._loop=!1,$(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH");this._masked?this._state=ma:this._state=ko}getMask(){if(this._bufferedBytes<4){this._loop=!1;return}this._mask=this.consume(4),this._state=ko}getData(t){let n=fa;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength){this._loop=!1;return}n=this.consume(this._payloadLength),this._masked&&(this._mask[0]|this._mask[1]|this._mask[2]|this._mask[3])!==0&&Tf(n,this._mask)}if(this._opcode>7)return this.controlMessage(n);if(this._compressed){this._state=Cf,this.decompress(n,t);return}return n.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(n)),this.dataMessage()}decompress(t,n){this._extensions[ua.extensionName].decompress(t,this._fin,(a,l)=>{if(a)return n(a);if(l.length){if(this._messageLength+=l.length,this._messageLength>this._maxPayload&&this._maxPayload>0)return n($(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH"));this._fragments.push(l)}let f=this.dataMessage();if(f)return n(f);this.startLoop(n)})}dataMessage(){if(this._fin){let t=this._messageLength,n=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],this._opcode===2){let s;this._binaryType==="nodebuffer"?s=Ao(n,t):this._binaryType==="arraybuffer"?s=Rf(Ao(n,t)):s=n,this.emit("message",s,!0)}else{let s=Ao(n,t);if(!this._skipUTF8Validation&&!ca(s))return this._loop=!1,$(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");this.emit("message",s,!1)}}this._state=gr}controlMessage(t){if(this._opcode===8)if(this._loop=!1,t.length===0)this.emit("conclude",1005,fa),this.end();else{if(t.length===1)return $(RangeError,"invalid payload length 1",!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH");{let n=t.readUInt16BE(0);if(!Ef(n))return $(RangeError,`invalid status code ${n}`,!0,1002,"WS_ERR_INVALID_CLOSE_CODE");let s=t.slice(2);if(!this._skipUTF8Validation&&!ca(s))return $(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");this.emit("conclude",n,s),this.end()}}else this._opcode===9?this.emit("ping",t):this.emit("pong",t);this._state=gr}};pa.exports=xo;function $(o,t,n,s,a){let l=new o(n?`Invalid WebSocket frame: ${t}`:t);return Error.captureStackTrace(l,$),l.code=a,l[Sf]=s,l}});var Oo=G((Gd,ya)=>{"use strict";var jd=require("net"),Hd=require("tls"),{randomFillSync:Pf}=require("crypto"),_a=br(),{EMPTY_BUFFER:vf}=Xe(),{isValidStatusCode:Af}=yr(),{mask:ba,toBuffer:Ie}=mr(),kf=Buffer.alloc(4),Re=class{constructor(t,n,s){this._extensions=n||{},s&&(this._generateMask=s,this._maskBuffer=Buffer.alloc(4)),this._socket=t,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._deflating=!1,this._queue=[]}static frame(t,n){let s,a=!1,l=2,f=!1;n.mask&&(s=n.maskBuffer||kf,n.generateMask?n.generateMask(s):Pf(s,0,4),f=(s[0]|s[1]|s[2]|s[3])===0,n.readOnly&&!f&&(a=!0),l=6);let m=t.length;t.length>=65536?(l+=8,m=127):t.length>125&&(l+=2,m=126);let c=Buffer.allocUnsafe(a?t.length+l:l);return c[0]=n.fin?n.opcode|128:n.opcode,n.rsv1&&(c[0]|=64),c[1]=m,m===126?c.writeUInt16BE(t.length,2):m===127&&(c[2]=c[3]=0,c.writeUIntBE(t.length,4,6)),n.mask?(c[1]|=128,c[l-4]=s[0],c[l-3]=s[1],c[l-2]=s[2],c[l-1]=s[3],f?[c,t]:a?(ba(t,s,c,l,t.length),[c]):(ba(t,s,t,0,t.length),[c,t])):[c,t]}close(t,n,s,a){let l;if(t===void 0)l=vf;else{if(typeof t!="number"||!Af(t))throw new TypeError("First argument must be a valid error code number");if(n===void 0||!n.length)l=Buffer.allocUnsafe(2),l.writeUInt16BE(t,0);else{let f=Buffer.byteLength(n);if(f>123)throw new RangeError("The message must not be greater than 123 bytes");l=Buffer.allocUnsafe(2+f),l.writeUInt16BE(t,0),typeof n=="string"?l.write(n,2):l.set(n,2)}}this._deflating?this.enqueue([this.doClose,l,s,a]):this.doClose(l,s,a)}doClose(t,n,s){this.sendFrame(Re.frame(t,{fin:!0,rsv1:!1,opcode:8,mask:n,maskBuffer:this._maskBuffer,generateMask:this._generateMask,readOnly:!1}),s)}ping(t,n,s){let a=Ie(t);if(a.length>125)throw new RangeError("The data size must not be greater than 125 bytes");this._deflating?this.enqueue([this.doPing,a,n,Ie.readOnly,s]):this.doPing(a,n,Ie.readOnly,s)}doPing(t,n,s,a){this.sendFrame(Re.frame(t,{fin:!0,rsv1:!1,opcode:9,mask:n,maskBuffer:this._maskBuffer,generateMask:this._generateMask,readOnly:s}),a)}pong(t,n,s){let a=Ie(t);if(a.length>125)throw new RangeError("The data size must not be greater than 125 bytes");this._deflating?this.enqueue([this.doPong,a,n,Ie.readOnly,s]):this.doPong(a,n,Ie.readOnly,s)}doPong(t,n,s,a){this.sendFrame(Re.frame(t,{fin:!0,rsv1:!1,opcode:10,mask:n,maskBuffer:this._maskBuffer,generateMask:this._generateMask,readOnly:s}),a)}send(t,n,s){let a=Ie(t),l=this._extensions[_a.extensionName],f=n.binary?2:1,m=n.compress;if(this._firstFragment?(this._firstFragment=!1,m&&l&&l.params[l._isServer?"server_no_context_takeover":"client_no_context_takeover"]&&(m=a.length>=l._threshold),this._compress=m):(m=!1,f=0),n.fin&&(this._firstFragment=!0),l){let c={fin:n.fin,rsv1:m,opcode:f,mask:n.mask,maskBuffer:this._maskBuffer,generateMask:this._generateMask,readOnly:Ie.readOnly};this._deflating?this.enqueue([this.dispatch,a,this._compress,c,s]):this.dispatch(a,this._compress,c,s)}else this.sendFrame(Re.frame(a,{fin:n.fin,rsv1:!1,opcode:f,mask:n.mask,maskBuffer:this._maskBuffer,generateMask:this._generateMask,readOnly:Ie.readOnly}),s)}dispatch(t,n,s,a){if(!n){this.sendFrame(Re.frame(t,s),a);return}let l=this._extensions[_a.extensionName];this._bufferedBytes+=t.length,this._deflating=!0,l.compress(t,s.fin,(f,m)=>{if(this._socket.destroyed){let c=new Error("The socket was closed while data was being compressed");typeof a=="function"&&a(c);for(let h=0;h<this._queue.length;h++){let b=this._queue[h][4];typeof b=="function"&&b(c)}return}this._bufferedBytes-=t.length,this._deflating=!1,s.readOnly=!1,this.sendFrame(Re.frame(m,s),a),this.dequeue()})}dequeue(){for(;!this._deflating&&this._queue.length;){let t=this._queue.shift();this._bufferedBytes-=t[1].length,Reflect.apply(t[0],this,t.slice(1))}}enqueue(t){this._bufferedBytes+=t[1].length,this._queue.push(t)}sendFrame(t,n){t.length===2?(this._socket.cork(),this._socket.write(t[0]),this._socket.write(t[1],n),this._socket.uncork()):this._socket.write(t[0],n)}};ya.exports=Re});var Aa=G((Vd,va)=>{"use strict";var{kForOnEventAttribute:Lo,kListener:ga}=Xe(),Sa=Symbol("kCode"),wa=Symbol("kData"),Ra=Symbol("kError"),Ta=Symbol("kMessage"),Ea=Symbol("kReason"),It=Symbol("kTarget"),Ca=Symbol("kType"),Pa=Symbol("kWasClean"),We=class{constructor(t){this[It]=null,this[Ca]=t}get target(){return this[It]}get type(){return this[Ca]}};Object.defineProperty(We.prototype,"target",{enumerable:!0});Object.defineProperty(We.prototype,"type",{enumerable:!0});var dt=class extends We{constructor(t,n={}){super(t),this[Sa]=n.code===void 0?0:n.code,this[Ea]=n.reason===void 0?"":n.reason,this[Pa]=n.wasClean===void 0?!1:n.wasClean}get code(){return this[Sa]}get reason(){return this[Ea]}get wasClean(){return this[Pa]}};Object.defineProperty(dt.prototype,"code",{enumerable:!0});Object.defineProperty(dt.prototype,"reason",{enumerable:!0});Object.defineProperty(dt.prototype,"wasClean",{enumerable:!0});var Wt=class extends We{constructor(t,n={}){super(t),this[Ra]=n.error===void 0?null:n.error,this[Ta]=n.message===void 0?"":n.message}get error(){return this[Ra]}get message(){return this[Ta]}};Object.defineProperty(Wt.prototype,"error",{enumerable:!0});Object.defineProperty(Wt.prototype,"message",{enumerable:!0});var Sr=class extends We{constructor(t,n={}){super(t),this[wa]=n.data===void 0?null:n.data}get data(){return this[wa]}};Object.defineProperty(Sr.prototype,"data",{enumerable:!0});var xf={addEventListener(o,t,n={}){let s;if(o==="message")s=function(l,f){let m=new Sr("message",{data:f?l:l.toString()});m[It]=this,t.call(this,m)};else if(o==="close")s=function(l,f){let m=new dt("close",{code:l,reason:f.toString(),wasClean:this._closeFrameReceived&&this._closeFrameSent});m[It]=this,t.call(this,m)};else if(o==="error")s=function(l){let f=new Wt("error",{error:l,message:l.message});f[It]=this,t.call(this,f)};else if(o==="open")s=function(){let l=new We("open");l[It]=this,t.call(this,l)};else return;s[Lo]=!!n[Lo],s[ga]=t,n.once?this.once(o,s):this.on(o,s)},removeEventListener(o,t){for(let n of this.listeners(o))if(n[ga]===t&&!n[Lo]){this.removeListener(o,n);break}}};va.exports={CloseEvent:dt,ErrorEvent:Wt,Event:We,EventTarget:xf,MessageEvent:Sr}});var Do=G((Yd,ka)=>{"use strict";var{tokenChars:wr}=yr();function Te(o,t,n){o[t]===void 0?o[t]=[n]:o[t].push(n)}function Bf(o){let t=Object.create(null),n=Object.create(null),s=!1,a=!1,l=!1,f,m,c=-1,h=-1,b=-1,g=0;for(;g<o.length;g++)if(h=o.charCodeAt(g),f===void 0)if(b===-1&&wr[h]===1)c===-1&&(c=g);else if(g!==0&&(h===32||h===9))b===-1&&c!==-1&&(b=g);else if(h===59||h===44){if(c===-1)throw new SyntaxError(`Unexpected character at index ${g}`);b===-1&&(b=g);let S=o.slice(c,b);h===44?(Te(t,S,n),n=Object.create(null)):f=S,c=b=-1}else throw new SyntaxError(`Unexpected character at index ${g}`);else if(m===void 0)if(b===-1&&wr[h]===1)c===-1&&(c=g);else if(h===32||h===9)b===-1&&c!==-1&&(b=g);else if(h===59||h===44){if(c===-1)throw new SyntaxError(`Unexpected character at index ${g}`);b===-1&&(b=g),Te(n,o.slice(c,b),!0),h===44&&(Te(t,f,n),n=Object.create(null),f=void 0),c=b=-1}else if(h===61&&c!==-1&&b===-1)m=o.slice(c,g),c=b=-1;else throw new SyntaxError(`Unexpected character at index ${g}`);else if(a){if(wr[h]!==1)throw new SyntaxError(`Unexpected character at index ${g}`);c===-1?c=g:s||(s=!0),a=!1}else if(l)if(wr[h]===1)c===-1&&(c=g);else if(h===34&&c!==-1)l=!1,b=g;else if(h===92)a=!0;else throw new SyntaxError(`Unexpected character at index ${g}`);else if(h===34&&o.charCodeAt(g-1)===61)l=!0;else if(b===-1&&wr[h]===1)c===-1&&(c=g);else if(c!==-1&&(h===32||h===9))b===-1&&(b=g);else if(h===59||h===44){if(c===-1)throw new SyntaxError(`Unexpected character at index ${g}`);b===-1&&(b=g);let S=o.slice(c,b);s&&(S=S.replace(/\\/g,""),s=!1),Te(n,m,S),h===44&&(Te(t,f,n),n=Object.create(null),f=void 0),m=void 0,c=b=-1}else throw new SyntaxError(`Unexpected character at index ${g}`);if(c===-1||l||h===32||h===9)throw new SyntaxError("Unexpected end of input");b===-1&&(b=g);let w=o.slice(c,b);return f===void 0?Te(t,w,n):(m===void 0?Te(n,w,!0):s?Te(n,m,w.replace(/\\/g,"")):Te(n,m,w),Te(t,f,n)),t}function Of(o){return Object.keys(o).map(t=>{let n=o[t];return Array.isArray(n)||(n=[n]),n.map(s=>[t].concat(Object.keys(s).map(a=>{let l=s[a];return Array.isArray(l)||(l=[l]),l.map(f=>f===!0?a:`${a}=${f}`).join("; ")})).join("; ")).join(", ")}).join(", ")}ka.exports={format:Of,parse:Bf}});var Mo=G((Xd,qa)=>{"use strict";var Lf=require("events"),Df=require("https"),If=require("http"),Oa=require("net"),Wf=require("tls"),{randomBytes:Ff,createHash:Nf}=require("crypto"),{Readable:Qd}=require("stream"),{URL:Io}=require("url"),Ke=br(),qf=Bo(),Mf=Oo(),{BINARY_TYPES:xa,EMPTY_BUFFER:Rn,GUID:Uf,kForOnEventAttribute:Wo,kListener:$f,kStatusCode:zf,kWebSocket:V,NOOP:La}=Xe(),{EventTarget:{addEventListener:jf,removeEventListener:Hf}}=Aa(),{format:Gf,parse:Vf}=Do(),{toBuffer:Yf}=mr(),Fe=["CONNECTING","OPEN","CLOSING","CLOSED"],Qf=/^[!#$%&'*+\-.0-9A-Z^_`|a-z~]+$/,Fo=[8,13],Xf=30*1e3,v=class extends Lf{constructor(t,n,s){super(),this._binaryType=xa[0],this._closeCode=1006,this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage=Rn,this._closeTimer=null,this._extensions={},this._paused=!1,this._protocol="",this._readyState=v.CONNECTING,this._receiver=null,this._sender=null,this._socket=null,t!==null?(this._bufferedAmount=0,this._isServer=!1,this._redirects=0,n===void 0?n=[]:Array.isArray(n)||(typeof n=="object"&&n!==null?(s=n,n=[]):n=[n]),Da(this,t,n,s)):this._isServer=!0}get binaryType(){return this._binaryType}set binaryType(t){!xa.includes(t)||(this._binaryType=t,this._receiver&&(this._receiver._binaryType=t))}get bufferedAmount(){return this._socket?this._socket._writableState.length+this._sender._bufferedBytes:this._bufferedAmount}get extensions(){return Object.keys(this._extensions).join()}get isPaused(){return this._paused}get onclose(){return null}get onerror(){return null}get onopen(){return null}get onmessage(){return null}get protocol(){return this._protocol}get readyState(){return this._readyState}get url(){return this._url}setSocket(t,n,s){let a=new qf({binaryType:this.binaryType,extensions:this._extensions,isServer:this._isServer,maxPayload:s.maxPayload,skipUTF8Validation:s.skipUTF8Validation});this._sender=new Mf(t,this._extensions,s.generateMask),this._receiver=a,this._socket=t,a[V]=this,t[V]=this,a.on("conclude",Zf),a.on("drain",ec),a.on("error",tc),a.on("message",rc),a.on("ping",nc),a.on("pong",oc),t.setTimeout(0),t.setNoDelay(),n.length>0&&t.unshift(n),t.on("close",Wa),t.on("data",Tn),t.on("end",Fa),t.on("error",Na),this._readyState=v.OPEN,this.emit("open")}emitClose(){if(!this._socket){this._readyState=v.CLOSED,this.emit("close",this._closeCode,this._closeMessage);return}this._extensions[Ke.extensionName]&&this._extensions[Ke.extensionName].cleanup(),this._receiver.removeAllListeners(),this._readyState=v.CLOSED,this.emit("close",this._closeCode,this._closeMessage)}close(t,n){if(this.readyState!==v.CLOSED){if(this.readyState===v.CONNECTING){let s="WebSocket was closed before the connection was established";return le(this,this._req,s)}if(this.readyState===v.CLOSING){this._closeFrameSent&&(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end();return}this._readyState=v.CLOSING,this._sender.close(t,n,!this._isServer,s=>{s||(this._closeFrameSent=!0,(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end())}),this._closeTimer=setTimeout(this._socket.destroy.bind(this._socket),Xf)}}pause(){this.readyState===v.CONNECTING||this.readyState===v.CLOSED||(this._paused=!0,this._socket.pause())}ping(t,n,s){if(this.readyState===v.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof t=="function"?(s=t,t=n=void 0):typeof n=="function"&&(s=n,n=void 0),typeof t=="number"&&(t=t.toString()),this.readyState!==v.OPEN){qo(this,t,s);return}n===void 0&&(n=!this._isServer),this._sender.ping(t||Rn,n,s)}pong(t,n,s){if(this.readyState===v.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof t=="function"?(s=t,t=n=void 0):typeof n=="function"&&(s=n,n=void 0),typeof t=="number"&&(t=t.toString()),this.readyState!==v.OPEN){qo(this,t,s);return}n===void 0&&(n=!this._isServer),this._sender.pong(t||Rn,n,s)}resume(){this.readyState===v.CONNECTING||this.readyState===v.CLOSED||(this._paused=!1,this._receiver._writableState.needDrain||this._socket.resume())}send(t,n,s){if(this.readyState===v.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof n=="function"&&(s=n,n={}),typeof t=="number"&&(t=t.toString()),this.readyState!==v.OPEN){qo(this,t,s);return}let a={binary:typeof t!="string",mask:!this._isServer,compress:!0,fin:!0,...n};this._extensions[Ke.extensionName]||(a.compress=!1),this._sender.send(t||Rn,a,s)}terminate(){if(this.readyState!==v.CLOSED){if(this.readyState===v.CONNECTING){let t="WebSocket was closed before the connection was established";return le(this,this._req,t)}this._socket&&(this._readyState=v.CLOSING,this._socket.destroy())}}};Object.defineProperty(v,"CONNECTING",{enumerable:!0,value:Fe.indexOf("CONNECTING")});Object.defineProperty(v.prototype,"CONNECTING",{enumerable:!0,value:Fe.indexOf("CONNECTING")});Object.defineProperty(v,"OPEN",{enumerable:!0,value:Fe.indexOf("OPEN")});Object.defineProperty(v.prototype,"OPEN",{enumerable:!0,value:Fe.indexOf("OPEN")});Object.defineProperty(v,"CLOSING",{enumerable:!0,value:Fe.indexOf("CLOSING")});Object.defineProperty(v.prototype,"CLOSING",{enumerable:!0,value:Fe.indexOf("CLOSING")});Object.defineProperty(v,"CLOSED",{enumerable:!0,value:Fe.indexOf("CLOSED")});Object.defineProperty(v.prototype,"CLOSED",{enumerable:!0,value:Fe.indexOf("CLOSED")});["binaryType","bufferedAmount","extensions","isPaused","protocol","readyState","url"].forEach(o=>{Object.defineProperty(v.prototype,o,{enumerable:!0})});["open","error","close","message"].forEach(o=>{Object.defineProperty(v.prototype,`on${o}`,{enumerable:!0,get(){for(let t of this.listeners(o))if(t[Wo])return t[$f];return null},set(t){for(let n of this.listeners(o))if(n[Wo]){this.removeListener(o,n);break}typeof t=="function"&&this.addEventListener(o,t,{[Wo]:!0})}})});v.prototype.addEventListener=jf;v.prototype.removeEventListener=Hf;qa.exports=v;function Da(o,t,n,s){let a={protocolVersion:Fo[1],maxPayload:104857600,skipUTF8Validation:!1,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10,...s,createConnection:void 0,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:void 0,host:void 0,path:void 0,port:void 0};if(!Fo.includes(a.protocolVersion))throw new RangeError(`Unsupported protocol version: ${a.protocolVersion} (supported versions: ${Fo.join(", ")})`);let l;if(t instanceof Io)l=t,o._url=t.href;else{try{l=new Io(t)}catch{throw new SyntaxError(`Invalid URL: ${t}`)}o._url=t}let f=l.protocol==="wss:",m=l.protocol==="ws+unix:",c;if(l.protocol!=="ws:"&&!f&&!m?c=`The URL's protocol must be one of "ws:", "wss:", or "ws+unix:"`:m&&!l.pathname?c="The URL's pathname is empty":l.hash&&(c="The URL contains a fragment identifier"),c){let T=new SyntaxError(c);if(o._redirects===0)throw T;No(o,T);return}let h=f?443:80,b=Ff(16).toString("base64"),g=f?Df.get:If.get,w=new Set,S;if(a.createConnection=f?Kf:Jf,a.defaultPort=a.defaultPort||h,a.port=l.port||h,a.host=l.hostname.startsWith("[")?l.hostname.slice(1,-1):l.hostname,a.headers={"Sec-WebSocket-Version":a.protocolVersion,"Sec-WebSocket-Key":b,Connection:"Upgrade",Upgrade:"websocket",...a.headers},a.path=l.pathname+l.search,a.timeout=a.handshakeTimeout,a.perMessageDeflate&&(S=new Ke(a.perMessageDeflate!==!0?a.perMessageDeflate:{},!1,a.maxPayload),a.headers["Sec-WebSocket-Extensions"]=Gf({[Ke.extensionName]:S.offer()})),n.length){for(let T of n){if(typeof T!="string"||!Qf.test(T)||w.has(T))throw new SyntaxError("An invalid or duplicated subprotocol was specified");w.add(T)}a.headers["Sec-WebSocket-Protocol"]=n.join(",")}if(a.origin&&(a.protocolVersion<13?a.headers["Sec-WebSocket-Origin"]=a.origin:a.headers.Origin=a.origin),(l.username||l.password)&&(a.auth=`${l.username}:${l.password}`),m){let T=a.path.split(":");a.socketPath=T[0],a.path=T[1]}let y=o._req=g(a);a.timeout&&y.on("timeout",()=>{le(o,y,"Opening handshake has timed out")}),y.on("error",T=>{y===null||y.aborted||(y=o._req=null,No(o,T))}),y.on("response",T=>{let P=T.headers.location,A=T.statusCode;if(P&&a.followRedirects&&A>=300&&A<400){if(++o._redirects>a.maxRedirects){le(o,y,"Maximum redirects exceeded");return}y.abort();let D;try{D=new Io(P,t)}catch{let I=new SyntaxError(`Invalid URL: ${P}`);No(o,I);return}Da(o,D,n,s)}else o.emit("unexpected-response",y,T)||le(o,y,`Unexpected server response: ${T.statusCode}`)}),y.on("upgrade",(T,P,A)=>{if(o.emit("upgrade",T),o.readyState!==v.CONNECTING)return;y=o._req=null;let D=Nf("sha1").update(b+Uf).digest("base64");if(T.headers["sec-websocket-accept"]!==D){le(o,P,"Invalid Sec-WebSocket-Accept header");return}let q=T.headers["sec-websocket-protocol"],I;if(q!==void 0?w.size?w.has(q)||(I="Server sent an invalid subprotocol"):I="Server sent a subprotocol but none was requested":w.size&&(I="Server sent no subprotocol"),I){le(o,P,I);return}q&&(o._protocol=q);let M=T.headers["sec-websocket-extensions"];if(M!==void 0){if(!S){le(o,P,"Server sent a Sec-WebSocket-Extensions header but no extension was requested");return}let W;try{W=Vf(M)}catch{le(o,P,"Invalid Sec-WebSocket-Extensions header");return}let ce=Object.keys(W);if(ce.length!==1||ce[0]!==Ke.extensionName){le(o,P,"Server indicated an extension that was not requested");return}try{S.accept(W[Ke.extensionName])}catch{le(o,P,"Invalid Sec-WebSocket-Extensions header");return}o._extensions[Ke.extensionName]=S}o.setSocket(P,A,{generateMask:a.generateMask,maxPayload:a.maxPayload,skipUTF8Validation:a.skipUTF8Validation})})}function No(o,t){o._readyState=v.CLOSING,o.emit("error",t),o.emitClose()}function Jf(o){return o.path=o.socketPath,Oa.connect(o)}function Kf(o){return o.path=void 0,!o.servername&&o.servername!==""&&(o.servername=Oa.isIP(o.host)?"":o.host),Wf.connect(o)}function le(o,t,n){o._readyState=v.CLOSING;let s=new Error(n);Error.captureStackTrace(s,le),t.setHeader?(t.abort(),t.socket&&!t.socket.destroyed&&t.socket.destroy(),t.once("abort",o.emitClose.bind(o)),o.emit("error",s)):(t.destroy(s),t.once("error",o.emit.bind(o,"error")),t.once("close",o.emitClose.bind(o)))}function qo(o,t,n){if(t){let s=Yf(t).length;o._socket?o._sender._bufferedBytes+=s:o._bufferedAmount+=s}if(n){let s=new Error(`WebSocket is not open: readyState ${o.readyState} (${Fe[o.readyState]})`);n(s)}}function Zf(o,t){let n=this[V];n._closeFrameReceived=!0,n._closeMessage=t,n._closeCode=o,n._socket[V]!==void 0&&(n._socket.removeListener("data",Tn),process.nextTick(Ia,n._socket),o===1005?n.close():n.close(o,t))}function ec(){let o=this[V];o.isPaused||o._socket.resume()}function tc(o){let t=this[V];t._socket[V]!==void 0&&(t._socket.removeListener("data",Tn),process.nextTick(Ia,t._socket),t.close(o[zf])),t.emit("error",o)}function Ba(){this[V].emitClose()}function rc(o,t){this[V].emit("message",o,t)}function nc(o){let t=this[V];t.pong(o,!t._isServer,La),t.emit("ping",o)}function oc(o){this[V].emit("pong",o)}function Ia(o){o.resume()}function Wa(){let o=this[V];this.removeListener("close",Wa),this.removeListener("data",Tn),this.removeListener("end",Fa),o._readyState=v.CLOSING;let t;!this._readableState.endEmitted&&!o._closeFrameReceived&&!o._receiver._writableState.errorEmitted&&(t=o._socket.read())!==null&&o._receiver.write(t),o._receiver.end(),this[V]=void 0,clearTimeout(o._closeTimer),o._receiver._writableState.finished||o._receiver._writableState.errorEmitted?o.emitClose():(o._receiver.on("error",Ba),o._receiver.on("finish",Ba))}function Tn(o){this[V]._receiver.write(o)||this.pause()}function Fa(){let o=this[V];o._readyState=v.CLOSING,o._receiver.end(),this.end()}function Na(){let o=this[V];this.removeListener("error",Na),this.on("error",La),o&&(o._readyState=v.CLOSING,this.destroy())}});var za=G((Jd,$a)=>{"use strict";var{Duplex:sc}=require("stream");function Ma(o){o.emit("close")}function ic(){!this.destroyed&&this._writableState.finished&&this.destroy()}function Ua(o){this.removeListener("error",Ua),this.destroy(),this.listenerCount("error")===0&&this.emit("error",o)}function ac(o,t){let n=!0,s=new sc({...t,autoDestroy:!1,emitClose:!1,objectMode:!1,writableObjectMode:!1});return o.on("message",function(l,f){let m=!f&&s._readableState.objectMode?l.toString():l;s.push(m)||o.pause()}),o.once("error",function(l){s.destroyed||(n=!1,s.destroy(l))}),o.once("close",function(){s.destroyed||s.push(null)}),s._destroy=function(a,l){if(o.readyState===o.CLOSED){l(a),process.nextTick(Ma,s);return}let f=!1;o.once("error",function(c){f=!0,l(c)}),o.once("close",function(){f||l(a),process.nextTick(Ma,s)}),n&&o.terminate()},s._final=function(a){if(o.readyState===o.CONNECTING){o.once("open",function(){s._final(a)});return}o._socket!==null&&(o._socket._writableState.finished?(a(),s._readableState.endEmitted&&s.destroy()):(o._socket.once("finish",function(){a()}),o.close()))},s._read=function(){o.isPaused&&o.resume()},s._write=function(a,l,f){if(o.readyState===o.CONNECTING){o.once("open",function(){s._write(a,l,f)});return}o.send(a,f)},s.on("end",ic),s.on("error",Ua),s}$a.exports=ac});var Ha=G((Kd,ja)=>{"use strict";var{tokenChars:lc}=yr();function uc(o){let t=new Set,n=-1,s=-1,a=0;for(a;a<o.length;a++){let f=o.charCodeAt(a);if(s===-1&&lc[f]===1)n===-1&&(n=a);else if(a!==0&&(f===32||f===9))s===-1&&n!==-1&&(s=a);else if(f===44){if(n===-1)throw new SyntaxError(`Unexpected character at index ${a}`);s===-1&&(s=a);let m=o.slice(n,s);if(t.has(m))throw new SyntaxError(`The "${m}" subprotocol is duplicated`);t.add(m),n=s=-1}else throw new SyntaxError(`Unexpected character at index ${a}`)}if(n===-1||s!==-1)throw new SyntaxError("Unexpected end of input");let l=o.slice(n,a);if(t.has(l))throw new SyntaxError(`The "${l}" subprotocol is duplicated`);return t.add(l),t}ja.exports={parse:uc}});var Ja=G((rh,Xa)=>{"use strict";var fc=require("events"),En=require("http"),Zd=require("https"),eh=require("net"),th=require("tls"),{createHash:cc}=require("crypto"),Ga=Do(),ht=br(),dc=Ha(),hc=Mo(),{GUID:mc,kWebSocket:pc}=Xe(),_c=/^[+/0-9A-Za-z]{22}==$/,Va=0,Ya=1,Qa=2,Uo=class extends fc{constructor(t,n){if(super(),t={maxPayload:100*1024*1024,skipUTF8Validation:!1,perMessageDeflate:!1,handleProtocols:null,clientTracking:!0,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null,...t},t.port==null&&!t.server&&!t.noServer||t.port!=null&&(t.server||t.noServer)||t.server&&t.noServer)throw new TypeError('One and only one of the "port", "server", or "noServer" options must be specified');if(t.port!=null?(this._server=En.createServer((s,a)=>{let l=En.STATUS_CODES[426];a.writeHead(426,{"Content-Length":l.length,"Content-Type":"text/plain"}),a.end(l)}),this._server.listen(t.port,t.host,t.backlog,n)):t.server&&(this._server=t.server),this._server){let s=this.emit.bind(this,"connection");this._removeListeners=bc(this._server,{listening:this.emit.bind(this,"listening"),error:this.emit.bind(this,"error"),upgrade:(a,l,f)=>{this.handleUpgrade(a,l,f,s)}})}t.perMessageDeflate===!0&&(t.perMessageDeflate={}),t.clientTracking&&(this.clients=new Set,this._shouldEmitClose=!1),this.options=t,this._state=Va}address(){if(this.options.noServer)throw new Error('The server is operating in "noServer" mode');return this._server?this._server.address():null}close(t){if(this._state===Qa){t&&this.once("close",()=>{t(new Error("The server is not running"))}),process.nextTick(Rr,this);return}if(t&&this.once("close",t),this._state!==Ya)if(this._state=Ya,this.options.noServer||this.options.server)this._server&&(this._removeListeners(),this._removeListeners=this._server=null),this.clients?this.clients.size?this._shouldEmitClose=!0:process.nextTick(Rr,this):process.nextTick(Rr,this);else{let n=this._server;this._removeListeners(),this._removeListeners=this._server=null,n.close(()=>{Rr(this)})}}shouldHandle(t){if(this.options.path){let n=t.url.indexOf("?");if((n!==-1?t.url.slice(0,n):t.url)!==this.options.path)return!1}return!0}handleUpgrade(t,n,s,a){n.on("error",$o);let l=t.headers["sec-websocket-key"]!==void 0?t.headers["sec-websocket-key"]:!1,f=+t.headers["sec-websocket-version"];if(t.method!=="GET"||t.headers.upgrade.toLowerCase()!=="websocket"||!l||!_c.test(l)||f!==8&&f!==13||!this.shouldHandle(t))return Ft(n,400);let m=t.headers["sec-websocket-protocol"],c=new Set;if(m!==void 0)try{c=dc.parse(m)}catch{return Ft(n,400)}let h=t.headers["sec-websocket-extensions"],b={};if(this.options.perMessageDeflate&&h!==void 0){let g=new ht(this.options.perMessageDeflate,!0,this.options.maxPayload);try{let w=Ga.parse(h);w[ht.extensionName]&&(g.accept(w[ht.extensionName]),b[ht.extensionName]=g)}catch{return Ft(n,400)}}if(this.options.verifyClient){let g={origin:t.headers[`${f===8?"sec-websocket-origin":"origin"}`],secure:!!(t.socket.authorized||t.socket.encrypted),req:t};if(this.options.verifyClient.length===2){this.options.verifyClient(g,(w,S,y,T)=>{if(!w)return Ft(n,S||401,y,T);this.completeUpgrade(b,l,c,t,n,s,a)});return}if(!this.options.verifyClient(g))return Ft(n,401)}this.completeUpgrade(b,l,c,t,n,s,a)}completeUpgrade(t,n,s,a,l,f,m){if(!l.readable||!l.writable)return l.destroy();if(l[pc])throw new Error("server.handleUpgrade() was called more than once with the same socket, possibly due to a misconfiguration");if(this._state>Va)return Ft(l,503);let c=cc("sha1").update(n+mc).digest("base64"),h=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade",`Sec-WebSocket-Accept: ${c}`],b=new hc(null);if(s.size){let g=this.options.handleProtocols?this.options.handleProtocols(s,a):s.values().next().value;g&&(h.push(`Sec-WebSocket-Protocol: ${g}`),b._protocol=g)}if(t[ht.extensionName]){let g=t[ht.extensionName].params,w=Ga.format({[ht.extensionName]:[g]});h.push(`Sec-WebSocket-Extensions: ${w}`),b._extensions=t}this.emit("headers",h,a),l.write(h.concat(`\r
`).join(`\r
`)),l.removeListener("error",$o),b.setSocket(l,f,{maxPayload:this.options.maxPayload,skipUTF8Validation:this.options.skipUTF8Validation}),this.clients&&(this.clients.add(b),b.on("close",()=>{this.clients.delete(b),this._shouldEmitClose&&!this.clients.size&&process.nextTick(Rr,this)})),m(b,a)}};Xa.exports=Uo;function bc(o,t){for(let n of Object.keys(t))o.on(n,t[n]);return function(){for(let s of Object.keys(t))o.removeListener(s,t[s])}}function Rr(o){o._state=Qa,o.emit("close")}function $o(){this.destroy()}function Ft(o,t,n,s){o.writable&&(n=n||En.STATUS_CODES[t],s={Connection:"close","Content-Type":"text/html","Content-Length":Buffer.byteLength(n),...s},o.write(`HTTP/1.1 ${t} ${En.STATUS_CODES[t]}\r
`+Object.keys(s).map(a=>`${a}: ${s[a]}`).join(`\r
`)+`\r
\r
`+n)),o.removeListener("error",$o),o.destroy()}});var Za=G((nh,Ka)=>{"use strict";var Ne=Mo();Ne.createWebSocketStream=za();Ne.Server=Ja();Ne.Receiver=Bo();Ne.Sender=Oo();Ne.WebSocket=Ne;Ne.WebSocketServer=Ne.Server;Ka.exports=Ne});var Ac={};fi(Ac,{default:()=>ll});module.exports=qu(Ac);var pt=require("@raycast/api");var C=require("@raycast/api"),Dt=require("react");var Ye=require("@raycast/api");var Mi=at(require("node:http"),1),Ui=at(require("node:https"),1),ct=at(require("node:zlib"),1),ne=at(require("node:stream"),1);function Mu(o){if(!/^data:/i.test(o))throw new TypeError('`uri` does not appear to be a Data URI (must begin with "data:")');o=o.replace(/\r?\n/g,"");let t=o.indexOf(",");if(t===-1||t<=4)throw new TypeError("malformed data: URI");let n=o.substring(5,t).split(";"),s="",a=!1,l=n[0]||"text/plain",f=l;for(let b=1;b<n.length;b++)n[b]==="base64"?a=!0:(f+=`;${n[b]}`,n[b].indexOf("charset=")===0&&(s=n[b].substring(8)));!n[0]&&!s.length&&(f+=";charset=US-ASCII",s="US-ASCII");let m=a?"base64":"ascii",c=unescape(o.substring(t+1)),h=Buffer.from(c,m);return h.type=l,h.typeFull=f,h.charset=s,h}var di=Mu;var _e=at(require("node:stream"),1),kt=require("node:util");or();ho();var Oe=class extends Error{constructor(t,n){super(t),Error.captureStackTrace(this,this.constructor),this.type=n}get name(){return this.constructor.name}get[Symbol.toStringTag](){return this.constructor.name}};var re=class extends Oe{constructor(t,n,s){super(t,n),s&&(this.code=this.errno=s.code,this.erroredSysCall=s.syscall)}};var sn=Symbol.toStringTag,mo=o=>typeof o=="object"&&typeof o.append=="function"&&typeof o.delete=="function"&&typeof o.get=="function"&&typeof o.getAll=="function"&&typeof o.has=="function"&&typeof o.set=="function"&&typeof o.sort=="function"&&o[sn]==="URLSearchParams",ar=o=>o&&typeof o=="object"&&typeof o.arrayBuffer=="function"&&typeof o.type=="string"&&typeof o.stream=="function"&&typeof o.constructor=="function"&&/^(Blob|File)$/.test(o[sn]),wi=o=>typeof o=="object"&&(o[sn]==="AbortSignal"||o[sn]==="EventTarget");var K=Symbol("Body internals"),we=class{constructor(t,{size:n=0}={}){let s=null;t===null?t=null:mo(t)?t=Buffer.from(t.toString()):ar(t)||Buffer.isBuffer(t)||(kt.types.isAnyArrayBuffer(t)?t=Buffer.from(t):ArrayBuffer.isView(t)?t=Buffer.from(t.buffer,t.byteOffset,t.byteLength):t instanceof _e.default||(t instanceof At?(t=Si(t),s=t.type.split("=")[1]):t=Buffer.from(String(t))));let a=t;Buffer.isBuffer(t)?a=_e.default.Readable.from(t):ar(t)&&(a=_e.default.Readable.from(t.stream())),this[K]={body:t,stream:a,boundary:s,disturbed:!1,error:null},this.size=n,t instanceof _e.default&&t.on("error",l=>{let f=l instanceof Oe?l:new re(`Invalid response body while trying to fetch ${this.url}: ${l.message}`,"system",l);this[K].error=f})}get body(){return this[K].stream}get bodyUsed(){return this[K].disturbed}async arrayBuffer(){let{buffer:t,byteOffset:n,byteLength:s}=await fn(this);return t.slice(n,n+s)}async formData(){let t=this.headers.get("content-type");if(t.startsWith("application/x-www-form-urlencoded")){let s=new At,a=new URLSearchParams(await this.text());for(let[l,f]of a)s.append(l,f);return s}let{toFormData:n}=await Promise.resolve().then(()=>(Pi(),Ci));return n(this.body,t)}async blob(){let t=this.headers&&this.headers.get("content-type")||this[K].body&&this[K].body.type||"",n=await this.buffer();return new lt([n],{type:t})}async json(){let t=await fn(this);return JSON.parse(t.toString())}async text(){return(await fn(this)).toString()}buffer(){return fn(this)}};we.prototype.buffer=(0,kt.deprecate)(we.prototype.buffer,"Please use 'response.arrayBuffer()' instead of 'response.buffer()'","node-fetch#buffer");Object.defineProperties(we.prototype,{body:{enumerable:!0},bodyUsed:{enumerable:!0},arrayBuffer:{enumerable:!0},blob:{enumerable:!0},json:{enumerable:!0},text:{enumerable:!0}});async function fn(o){if(o[K].disturbed)throw new TypeError(`body used already for: ${o.url}`);if(o[K].disturbed=!0,o[K].error)throw o[K].error;let{body:t}=o;if(t===null||!(t instanceof _e.default))return Buffer.alloc(0);let n=[],s=0;try{for await(let a of t){if(o.size>0&&s+a.length>o.size){let l=new re(`content size at ${o.url} over limit: ${o.size}`,"max-size");throw t.destroy(l),l}s+=a.length,n.push(a)}}catch(a){throw a instanceof Oe?a:new re(`Invalid response body while trying to fetch ${o.url}: ${a.message}`,"system",a)}if(t.readableEnded===!0||t._readableState.ended===!0)try{return n.every(a=>typeof a=="string")?Buffer.from(n.join("")):Buffer.concat(n,s)}catch(a){throw new re(`Could not create Buffer from response body for ${o.url}: ${a.message}`,"system",a)}else throw new re(`Premature close of server response while trying to fetch ${o.url}`)}var xt=(o,t)=>{let n,s,{body:a}=o[K];if(o.bodyUsed)throw new Error("cannot clone body after it is used");return a instanceof _e.default&&typeof a.getBoundary!="function"&&(n=new _e.PassThrough({highWaterMark:t}),s=new _e.PassThrough({highWaterMark:t}),a.pipe(n),a.pipe(s),o[K].stream=n,a=s),a},rf=(0,kt.deprecate)(o=>o.getBoundary(),"form-data doesn't follow the spec and requires special treatment. Use alternative package","https://github.com/node-fetch/node-fetch/issues/1167"),cn=(o,t)=>o===null?null:typeof o=="string"?"text/plain;charset=UTF-8":mo(o)?"application/x-www-form-urlencoded;charset=UTF-8":ar(o)?o.type||null:Buffer.isBuffer(o)||kt.types.isAnyArrayBuffer(o)||ArrayBuffer.isView(o)?null:o instanceof At?`multipart/form-data; boundary=${t[K].boundary}`:o&&typeof o.getBoundary=="function"?`multipart/form-data;boundary=${rf(o)}`:o instanceof _e.default?null:"text/plain;charset=UTF-8",vi=o=>{let{body:t}=o[K];return t===null?0:ar(t)?t.size:Buffer.isBuffer(t)?t.length:t&&typeof t.getLengthSync=="function"&&t.hasKnownLength&&t.hasKnownLength()?t.getLengthSync():null},Ai=(o,{body:t})=>{t===null?o.end():t.pipe(o)};var _o=require("node:util"),fr=at(require("node:http"),1),dn=typeof fr.default.validateHeaderName=="function"?fr.default.validateHeaderName:o=>{if(!/^[\^`\-\w!#$%&'*+.|~]+$/.test(o)){let t=new TypeError(`Header name must be a valid HTTP token [${o}]`);throw Object.defineProperty(t,"code",{value:"ERR_INVALID_HTTP_TOKEN"}),t}},bo=typeof fr.default.validateHeaderValue=="function"?fr.default.validateHeaderValue:(o,t)=>{if(/[^\t\u0020-\u007E\u0080-\u00FF]/.test(t)){let n=new TypeError(`Invalid character in header content ["${o}"]`);throw Object.defineProperty(n,"code",{value:"ERR_INVALID_CHAR"}),n}},Z=class extends URLSearchParams{constructor(t){let n=[];if(t instanceof Z){let s=t.raw();for(let[a,l]of Object.entries(s))n.push(...l.map(f=>[a,f]))}else if(t!=null)if(typeof t=="object"&&!_o.types.isBoxedPrimitive(t)){let s=t[Symbol.iterator];if(s==null)n.push(...Object.entries(t));else{if(typeof s!="function")throw new TypeError("Header pairs must be iterable");n=[...t].map(a=>{if(typeof a!="object"||_o.types.isBoxedPrimitive(a))throw new TypeError("Each header pair must be an iterable object");return[...a]}).map(a=>{if(a.length!==2)throw new TypeError("Each header pair must be a name/value tuple");return[...a]})}}else throw new TypeError("Failed to construct 'Headers': The provided value is not of type '(sequence<sequence<ByteString>> or record<ByteString, ByteString>)");return n=n.length>0?n.map(([s,a])=>(dn(s),bo(s,String(a)),[String(s).toLowerCase(),String(a)])):void 0,super(n),new Proxy(this,{get(s,a,l){switch(a){case"append":case"set":return(f,m)=>(dn(f),bo(f,String(m)),URLSearchParams.prototype[a].call(s,String(f).toLowerCase(),String(m)));case"delete":case"has":case"getAll":return f=>(dn(f),URLSearchParams.prototype[a].call(s,String(f).toLowerCase()));case"keys":return()=>(s.sort(),new Set(URLSearchParams.prototype.keys.call(s)).keys());default:return Reflect.get(s,a,l)}}})}get[Symbol.toStringTag](){return this.constructor.name}toString(){return Object.prototype.toString.call(this)}get(t){let n=this.getAll(t);if(n.length===0)return null;let s=n.join(", ");return/^content-encoding$/i.test(t)&&(s=s.toLowerCase()),s}forEach(t,n=void 0){for(let s of this.keys())Reflect.apply(t,n,[this.get(s),s,this])}*values(){for(let t of this.keys())yield this.get(t)}*entries(){for(let t of this.keys())yield[t,this.get(t)]}[Symbol.iterator](){return this.entries()}raw(){return[...this.keys()].reduce((t,n)=>(t[n]=this.getAll(n),t),{})}[Symbol.for("nodejs.util.inspect.custom")](){return[...this.keys()].reduce((t,n)=>{let s=this.getAll(n);return n==="host"?t[n]=s[0]:t[n]=s.length>1?s:s[0],t},{})}};Object.defineProperties(Z.prototype,["get","entries","forEach","values"].reduce((o,t)=>(o[t]={enumerable:!0},o),{}));function ki(o=[]){return new Z(o.reduce((t,n,s,a)=>(s%2===0&&t.push(a.slice(s,s+2)),t),[]).filter(([t,n])=>{try{return dn(t),bo(t,String(n)),!0}catch{return!1}}))}var nf=new Set([301,302,303,307,308]),hn=o=>nf.has(o);var be=Symbol("Response internals"),X=class extends we{constructor(t=null,n={}){super(t,n);let s=n.status!=null?n.status:200,a=new Z(n.headers);if(t!==null&&!a.has("Content-Type")){let l=cn(t,this);l&&a.append("Content-Type",l)}this[be]={type:"default",url:n.url,status:s,statusText:n.statusText||"",headers:a,counter:n.counter,highWaterMark:n.highWaterMark}}get type(){return this[be].type}get url(){return this[be].url||""}get status(){return this[be].status}get ok(){return this[be].status>=200&&this[be].status<300}get redirected(){return this[be].counter>0}get statusText(){return this[be].statusText}get headers(){return this[be].headers}get highWaterMark(){return this[be].highWaterMark}clone(){return new X(xt(this,this.highWaterMark),{type:this.type,url:this.url,status:this.status,statusText:this.statusText,headers:this.headers,ok:this.ok,redirected:this.redirected,size:this.size,highWaterMark:this.highWaterMark})}static redirect(t,n=302){if(!hn(n))throw new RangeError('Failed to execute "redirect" on "response": Invalid status code');return new X(null,{headers:{location:new URL(t).toString()},status:n})}static error(){let t=new X(null,{status:0,statusText:""});return t[be].type="error",t}get[Symbol.toStringTag](){return"Response"}};Object.defineProperties(X.prototype,{type:{enumerable:!0},url:{enumerable:!0},status:{enumerable:!0},ok:{enumerable:!0},redirected:{enumerable:!0},statusText:{enumerable:!0},headers:{enumerable:!0},clone:{enumerable:!0}});var Ni=require("node:url");var xi=o=>{if(o.search)return o.search;let t=o.href.length-1,n=o.hash||(o.href[t]==="#"?"#":"");return o.href[t-n.length]==="?"?"?":""};var Oi=require("net");function Bi(o,t=!1){return o==null||(o=new URL(o),/^(about|blob|data):$/.test(o.protocol))?"no-referrer":(o.username="",o.password="",o.hash="",t&&(o.pathname="",o.search=""),o)}var Li=new Set(["","no-referrer","no-referrer-when-downgrade","same-origin","origin","strict-origin","origin-when-cross-origin","strict-origin-when-cross-origin","unsafe-url"]),Di="strict-origin-when-cross-origin";function Ii(o){if(!Li.has(o))throw new TypeError(`Invalid referrerPolicy: ${o}`);return o}function of(o){if(/^(http|ws)s:$/.test(o.protocol))return!0;let t=o.host.replace(/(^\[)|(]$)/g,""),n=(0,Oi.isIP)(t);return n===4&&/^127\./.test(t)||n===6&&/^(((0+:){7})|(::(0+:){0,6}))0*1$/.test(t)?!0:/^(.+\.)*localhost$/.test(o.host)?!1:o.protocol==="file:"}function Bt(o){return/^about:(blank|srcdoc)$/.test(o)||o.protocol==="data:"||/^(blob|filesystem):$/.test(o.protocol)?!0:of(o)}function Wi(o,{referrerURLCallback:t,referrerOriginCallback:n}={}){if(o.referrer==="no-referrer"||o.referrerPolicy==="")return null;let s=o.referrerPolicy;if(o.referrer==="about:client")return"no-referrer";let a=o.referrer,l=Bi(a),f=Bi(a,!0);l.toString().length>4096&&(l=f),t&&(l=t(l)),n&&(f=n(f));let m=new URL(o.url);switch(s){case"no-referrer":return"no-referrer";case"origin":return f;case"unsafe-url":return l;case"strict-origin":return Bt(l)&&!Bt(m)?"no-referrer":f.toString();case"strict-origin-when-cross-origin":return l.origin===m.origin?l:Bt(l)&&!Bt(m)?"no-referrer":f;case"same-origin":return l.origin===m.origin?l:"no-referrer";case"origin-when-cross-origin":return l.origin===m.origin?l:f;case"no-referrer-when-downgrade":return Bt(l)&&!Bt(m)?"no-referrer":l;default:throw new TypeError(`Invalid referrerPolicy: ${s}`)}}function Fi(o){let t=(o.get("referrer-policy")||"").split(/[,\s]+/),n="";for(let s of t)s&&Li.has(s)&&(n=s);return n}var j=Symbol("Request internals"),mn=o=>typeof o=="object"&&typeof o[j]=="object",Le=class extends we{constructor(t,n={}){let s;if(mn(t)?s=new URL(t.url):(s=new URL(t),t={}),s.username!==""||s.password!=="")throw new TypeError(`${s} is an url with embedded credentails.`);let a=n.method||t.method||"GET";if(a=a.toUpperCase(),(n.body!=null||mn(t))&&t.body!==null&&(a==="GET"||a==="HEAD"))throw new TypeError("Request with GET/HEAD method cannot have body");let l=n.body?n.body:mn(t)&&t.body!==null?xt(t):null;super(l,{size:n.size||t.size||0});let f=new Z(n.headers||t.headers||{});if(l!==null&&!f.has("Content-Type")){let h=cn(l,this);h&&f.set("Content-Type",h)}let m=mn(t)?t.signal:null;if("signal"in n&&(m=n.signal),m!=null&&!wi(m))throw new TypeError("Expected signal to be an instanceof AbortSignal or EventTarget");let c=n.referrer==null?t.referrer:n.referrer;if(c==="")c="no-referrer";else if(c){let h=new URL(c);c=/^about:(\/\/)?client$/.test(h)?"client":h}else c=void 0;this[j]={method:a,redirect:n.redirect||t.redirect||"follow",headers:f,parsedURL:s,signal:m,referrer:c},this.follow=n.follow===void 0?t.follow===void 0?20:t.follow:n.follow,this.compress=n.compress===void 0?t.compress===void 0?!0:t.compress:n.compress,this.counter=n.counter||t.counter||0,this.agent=n.agent||t.agent,this.highWaterMark=n.highWaterMark||t.highWaterMark||16384,this.insecureHTTPParser=n.insecureHTTPParser||t.insecureHTTPParser||!1,this.referrerPolicy=n.referrerPolicy||t.referrerPolicy||""}get method(){return this[j].method}get url(){return(0,Ni.format)(this[j].parsedURL)}get headers(){return this[j].headers}get redirect(){return this[j].redirect}get signal(){return this[j].signal}get referrer(){if(this[j].referrer==="no-referrer")return"";if(this[j].referrer==="client")return"about:client";if(this[j].referrer)return this[j].referrer.toString()}get referrerPolicy(){return this[j].referrerPolicy}set referrerPolicy(t){this[j].referrerPolicy=Ii(t)}clone(){return new Le(this)}get[Symbol.toStringTag](){return"Request"}};Object.defineProperties(Le.prototype,{method:{enumerable:!0},url:{enumerable:!0},headers:{enumerable:!0},redirect:{enumerable:!0},clone:{enumerable:!0},signal:{enumerable:!0},referrer:{enumerable:!0},referrerPolicy:{enumerable:!0}});var qi=o=>{let{parsedURL:t}=o[j],n=new Z(o[j].headers);n.has("Accept")||n.set("Accept","*/*");let s=null;if(o.body===null&&/^(post|put)$/i.test(o.method)&&(s="0"),o.body!==null){let m=vi(o);typeof m=="number"&&!Number.isNaN(m)&&(s=String(m))}s&&n.set("Content-Length",s),o.referrerPolicy===""&&(o.referrerPolicy=Di),o.referrer&&o.referrer!=="no-referrer"?o[j].referrer=Wi(o):o[j].referrer="no-referrer",o[j].referrer instanceof URL&&n.set("Referer",o.referrer),n.has("User-Agent")||n.set("User-Agent","node-fetch"),o.compress&&!n.has("Accept-Encoding")&&n.set("Accept-Encoding","gzip,deflate,br");let{agent:a}=o;typeof a=="function"&&(a=a(t)),!n.has("Connection")&&!a&&n.set("Connection","close");let l=xi(t),f={path:t.pathname+l,method:o.method,headers:n[Symbol.for("nodejs.util.inspect.custom")](),insecureHTTPParser:o.insecureHTTPParser,agent:a};return{parsedURL:t,options:f}};var pn=class extends Oe{constructor(t,n="aborted"){super(t,n)}};var sf=new Set(["data:","http:","https:"]);async function _n(o,t){return new Promise((n,s)=>{let a=new Le(o,t),{parsedURL:l,options:f}=qi(a);if(!sf.has(l.protocol))throw new TypeError(`node-fetch cannot load ${o}. URL scheme "${l.protocol.replace(/:$/,"")}" is not supported.`);if(l.protocol==="data:"){let y=di(a.url),T=new X(y,{headers:{"Content-Type":y.typeFull}});n(T);return}let m=(l.protocol==="https:"?Ui.default:Mi.default).request,{signal:c}=a,h=null,b=()=>{let y=new pn("The operation was aborted.");s(y),a.body&&a.body instanceof ne.default.Readable&&a.body.destroy(y),!(!h||!h.body)&&h.body.emit("error",y)};if(c&&c.aborted){b();return}let g=()=>{b(),S()},w=m(l,f);c&&c.addEventListener("abort",g);let S=()=>{w.abort(),c&&c.removeEventListener("abort",g)};w.on("error",y=>{s(new re(`request to ${a.url} failed, reason: ${y.message}`,"system",y)),S()}),af(w,y=>{h.body.destroy(y)}),process.version<"v14"&&w.on("socket",y=>{let T;y.prependListener("end",()=>{T=y._eventsCount}),y.prependListener("close",P=>{if(h&&T<y._eventsCount&&!P){let A=new Error("Premature close");A.code="ERR_STREAM_PREMATURE_CLOSE",h.body.emit("error",A)}})}),w.on("response",y=>{w.setTimeout(0);let T=ki(y.rawHeaders);if(hn(y.statusCode)){let I=T.get("Location"),M=I===null?null:new URL(I,a.url);switch(a.redirect){case"error":s(new re(`uri requested responds with a redirect, redirect mode is set to error: ${a.url}`,"no-redirect")),S();return;case"manual":M!==null&&T.set("Location",M);break;case"follow":{if(M===null)break;if(a.counter>=a.follow){s(new re(`maximum redirect reached at: ${a.url}`,"max-redirect")),S();return}let W={headers:new Z(a.headers),follow:a.follow,counter:a.counter+1,agent:a.agent,compress:a.compress,method:a.method,body:xt(a),signal:a.signal,size:a.size,referrer:a.referrer,referrerPolicy:a.referrerPolicy};if(y.statusCode!==303&&a.body&&t.body instanceof ne.default.Readable){s(new re("Cannot follow redirect with body being a readable stream","unsupported-redirect")),S();return}(y.statusCode===303||(y.statusCode===301||y.statusCode===302)&&a.method==="POST")&&(W.method="GET",W.body=void 0,W.headers.delete("content-length"));let ce=Fi(T);ce&&(W.referrerPolicy=ce),n(_n(new Le(M,W))),S();return}default:return s(new TypeError(`Redirect option '${a.redirect}' is not a valid value of RequestRedirect`))}}c&&y.once("end",()=>{c.removeEventListener("abort",g)});let P=(0,ne.pipeline)(y,new ne.PassThrough,s);process.version<"v12.10"&&y.on("aborted",g);let A={url:a.url,status:y.statusCode,statusText:y.statusMessage,headers:T,size:a.size,counter:a.counter,highWaterMark:a.highWaterMark},D=T.get("Content-Encoding");if(!a.compress||a.method==="HEAD"||D===null||y.statusCode===204||y.statusCode===304){h=new X(P,A),n(h);return}let q={flush:ct.default.Z_SYNC_FLUSH,finishFlush:ct.default.Z_SYNC_FLUSH};if(D==="gzip"||D==="x-gzip"){P=(0,ne.pipeline)(P,ct.default.createGunzip(q),s),h=new X(P,A),n(h);return}if(D==="deflate"||D==="x-deflate"){(0,ne.pipeline)(y,new ne.PassThrough,s).once("data",M=>{P=(M[0]&15)===8?(0,ne.pipeline)(P,ct.default.createInflate(),s):(0,ne.pipeline)(P,ct.default.createInflateRaw(),s),h=new X(P,A),n(h)});return}if(D==="br"){P=(0,ne.pipeline)(P,ct.default.createBrotliDecompress(),s),h=new X(P,A),n(h);return}h=new X(P,A),n(h)}),Ai(w,a)})}function af(o,t){let n=Buffer.from(`0\r
\r
`),s=!1,a=!1,l;o.on("response",f=>{let{headers:m}=f;s=m["transfer-encoding"]==="chunked"&&!m["content-length"]}),o.on("socket",f=>{let m=()=>{if(s&&!a){let c=new Error("Premature close");c.code="ERR_STREAM_PREMATURE_CLOSE",t(c)}};f.prependListener("close",m),o.on("abort",()=>{f.removeListener("close",m)}),f.on("data",c=>{a=Buffer.compare(c.slice(-5),n)===0,!a&&l&&(a=Buffer.compare(l.slice(-3),n.slice(0,3))===0&&Buffer.compare(c.slice(-2),n.slice(3))===0),l=c})})}var go=require("url");var Ot=require("@raycast/api");var cr=new Error("No avaliable backend"),yo=new Error("Current backend deleted"),ae=function(o){switch(o){case cr:{(0,Ot.showToast)(Ot.Toast.Style.Failure,cr.message,"Configure in 'Backends'");break}case yo:{(0,Ot.showToast)(Ot.Toast.Style.Failure,cr.message,"Configure in 'Backends'");break}default:console.error(o),dr("Request failed",o)}};var $i=["B","KB","MB","GB","TB","PB","EB","ZB","YB"];function Qe(o){if(o<1e3)return o+" B";let t=Math.min(Math.floor(Math.log10(o)/3),$i.length-1);o=Number((o/Math.pow(1e3,t)).toPrecision(3));let n=$i[t];return o+" "+n}async function So(){return await Ye.LocalStorage.getItem("current")}async function lf(o){return await Ye.LocalStorage.getItem(o)}async function bn(){let o=await So();if(o){let t=await lf(o);if(t==null)throw yo;return[o,t]}else throw cr}async function Lt({endpoint:o,method:t="GET",body:n}){let[s,a]=await bn(),l=new go.URL(s),f=`${ji(l.href)}${o}`;return _n(f,{method:t,headers:a?{Authorization:`Bearer ${a}`}:{},body:n?JSON.stringify(n):void 0})}async function zi(o,t={}){let[n,s]=await bn(),a=new go.URL(n);a.protocol==="https:"?a.protocol="wss:":a.protocol="ws:";let l=new URLSearchParams(t);l.set("token",s);let f="?"+l.toString();return`${ji(a.href)}${o}${f}`}function ji(o){return o.replace(/\/$/,"")}async function wo(o){await Ye.LocalStorage.setItem("current",o)}async function dr(o,t){console.error(o,t),await(0,Ye.showToast)(Ye.Toast.Style.Failure,o,t instanceof Error?t.message:t.toString())}function Hi(o){return new Promise(t=>setTimeout(t,o))}function hr(o,t){let n=String(o);for(;n.length<t;)n="0"+n;return n}function uf(o){let t=o.getFullYear()%100,n=hr(o.getMonth()+1,2),s=hr(o.getDate(),2),a=hr(o.getHours(),2),l=hr(o.getMinutes(),2),f=hr(o.getSeconds(),2);return`${t}-${n}-${s} ${a}:${l}:${f}`}function Gi(){return uf(new Date).toString()}function Vi(o){return o.charAt(0).toUpperCase()+o.slice(1)}var H=require("react/jsx-runtime");async function ff(){return await C.LocalStorage.allItems()}async function cf(o,t){await C.LocalStorage.setItem(o,t)}async function df(o){await C.LocalStorage.removeItem(o)}function Ro(){let[o,t]=(0,Dt.useState)(0),{pop:n}=(0,C.useNavigation)(),[s,a]=(0,Dt.useState)({}),[l,f]=(0,Dt.useState)("");(0,Dt.useEffect)(()=>{(async()=>{let h=await So();h&&f(h);let b=await ff();a(b)})()},[o]);let m=Object.entries(s).filter(([c])=>c!="current").sort((c,h)=>c[0].localeCompare(h[0]));return(0,H.jsxs)(C.List,{children:[m.map(([c,h],b)=>(0,H.jsx)(C.List.Item,{title:c,icon:{source:C.Icon.Circle,tintColor:c==l?C.Color.Green:C.Color.PrimaryText},subtitle:h&&h.length!=0?h:"(no secret)",accessoryTitle:c==l?"Current":"",actions:(0,H.jsxs)(C.ActionPanel,{children:[(0,H.jsx)(C.Action,{title:"Use Backend",onAction:async()=>{await wo(c),f(c)}}),(0,H.jsx)(C.Action,{title:"Remove",onAction:async()=>{await(0,C.confirmAlert)({title:"Delete this backend?",primaryAction:{title:"Confirm",onAction:async()=>{await df(c),t(w=>w+1),(0,C.showToast)(C.Toast.Style.Success,"Delete Success",c)}}})}})]})},b)),(0,H.jsx)(C.List.Item,{title:"Add Backend",icon:{source:C.Icon.Plus,tintColor:C.Color.Blue},actions:(0,H.jsx)(C.ActionPanel,{children:(0,H.jsx)(C.Action.Push,{title:"Add Backend",target:(0,H.jsxs)(C.Form,{actions:(0,H.jsx)(C.ActionPanel,{children:(0,H.jsx)(C.Action.SubmitForm,{title:"Submit",onSubmit:async c=>{c.url.startsWith("http://")||c.url.startsWith("https://")?(await cf(c.url,c.secret),await wo(c.url),f(c.url),t(h=>h+1),(0,C.showToast)(C.Toast.Style.Success,"Add Success",c.url),n()):await(0,C.showToast)(C.Toast.Style.Failure,"invalid url")}})}),children:[(0,H.jsx)(C.Form.TextField,{id:"url",title:"url",defaultValue:"http://127.0.0.1:9090"}),(0,H.jsx)(C.Form.TextField,{id:"secret",title:"secret",defaultValue:""})]})})})},m.length),(0,H.jsx)(C.List.Item,{title:"Delete All Data",icon:{source:C.Icon.Trash,tintColor:C.Color.Red},actions:(0,H.jsx)(C.ActionPanel,{children:(0,H.jsx)(C.Action,{title:"Remove",onAction:async()=>{await(0,C.confirmAlert)({title:"Delete All Data?",primaryAction:{title:"Confirm",onAction:async()=>{await C.LocalStorage.clear(),t(h=>h+1),(0,C.showToast)(C.Toast.Style.Success,"Delete Success")}}})}})})},m.length+1)]})}var Ce=require("@raycast/api"),Nt=require("react");var qe=require("react");var Ee=require("react");var yc=Za(),zo=[{key:0,value:"connecting"},{key:1,value:"connection ready"},{key:2,value:"connection is closing"},{key:3,value:"connection closed or error"}],gc=(o,t={})=>{let n=(0,Ee.useRef)(null),s=(0,Ee.useRef)(!0),[a,l]=(0,Ee.useState)(0),[f,m]=(0,Ee.useState)(""),[c,h]=(0,Ee.useState)(""),[b,g]=(0,Ee.useState)({key:0,value:"connecting"}),w=()=>{zi(o,t).then(P=>{s.current&&m(P),n.current=new yc(P),n.current.onopen=A=>s.current&&g(zo[n.current?.readyState??0]),n.current.onclose=A=>{s.current&&g(zo[n.current?.readyState??0])},n.current.onerror=A=>{s.current&&g(zo[n.current?.readyState??0])},n.current.onmessage=A=>{s.current&&h(A.data.toString())}}).catch(ae)},S=()=>{(!n.current||n.current.readyState===3)&&w()},y=()=>{n.current?.close()},T=()=>{s.current&&a<=10&&(console.log(`reconnect after ${a}s(${a}/10)`),dr(`Reconnect after ${a}s(${a}/10)`,""),Hi(a*1e3).then(()=>{console.log("reconnect"),s.current&&l(P=>P+1);try{y(),n.current=null,s.current&&w()}catch(P){dr("Websocket failed",P)}}))};return(0,Ee.useEffect)(()=>(S(),()=>{n.current?.close(),s.current=!1}),[n]),{url:f,wsData:c,readyState:b,closeWebSocket:y,reconnect:T}},Cn=gc;function el(){let[o,t]=(0,qe.useState)({up:0,down:0}),{url:n,wsData:s,readyState:a,reconnect:l}=Cn("/traffic");return(0,qe.useEffect)(()=>{if(a.key===3&&l(),s){let f=JSON.parse(s);t(f)}},[s,a]),[n,o]}function Pn(){let[o,t]=(0,qe.useState)({downloadTotal:0,uploadTotal:0,connections:[]}),{url:n,wsData:s,readyState:a,reconnect:l}=Cn("/connections");return(0,qe.useEffect)(()=>{if(a.key===3&&l(),s){let f=JSON.parse(s);t(f)}},[s,a]),[n,o]}function tl(o){let[t,n]=(0,qe.useState)([]),{url:s,wsData:a,readyState:l,reconnect:f,closeWebSocket:m}=Cn("/logs",{level:o});return(0,qe.useEffect)(()=>{if(l.key===3&&f(),a){let c=JSON.parse(a);n(h=>[{...c,time:Gi()},...h])}},[a,l]),(0,qe.useEffect)(()=>{s&&(m(),f())},[o]),[s,t]}var oe=require("react/jsx-runtime");function Sc(o,t){return`${t.metadata.host?t.metadata.host:t.metadata.destinationIP}:${t.metadata.destinationPort}`}function wc(o,t){return o?`${t.chains.join(" / ")}`:`${t.rule}(${t.rulePayload})`}function Rc(o,t){return o?`${Qe(t.download)} \u2193 ${Qe(t.upload)} \u2191`:`${t.metadata.type}(${t.metadata.network})`}function jo(){let[o,t]=Pn(),[n,s]=(0,Nt.useState)(!0),[a,l]=(0,Nt.useState)(""),[f,m]=(0,Nt.useState)(t.connections);return(0,Nt.useEffect)(()=>{m(o?t.connections.filter(c=>c.metadata.host.includes(a)||c.metadata.destinationIP.includes(a)||c.metadata.destinationPort.includes(a)):[])},[a,t.connections.length]),(0,oe.jsx)(Ce.List,{enableFiltering:!1,onSearchTextChange:l,children:o?(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(Ce.List.Item,{title:"Host",subtitle:n?"Chains":"Rules",accessoryTitle:`${n?"Overview":"Detail"} Mode`,actions:(0,oe.jsx)(Ce.ActionPanel,{children:(0,oe.jsx)(Ce.Action,{title:"Switch Mode",onAction:()=>{s(c=>!c)}})})},-1),f.map((c,h)=>(0,oe.jsx)(Ce.List.Item,{title:Sc(n,c),subtitle:wc(n,c),accessoryTitle:Rc(n,c),actions:(0,oe.jsx)(Ce.ActionPanel,{children:(0,oe.jsx)(Ce.Action,{title:"Switch Mode",onAction:()=>{s(b=>!b)}})})},h))]}):(0,oe.jsx)(oe.Fragment,{})})}var z=require("@raycast/api"),qt=require("react");var ee=require("react/jsx-runtime"),vn=["error","warning","info","debug"],Tc={debug:z.Color.Green,info:z.Color.Blue,warning:z.Color.Yellow,error:z.Color.Red};function Ho(){let[o,t]=(0,qt.useState)("info"),[n,s]=tl(o),[a,l]=(0,qt.useState)(""),[f,m]=(0,qt.useState)(s);return(0,qt.useEffect)(()=>{m(n?s.filter(c=>c.payload.includes(a)):[])},[a,s.length]),(0,ee.jsx)(z.List,{enableFiltering:!1,onSearchTextChange:l,children:n?(0,ee.jsxs)(ee.Fragment,{children:[(0,ee.jsx)(z.List.Item,{title:"Time",subtitle:"Payload",accessoryTitle:`LogLevel(${o})`,actions:(0,ee.jsx)(z.ActionPanel,{children:(0,ee.jsx)(z.Action,{title:"Swith Level",onAction:()=>{t(c=>{let h=vn.indexOf(c);return h>=vn.length-1?vn[0]:vn[h+1]})}})})},-1),f.map((c,h)=>(0,ee.jsx)(z.List.Item,{icon:{source:z.Icon.Circle,tintColor:Tc[c.type]},title:c.time?c.time:"",subtitle:c.payload,accessoryTitle:c.type,actions:(0,ee.jsx)(z.ActionPanel,{children:(0,ee.jsx)(z.Action.Push,{title:"Show Detail",target:(0,ee.jsx)(z.Detail,{markdown:`\`\`\`
${c.payload}
\`\`\``})})})},h))]}):(0,ee.jsx)(ee.Fragment,{})})}var se=require("@raycast/api");var ue=require("react/jsx-runtime");function Go(){let[o,t]=el(),[n,s]=Pn();return(0,ue.jsx)(se.List,{children:o&&n?(0,ue.jsxs)(ue.Fragment,{children:[(0,ue.jsx)(se.List.Item,{icon:se.Icon.ChevronUp,title:"Upload",accessoryTitle:`${Qe(t.up)}/s`},"1"),(0,ue.jsx)(se.List.Item,{icon:se.Icon.ChevronDown,title:"Download",accessoryTitle:`${Qe(t.down)}/s`},"2"),(0,ue.jsx)(se.List.Item,{icon:se.Icon.Upload,title:"Upload Total",accessoryTitle:`${Qe(s.uploadTotal)}`},"3"),(0,ue.jsx)(se.List.Item,{icon:se.Icon.Download,title:"Download Total",accessoryTitle:`${Qe(s.downloadTotal)}`},"4"),(0,ue.jsx)(se.List.Item,{icon:se.Icon.LevelMeter,title:"Active Connections",accessoryTitle:`${s.connections.length}`},"5")]}):(0,ue.jsx)(ue.Fragment,{})})}var fe=require("@raycast/api"),Ze=require("react");async function rl(){return(await(await Lt({endpoint:"/proxies"})).json()).proxies}async function nl(){return(await(await Lt({endpoint:"/rules"})).json()).rules}async function ol(){return await(await Lt({endpoint:"/configs"})).json()}async function sl(o){let t=await Lt({endpoint:"/configs",method:"PATCH",body:o});if(t.status===400)throw new Error("Format error");if(t.status===404)throw new Error("Proxy not found");if(t.status!==204)throw new Error(`Unexpected status code: ${t.status}`)}async function il(o,t){let n=await Lt({endpoint:`/proxies/${o}`,method:"PUT",body:{name:t}});if(n.status===400)throw new Error("Format error");if(n.status===404)throw new Error("Proxy not found");if(n.status!==204)throw new Error(`Unexpected status code: ${n.status}`)}var Pe=require("react/jsx-runtime");function Ec({name:o,proxies:t,current:n,refresh:s,selectable:a}){let[l,f]=(0,Ze.useState)(n),[m,c]=(0,Ze.useState)(!1);return(0,Pe.jsx)(fe.List,{isLoading:m,children:t.map((h,b)=>a?(0,Pe.jsx)(fe.List.Item,{title:h,accessoryTitle:h==l?"Current":"",actions:(0,Pe.jsx)(fe.ActionPanel,{children:(0,Pe.jsx)(fe.Action,{title:"Select",onAction:async()=>{try{c(!0),await il(o,h),s(),f(h)}catch(g){ae(g)}finally{c(!1)}}})})},b):(0,Pe.jsx)(fe.List.Item,{title:h,accessoryTitle:h==l?"Current":""},b))})}var Cc=["Selector","URLTest","Fallback","LoadBalance","Relay"];function Vo(){let[o,t]=(0,Ze.useState)(!0),[n,s]=(0,Ze.useState)([]),[a,l]=(0,Ze.useState)(!1);return(0,Ze.useEffect)(()=>{(async()=>{try{t(!0);let m=await rl(),c=[];for(let[b,g]of Object.entries(n))b==="GLOBAL"&&g.all&&(c=g.all);let h=Object.values(m).filter(({type:b})=>Cc.includes(b)).sort(({name:b},{name:g})=>c.indexOf(b)-c.indexOf(g));s(h)}catch(m){ae(m)}finally{t(!1)}})()},[a]),(0,Pe.jsx)(fe.List,{isLoading:o,children:n.map((f,m)=>(0,Pe.jsx)(fe.List.Item,{title:f.name,subtitle:f.type,accessoryTitle:f.now,actions:(0,Pe.jsx)(fe.ActionPanel,{children:(0,Pe.jsx)(fe.Action.Push,{title:"Show Proxies",target:(0,Pe.jsx)(Ec,{name:f.name,proxies:f.all,current:f.now,refresh:()=>l(!a),selectable:f.type=="Selector"})})})},m))})}var Tr=require("@raycast/api"),Mt=require("react");var An=require("react/jsx-runtime"),al=["Domain","DomainSuffix","DomainKeyword","GeoIP","IPCIDR","SrcIPCIDR","SrcPort","DstPort","Process","ProcessPath","Match"];function Yo(){let[o,t]=(0,Mt.useState)(!0),[n,s]=(0,Mt.useState)([]),[a,l]=(0,Mt.useState)(al[0]);return(0,Mt.useEffect)(()=>{(async()=>{try{t(!0);let m=await nl();s(m)}catch(m){ae(m)}finally{t(!1)}})()},[]),(0,An.jsx)(Tr.List,{isLoading:o,searchBarAccessory:(0,An.jsx)(Tr.List.Dropdown,{tooltip:"Type",storeValue:!1,onChange:f=>l(f),children:al.map((f,m)=>(0,An.jsx)(Tr.List.Dropdown.Item,{title:f,value:f},m))}),children:n.filter(f=>f.type===a).map((f,m)=>(0,An.jsx)(Tr.List.Item,{title:f.payload,subtitle:f.type,accessoryTitle:f.proxy},m))})}var mt=require("@raycast/api"),Ut=require("react");var kn=require("react/jsx-runtime"),Pc=["rule","global","direct","script"];function Qo(){let[o,t]=(0,Ut.useState)(!1),[n,s]=(0,Ut.useState)(""),[a,l]=(0,Ut.useState)(!1);return(0,Ut.useEffect)(()=>{(async()=>{try{t(!0);let m=await ol();s(m.mode)}catch(m){ae(m)}finally{t(!1)}})()},[a]),(0,kn.jsx)(mt.List,{isLoading:o,children:Pc.map((f,m)=>(0,kn.jsx)(mt.List.Item,{title:Vi(f),accessoryTitle:f==n?"Current":"",actions:(0,kn.jsx)(mt.ActionPanel,{children:(0,kn.jsx)(mt.Action,{title:"Select",onAction:async()=>{try{t(!0),await sl({mode:f}),l(!a)}catch(c){ae(c)}finally{t(!1)}}})})},m))})}var et={Overview:Go,Proxies:Vo,Backends:Ro,Conns:jo,Rules:Yo,Logs:Ho,Mode:Qo};var ye=require("react/jsx-runtime"),vc=[{title:"Overview",icon:"overview.png",node:(0,ye.jsx)(et.Overview,{})},{title:"Mode",icon:"mode.png",node:(0,ye.jsx)(et.Mode,{})},{title:"Proxies",icon:"proxies.png",node:(0,ye.jsx)(et.Proxies,{})},{title:"Rules",icon:"rules.png",node:(0,ye.jsx)(et.Rules,{})},{title:"Conns",icon:"conns.png",node:(0,ye.jsx)(et.Conns,{})},{title:"Logs",icon:"logs.png",node:(0,ye.jsx)(et.Logs,{})},{title:"Backends",icon:"backends.png",node:(0,ye.jsx)(et.Backends,{})}];function ll(){return bn().catch(ae),(0,ye.jsx)(pt.List,{children:vc.map((o,t)=>(0,ye.jsx)(pt.List.Item,{title:o.title,icon:o.icon,actions:(0,ye.jsx)(pt.ActionPanel,{children:(0,ye.jsx)(pt.Action.Push,{title:`Show ${o.title}`,target:o.node})})},t))})}0&&(module.exports={});
/*! fetch-blob. MIT License. Jimmy Wärting <https://jimmy.warting.se/opensource> */
/*! formdata-polyfill. MIT License. Jimmy Wärting <https://jimmy.warting.se/opensource> */

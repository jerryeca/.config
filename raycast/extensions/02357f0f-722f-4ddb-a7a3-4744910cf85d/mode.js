"use strict";var Ou=Object.create;var en=Object.defineProperty;var Lu=Object.getOwnPropertyDescriptor;var Du=Object.getOwnPropertyNames;var Wu=Object.getPrototypeOf,Iu=Object.prototype.hasOwnProperty;var er=(o,t)=>()=>(o&&(t=o(o=0)),t);var G=(o,t)=>()=>(t||o((t={exports:{}}).exports,t),t.exports),ii=(o,t)=>{for(var n in t)en(o,n,{get:t[n],enumerable:!0})},ai=(o,t,n,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of Du(t))!Iu.call(o,a)&&a!==n&&en(o,a,{get:()=>t[a],enumerable:!(s=Lu(t,a))||s.enumerable});return o};var st=(o,t,n)=>(n=o!=null?Ou(Wu(o)):{},ai(t||!o||!o.__esModule?en(n,"default",{value:o,enumerable:!0}):n,o)),Fu=o=>ai(en({},"__esModule",{value:!0}),o);var fi=G((tn,ui)=>{(function(o,t){typeof tn=="object"&&typeof ui<"u"?t(tn):typeof define=="function"&&define.amd?define(["exports"],t):(o=typeof globalThis<"u"?globalThis:o||self,t(o.WebStreamsPolyfill={}))})(tn,function(o){"use strict";let t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol:e=>`Symbol(${e})`;function n(){}function s(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global}let a=s();function l(e){return typeof e=="object"&&e!==null||typeof e=="function"}let f=n,m=Promise,c=Promise.prototype.then,h=Promise.resolve.bind(m),b=Promise.reject.bind(m);function g(e){return new m(e)}function w(e){return h(e)}function S(e){return b(e)}function y(e,r,i){return c.call(e,r,i)}function T(e,r,i){y(y(e,r,i),void 0,f)}function P(e,r){T(e,r)}function A(e,r){T(e,void 0,r)}function D(e,r,i){return y(e,r,i)}function q(e){y(e,void 0,f)}let W=(()=>{let e=a&&a.queueMicrotask;if(typeof e=="function")return e;let r=w(void 0);return i=>y(r,i)})();function M(e,r,i){if(typeof e!="function")throw new TypeError("Argument is not a function");return Function.prototype.apply.call(e,r,i)}function I(e,r,i){try{return w(M(e,r,i))}catch(u){return S(u)}}let fe=16384;class Y{constructor(){this._cursor=0,this._size=0,this._front={_elements:[],_next:void 0},this._back=this._front,this._cursor=0,this._size=0}get length(){return this._size}push(r){let i=this._back,u=i;i._elements.length===fe-1&&(u={_elements:[],_next:void 0}),i._elements.push(r),u!==i&&(this._back=u,i._next=u),++this._size}shift(){let r=this._front,i=r,u=this._cursor,d=u+1,p=r._elements,_=p[u];return d===fe&&(i=r._next,d=0),--this._size,this._cursor=d,r!==i&&(this._front=i),p[u]=void 0,_}forEach(r){let i=this._cursor,u=this._front,d=u._elements;for(;(i!==d.length||u._next!==void 0)&&!(i===d.length&&(u=u._next,d=u._elements,i=0,d.length===0));)r(d[i]),++i}peek(){let r=this._front,i=this._cursor;return r._elements[i]}}function wr(e,r){e._ownerReadableStream=r,r._reader=e,r._state==="readable"?vn(e):r._state==="closed"?al(e):Go(e,r._storedError)}function Pn(e,r){let i=e._ownerReadableStream;return he(i,r)}function Pe(e){e._ownerReadableStream._state==="readable"?An(e,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")):ll(e,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")),e._ownerReadableStream._reader=void 0,e._ownerReadableStream=void 0}function ht(e){return new TypeError("Cannot "+e+" a stream using a released reader")}function vn(e){e._closedPromise=g((r,i)=>{e._closedPromise_resolve=r,e._closedPromise_reject=i})}function Go(e,r){vn(e),An(e,r)}function al(e){vn(e),Vo(e)}function An(e,r){e._closedPromise_reject!==void 0&&(q(e._closedPromise),e._closedPromise_reject(r),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0)}function ll(e,r){Go(e,r)}function Vo(e){e._closedPromise_resolve!==void 0&&(e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0)}let Yo=t("[[AbortSteps]]"),Qo=t("[[ErrorSteps]]"),kn=t("[[CancelSteps]]"),xn=t("[[PullSteps]]"),Xo=Number.isFinite||function(e){return typeof e=="number"&&isFinite(e)},ul=Math.trunc||function(e){return e<0?Math.ceil(e):Math.floor(e)};function fl(e){return typeof e=="object"||typeof e=="function"}function ve(e,r){if(e!==void 0&&!fl(e))throw new TypeError(`${r} is not an object.`)}function ce(e,r){if(typeof e!="function")throw new TypeError(`${r} is not a function.`)}function cl(e){return typeof e=="object"&&e!==null||typeof e=="function"}function Ko(e,r){if(!cl(e))throw new TypeError(`${r} is not an object.`)}function Ae(e,r,i){if(e===void 0)throw new TypeError(`Parameter ${r} is required in '${i}'.`)}function Bn(e,r,i){if(e===void 0)throw new TypeError(`${r} is required in '${i}'.`)}function On(e){return Number(e)}function Zo(e){return e===0?0:e}function dl(e){return Zo(ul(e))}function Jo(e,r){let u=Number.MAX_SAFE_INTEGER,d=Number(e);if(d=Zo(d),!Xo(d))throw new TypeError(`${r} is not a finite number`);if(d=dl(d),d<0||d>u)throw new TypeError(`${r} is outside the accepted range of ${0} to ${u}, inclusive`);return!Xo(d)||d===0?0:d}function Ln(e,r){if(!ze(e))throw new TypeError(`${r} is not a ReadableStream.`)}function mt(e){return new qt(e)}function es(e,r){e._reader._readRequests.push(r)}function Dn(e,r,i){let d=e._reader._readRequests.shift();i?d._closeSteps():d._chunkSteps(r)}function Rr(e){return e._reader._readRequests.length}function ts(e){let r=e._reader;return!(r===void 0||!qe(r))}class qt{constructor(r){if(Ae(r,1,"ReadableStreamDefaultReader"),Ln(r,"First parameter"),je(r))throw new TypeError("This stream has already been locked for exclusive reading by another reader");wr(this,r),this._readRequests=new Y}get closed(){return qe(this)?this._closedPromise:S(Tr("closed"))}cancel(r=void 0){return qe(this)?this._ownerReadableStream===void 0?S(ht("cancel")):Pn(this,r):S(Tr("cancel"))}read(){if(!qe(this))return S(Tr("read"));if(this._ownerReadableStream===void 0)return S(ht("read from"));let r,i,u=g((p,_)=>{r=p,i=_});return Mt(this,{_chunkSteps:p=>r({value:p,done:!1}),_closeSteps:()=>r({value:void 0,done:!0}),_errorSteps:p=>i(p)}),u}releaseLock(){if(!qe(this))throw Tr("releaseLock");if(this._ownerReadableStream!==void 0){if(this._readRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");Pe(this)}}}Object.defineProperties(qt.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(qt.prototype,t.toStringTag,{value:"ReadableStreamDefaultReader",configurable:!0});function qe(e){return!l(e)||!Object.prototype.hasOwnProperty.call(e,"_readRequests")?!1:e instanceof qt}function Mt(e,r){let i=e._ownerReadableStream;i._disturbed=!0,i._state==="closed"?r._closeSteps():i._state==="errored"?r._errorSteps(i._storedError):i._readableStreamController[xn](r)}function Tr(e){return new TypeError(`ReadableStreamDefaultReader.prototype.${e} can only be used on a ReadableStreamDefaultReader`)}let rs=Object.getPrototypeOf(Object.getPrototypeOf(async function*(){}).prototype);class ns{constructor(r,i){this._ongoingPromise=void 0,this._isFinished=!1,this._reader=r,this._preventCancel=i}next(){let r=()=>this._nextSteps();return this._ongoingPromise=this._ongoingPromise?D(this._ongoingPromise,r,r):r(),this._ongoingPromise}return(r){let i=()=>this._returnSteps(r);return this._ongoingPromise?D(this._ongoingPromise,i,i):i()}_nextSteps(){if(this._isFinished)return Promise.resolve({value:void 0,done:!0});let r=this._reader;if(r._ownerReadableStream===void 0)return S(ht("iterate"));let i,u,d=g((_,R)=>{i=_,u=R});return Mt(r,{_chunkSteps:_=>{this._ongoingPromise=void 0,W(()=>i({value:_,done:!1}))},_closeSteps:()=>{this._ongoingPromise=void 0,this._isFinished=!0,Pe(r),i({value:void 0,done:!0})},_errorSteps:_=>{this._ongoingPromise=void 0,this._isFinished=!0,Pe(r),u(_)}}),d}_returnSteps(r){if(this._isFinished)return Promise.resolve({value:r,done:!0});this._isFinished=!0;let i=this._reader;if(i._ownerReadableStream===void 0)return S(ht("finish iterating"));if(!this._preventCancel){let u=Pn(i,r);return Pe(i),D(u,()=>({value:r,done:!0}))}return Pe(i),w({value:r,done:!0})}}let os={next(){return ss(this)?this._asyncIteratorImpl.next():S(is("next"))},return(e){return ss(this)?this._asyncIteratorImpl.return(e):S(is("return"))}};rs!==void 0&&Object.setPrototypeOf(os,rs);function hl(e,r){let i=mt(e),u=new ns(i,r),d=Object.create(os);return d._asyncIteratorImpl=u,d}function ss(e){if(!l(e)||!Object.prototype.hasOwnProperty.call(e,"_asyncIteratorImpl"))return!1;try{return e._asyncIteratorImpl instanceof ns}catch{return!1}}function is(e){return new TypeError(`ReadableStreamAsyncIterator.${e} can only be used on a ReadableSteamAsyncIterator`)}let as=Number.isNaN||function(e){return e!==e};function Ut(e){return e.slice()}function ls(e,r,i,u,d){new Uint8Array(e).set(new Uint8Array(i,u,d),r)}function vc(e){return e}function Er(e){return!1}function us(e,r,i){if(e.slice)return e.slice(r,i);let u=i-r,d=new ArrayBuffer(u);return ls(d,0,e,r,u),d}function ml(e){return!(typeof e!="number"||as(e)||e<0)}function fs(e){let r=us(e.buffer,e.byteOffset,e.byteOffset+e.byteLength);return new Uint8Array(r)}function Wn(e){let r=e._queue.shift();return e._queueTotalSize-=r.size,e._queueTotalSize<0&&(e._queueTotalSize=0),r.value}function In(e,r,i){if(!ml(i)||i===1/0)throw new RangeError("Size must be a finite, non-NaN, non-negative number.");e._queue.push({value:r,size:i}),e._queueTotalSize+=i}function pl(e){return e._queue.peek().value}function Me(e){e._queue=new Y,e._queueTotalSize=0}class $t{constructor(){throw new TypeError("Illegal constructor")}get view(){if(!Fn(this))throw Un("view");return this._view}respond(r){if(!Fn(this))throw Un("respond");if(Ae(r,1,"respond"),r=Jo(r,"First parameter"),this._associatedReadableByteStreamController===void 0)throw new TypeError("This BYOB request has been invalidated");Er(this._view.buffer),kr(this._associatedReadableByteStreamController,r)}respondWithNewView(r){if(!Fn(this))throw Un("respondWithNewView");if(Ae(r,1,"respondWithNewView"),!ArrayBuffer.isView(r))throw new TypeError("You can only respond with array buffer views");if(this._associatedReadableByteStreamController===void 0)throw new TypeError("This BYOB request has been invalidated");Er(r.buffer),xr(this._associatedReadableByteStreamController,r)}}Object.defineProperties($t.prototype,{respond:{enumerable:!0},respondWithNewView:{enumerable:!0},view:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty($t.prototype,t.toStringTag,{value:"ReadableStreamBYOBRequest",configurable:!0});class pt{constructor(){throw new TypeError("Illegal constructor")}get byobRequest(){if(!Je(this))throw jt("byobRequest");return Mn(this)}get desiredSize(){if(!Je(this))throw jt("desiredSize");return ys(this)}close(){if(!Je(this))throw jt("close");if(this._closeRequested)throw new TypeError("The stream has already been closed; do not close it again!");let r=this._controlledReadableByteStream._state;if(r!=="readable")throw new TypeError(`The stream (in ${r} state) is not in the readable state and cannot be closed`);zt(this)}enqueue(r){if(!Je(this))throw jt("enqueue");if(Ae(r,1,"enqueue"),!ArrayBuffer.isView(r))throw new TypeError("chunk must be an array buffer view");if(r.byteLength===0)throw new TypeError("chunk must have non-zero byteLength");if(r.buffer.byteLength===0)throw new TypeError("chunk's buffer must have non-zero byteLength");if(this._closeRequested)throw new TypeError("stream is closed or draining");let i=this._controlledReadableByteStream._state;if(i!=="readable")throw new TypeError(`The stream (in ${i} state) is not in the readable state and cannot be enqueued to`);Ar(this,r)}error(r=void 0){if(!Je(this))throw jt("error");de(this,r)}[kn](r){cs(this),Me(this);let i=this._cancelAlgorithm(r);return vr(this),i}[xn](r){let i=this._controlledReadableByteStream;if(this._queueTotalSize>0){let d=this._queue.shift();this._queueTotalSize-=d.byteLength,ps(this);let p=new Uint8Array(d.buffer,d.byteOffset,d.byteLength);r._chunkSteps(p);return}let u=this._autoAllocateChunkSize;if(u!==void 0){let d;try{d=new ArrayBuffer(u)}catch(_){r._errorSteps(_);return}let p={buffer:d,bufferByteLength:u,byteOffset:0,byteLength:u,bytesFilled:0,elementSize:1,viewConstructor:Uint8Array,readerType:"default"};this._pendingPullIntos.push(p)}es(i,r),et(this)}}Object.defineProperties(pt.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},byobRequest:{enumerable:!0},desiredSize:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(pt.prototype,t.toStringTag,{value:"ReadableByteStreamController",configurable:!0});function Je(e){return!l(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledReadableByteStream")?!1:e instanceof pt}function Fn(e){return!l(e)||!Object.prototype.hasOwnProperty.call(e,"_associatedReadableByteStreamController")?!1:e instanceof $t}function et(e){if(!gl(e))return;if(e._pulling){e._pullAgain=!0;return}e._pulling=!0;let i=e._pullAlgorithm();T(i,()=>{e._pulling=!1,e._pullAgain&&(e._pullAgain=!1,et(e))},u=>{de(e,u)})}function cs(e){qn(e),e._pendingPullIntos=new Y}function Nn(e,r){let i=!1;e._state==="closed"&&(i=!0);let u=ds(r);r.readerType==="default"?Dn(e,u,i):Rl(e,u,i)}function ds(e){let r=e.bytesFilled,i=e.elementSize;return new e.viewConstructor(e.buffer,e.byteOffset,r/i)}function Cr(e,r,i,u){e._queue.push({buffer:r,byteOffset:i,byteLength:u}),e._queueTotalSize+=u}function hs(e,r){let i=r.elementSize,u=r.bytesFilled-r.bytesFilled%i,d=Math.min(e._queueTotalSize,r.byteLength-r.bytesFilled),p=r.bytesFilled+d,_=p-p%i,R=d,k=!1;_>u&&(R=_-r.bytesFilled,k=!0);let B=e._queue;for(;R>0;){let O=B.peek(),L=Math.min(R,O.byteLength),U=r.byteOffset+r.bytesFilled;ls(r.buffer,U,O.buffer,O.byteOffset,L),O.byteLength===L?B.shift():(O.byteOffset+=L,O.byteLength-=L),e._queueTotalSize-=L,ms(e,L,r),R-=L}return k}function ms(e,r,i){i.bytesFilled+=r}function ps(e){e._queueTotalSize===0&&e._closeRequested?(vr(e),Zt(e._controlledReadableByteStream)):et(e)}function qn(e){e._byobRequest!==null&&(e._byobRequest._associatedReadableByteStreamController=void 0,e._byobRequest._view=null,e._byobRequest=null)}function _s(e){for(;e._pendingPullIntos.length>0;){if(e._queueTotalSize===0)return;let r=e._pendingPullIntos.peek();hs(e,r)&&(Pr(e),Nn(e._controlledReadableByteStream,r))}}function _l(e,r,i){let u=e._controlledReadableByteStream,d=1;r.constructor!==DataView&&(d=r.constructor.BYTES_PER_ELEMENT);let p=r.constructor,_=r.buffer,R={buffer:_,bufferByteLength:_.byteLength,byteOffset:r.byteOffset,byteLength:r.byteLength,bytesFilled:0,elementSize:d,viewConstructor:p,readerType:"byob"};if(e._pendingPullIntos.length>0){e._pendingPullIntos.push(R),ws(u,i);return}if(u._state==="closed"){let k=new p(R.buffer,R.byteOffset,0);i._closeSteps(k);return}if(e._queueTotalSize>0){if(hs(e,R)){let k=ds(R);ps(e),i._chunkSteps(k);return}if(e._closeRequested){let k=new TypeError("Insufficient bytes to fill elements in the given buffer");de(e,k),i._errorSteps(k);return}}e._pendingPullIntos.push(R),ws(u,i),et(e)}function bl(e,r){let i=e._controlledReadableByteStream;if($n(i))for(;Rs(i)>0;){let u=Pr(e);Nn(i,u)}}function yl(e,r,i){if(ms(e,r,i),i.bytesFilled<i.elementSize)return;Pr(e);let u=i.bytesFilled%i.elementSize;if(u>0){let d=i.byteOffset+i.bytesFilled,p=us(i.buffer,d-u,d);Cr(e,p,0,p.byteLength)}i.bytesFilled-=u,Nn(e._controlledReadableByteStream,i),_s(e)}function bs(e,r){let i=e._pendingPullIntos.peek();qn(e),e._controlledReadableByteStream._state==="closed"?bl(e):yl(e,r,i),et(e)}function Pr(e){return e._pendingPullIntos.shift()}function gl(e){let r=e._controlledReadableByteStream;return r._state!=="readable"||e._closeRequested||!e._started?!1:!!(ts(r)&&Rr(r)>0||$n(r)&&Rs(r)>0||ys(e)>0)}function vr(e){e._pullAlgorithm=void 0,e._cancelAlgorithm=void 0}function zt(e){let r=e._controlledReadableByteStream;if(!(e._closeRequested||r._state!=="readable")){if(e._queueTotalSize>0){e._closeRequested=!0;return}if(e._pendingPullIntos.length>0&&e._pendingPullIntos.peek().bytesFilled>0){let u=new TypeError("Insufficient bytes to fill elements in the given buffer");throw de(e,u),u}vr(e),Zt(r)}}function Ar(e,r){let i=e._controlledReadableByteStream;if(e._closeRequested||i._state!=="readable")return;let u=r.buffer,d=r.byteOffset,p=r.byteLength,_=u;if(e._pendingPullIntos.length>0){let R=e._pendingPullIntos.peek();Er(R.buffer),R.buffer=R.buffer}if(qn(e),ts(i))if(Rr(i)===0)Cr(e,_,d,p);else{e._pendingPullIntos.length>0&&Pr(e);let R=new Uint8Array(_,d,p);Dn(i,R,!1)}else $n(i)?(Cr(e,_,d,p),_s(e)):Cr(e,_,d,p);et(e)}function de(e,r){let i=e._controlledReadableByteStream;i._state==="readable"&&(cs(e),Me(e),vr(e),Gs(i,r))}function Mn(e){if(e._byobRequest===null&&e._pendingPullIntos.length>0){let r=e._pendingPullIntos.peek(),i=new Uint8Array(r.buffer,r.byteOffset+r.bytesFilled,r.byteLength-r.bytesFilled),u=Object.create($t.prototype);wl(u,e,i),e._byobRequest=u}return e._byobRequest}function ys(e){let r=e._controlledReadableByteStream._state;return r==="errored"?null:r==="closed"?0:e._strategyHWM-e._queueTotalSize}function kr(e,r){let i=e._pendingPullIntos.peek();if(e._controlledReadableByteStream._state==="closed"){if(r!==0)throw new TypeError("bytesWritten must be 0 when calling respond() on a closed stream")}else{if(r===0)throw new TypeError("bytesWritten must be greater than 0 when calling respond() on a readable stream");if(i.bytesFilled+r>i.byteLength)throw new RangeError("bytesWritten out of range")}i.buffer=i.buffer,bs(e,r)}function xr(e,r){let i=e._pendingPullIntos.peek();if(e._controlledReadableByteStream._state==="closed"){if(r.byteLength!==0)throw new TypeError("The view's length must be 0 when calling respondWithNewView() on a closed stream")}else if(r.byteLength===0)throw new TypeError("The view's length must be greater than 0 when calling respondWithNewView() on a readable stream");if(i.byteOffset+i.bytesFilled!==r.byteOffset)throw new RangeError("The region specified by view does not match byobRequest");if(i.bufferByteLength!==r.buffer.byteLength)throw new RangeError("The buffer of view has different capacity than byobRequest");if(i.bytesFilled+r.byteLength>i.byteLength)throw new RangeError("The region specified by view is larger than byobRequest");let d=r.byteLength;i.buffer=r.buffer,bs(e,d)}function gs(e,r,i,u,d,p,_){r._controlledReadableByteStream=e,r._pullAgain=!1,r._pulling=!1,r._byobRequest=null,r._queue=r._queueTotalSize=void 0,Me(r),r._closeRequested=!1,r._started=!1,r._strategyHWM=p,r._pullAlgorithm=u,r._cancelAlgorithm=d,r._autoAllocateChunkSize=_,r._pendingPullIntos=new Y,e._readableStreamController=r;let R=i();T(w(R),()=>{r._started=!0,et(r)},k=>{de(r,k)})}function Sl(e,r,i){let u=Object.create(pt.prototype),d=()=>{},p=()=>w(void 0),_=()=>w(void 0);r.start!==void 0&&(d=()=>r.start(u)),r.pull!==void 0&&(p=()=>r.pull(u)),r.cancel!==void 0&&(_=k=>r.cancel(k));let R=r.autoAllocateChunkSize;if(R===0)throw new TypeError("autoAllocateChunkSize must be greater than 0");gs(e,u,d,p,_,i,R)}function wl(e,r,i){e._associatedReadableByteStreamController=r,e._view=i}function Un(e){return new TypeError(`ReadableStreamBYOBRequest.prototype.${e} can only be used on a ReadableStreamBYOBRequest`)}function jt(e){return new TypeError(`ReadableByteStreamController.prototype.${e} can only be used on a ReadableByteStreamController`)}function Ss(e){return new Ht(e)}function ws(e,r){e._reader._readIntoRequests.push(r)}function Rl(e,r,i){let d=e._reader._readIntoRequests.shift();i?d._closeSteps(r):d._chunkSteps(r)}function Rs(e){return e._reader._readIntoRequests.length}function $n(e){let r=e._reader;return!(r===void 0||!tt(r))}class Ht{constructor(r){if(Ae(r,1,"ReadableStreamBYOBReader"),Ln(r,"First parameter"),je(r))throw new TypeError("This stream has already been locked for exclusive reading by another reader");if(!Je(r._readableStreamController))throw new TypeError("Cannot construct a ReadableStreamBYOBReader for a stream not constructed with a byte source");wr(this,r),this._readIntoRequests=new Y}get closed(){return tt(this)?this._closedPromise:S(Br("closed"))}cancel(r=void 0){return tt(this)?this._ownerReadableStream===void 0?S(ht("cancel")):Pn(this,r):S(Br("cancel"))}read(r){if(!tt(this))return S(Br("read"));if(!ArrayBuffer.isView(r))return S(new TypeError("view must be an array buffer view"));if(r.byteLength===0)return S(new TypeError("view must have non-zero byteLength"));if(r.buffer.byteLength===0)return S(new TypeError("view's buffer must have non-zero byteLength"));if(Er(r.buffer),this._ownerReadableStream===void 0)return S(ht("read from"));let i,u,d=g((_,R)=>{i=_,u=R});return Ts(this,r,{_chunkSteps:_=>i({value:_,done:!1}),_closeSteps:_=>i({value:_,done:!0}),_errorSteps:_=>u(_)}),d}releaseLock(){if(!tt(this))throw Br("releaseLock");if(this._ownerReadableStream!==void 0){if(this._readIntoRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");Pe(this)}}}Object.defineProperties(Ht.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(Ht.prototype,t.toStringTag,{value:"ReadableStreamBYOBReader",configurable:!0});function tt(e){return!l(e)||!Object.prototype.hasOwnProperty.call(e,"_readIntoRequests")?!1:e instanceof Ht}function Ts(e,r,i){let u=e._ownerReadableStream;u._disturbed=!0,u._state==="errored"?i._errorSteps(u._storedError):_l(u._readableStreamController,r,i)}function Br(e){return new TypeError(`ReadableStreamBYOBReader.prototype.${e} can only be used on a ReadableStreamBYOBReader`)}function Gt(e,r){let{highWaterMark:i}=e;if(i===void 0)return r;if(as(i)||i<0)throw new RangeError("Invalid highWaterMark");return i}function Or(e){let{size:r}=e;return r||(()=>1)}function Lr(e,r){ve(e,r);let i=e?.highWaterMark,u=e?.size;return{highWaterMark:i===void 0?void 0:On(i),size:u===void 0?void 0:Tl(u,`${r} has member 'size' that`)}}function Tl(e,r){return ce(e,r),i=>On(e(i))}function El(e,r){ve(e,r);let i=e?.abort,u=e?.close,d=e?.start,p=e?.type,_=e?.write;return{abort:i===void 0?void 0:Cl(i,e,`${r} has member 'abort' that`),close:u===void 0?void 0:Pl(u,e,`${r} has member 'close' that`),start:d===void 0?void 0:vl(d,e,`${r} has member 'start' that`),write:_===void 0?void 0:Al(_,e,`${r} has member 'write' that`),type:p}}function Cl(e,r,i){return ce(e,i),u=>I(e,r,[u])}function Pl(e,r,i){return ce(e,i),()=>I(e,r,[])}function vl(e,r,i){return ce(e,i),u=>M(e,r,[u])}function Al(e,r,i){return ce(e,i),(u,d)=>I(e,r,[u,d])}function Es(e,r){if(!_t(e))throw new TypeError(`${r} is not a WritableStream.`)}function kl(e){if(typeof e!="object"||e===null)return!1;try{return typeof e.aborted=="boolean"}catch{return!1}}let xl=typeof AbortController=="function";function Bl(){if(xl)return new AbortController}class Vt{constructor(r={},i={}){r===void 0?r=null:Ko(r,"First parameter");let u=Lr(i,"Second parameter"),d=El(r,"First parameter");if(Ps(this),d.type!==void 0)throw new RangeError("Invalid type is specified");let _=Or(u),R=Gt(u,1);Hl(this,d,R,_)}get locked(){if(!_t(this))throw Nr("locked");return bt(this)}abort(r=void 0){return _t(this)?bt(this)?S(new TypeError("Cannot abort a stream that already has a writer")):Dr(this,r):S(Nr("abort"))}close(){return _t(this)?bt(this)?S(new TypeError("Cannot close a stream that already has a writer")):be(this)?S(new TypeError("Cannot close an already-closing stream")):vs(this):S(Nr("close"))}getWriter(){if(!_t(this))throw Nr("getWriter");return Cs(this)}}Object.defineProperties(Vt.prototype,{abort:{enumerable:!0},close:{enumerable:!0},getWriter:{enumerable:!0},locked:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(Vt.prototype,t.toStringTag,{value:"WritableStream",configurable:!0});function Cs(e){return new Yt(e)}function Ol(e,r,i,u,d=1,p=()=>1){let _=Object.create(Vt.prototype);Ps(_);let R=Object.create(yt.prototype);return Ls(_,R,e,r,i,u,d,p),_}function Ps(e){e._state="writable",e._storedError=void 0,e._writer=void 0,e._writableStreamController=void 0,e._writeRequests=new Y,e._inFlightWriteRequest=void 0,e._closeRequest=void 0,e._inFlightCloseRequest=void 0,e._pendingAbortRequest=void 0,e._backpressure=!1}function _t(e){return!l(e)||!Object.prototype.hasOwnProperty.call(e,"_writableStreamController")?!1:e instanceof Vt}function bt(e){return e._writer!==void 0}function Dr(e,r){var i;if(e._state==="closed"||e._state==="errored")return w(void 0);e._writableStreamController._abortReason=r,(i=e._writableStreamController._abortController)===null||i===void 0||i.abort();let u=e._state;if(u==="closed"||u==="errored")return w(void 0);if(e._pendingAbortRequest!==void 0)return e._pendingAbortRequest._promise;let d=!1;u==="erroring"&&(d=!0,r=void 0);let p=g((_,R)=>{e._pendingAbortRequest={_promise:void 0,_resolve:_,_reject:R,_reason:r,_wasAlreadyErroring:d}});return e._pendingAbortRequest._promise=p,d||jn(e,r),p}function vs(e){let r=e._state;if(r==="closed"||r==="errored")return S(new TypeError(`The stream (in ${r} state) is not in the writable state and cannot be closed`));let i=g((d,p)=>{let _={_resolve:d,_reject:p};e._closeRequest=_}),u=e._writer;return u!==void 0&&e._backpressure&&r==="writable"&&Jn(u),Gl(e._writableStreamController),i}function Ll(e){return g((i,u)=>{let d={_resolve:i,_reject:u};e._writeRequests.push(d)})}function zn(e,r){if(e._state==="writable"){jn(e,r);return}Hn(e)}function jn(e,r){let i=e._writableStreamController;e._state="erroring",e._storedError=r;let u=e._writer;u!==void 0&&ks(u,r),!Nl(e)&&i._started&&Hn(e)}function Hn(e){e._state="errored",e._writableStreamController[Qo]();let r=e._storedError;if(e._writeRequests.forEach(d=>{d._reject(r)}),e._writeRequests=new Y,e._pendingAbortRequest===void 0){Wr(e);return}let i=e._pendingAbortRequest;if(e._pendingAbortRequest=void 0,i._wasAlreadyErroring){i._reject(r),Wr(e);return}let u=e._writableStreamController[Yo](i._reason);T(u,()=>{i._resolve(),Wr(e)},d=>{i._reject(d),Wr(e)})}function Dl(e){e._inFlightWriteRequest._resolve(void 0),e._inFlightWriteRequest=void 0}function Wl(e,r){e._inFlightWriteRequest._reject(r),e._inFlightWriteRequest=void 0,zn(e,r)}function Il(e){e._inFlightCloseRequest._resolve(void 0),e._inFlightCloseRequest=void 0,e._state==="erroring"&&(e._storedError=void 0,e._pendingAbortRequest!==void 0&&(e._pendingAbortRequest._resolve(),e._pendingAbortRequest=void 0)),e._state="closed";let i=e._writer;i!==void 0&&Fs(i)}function Fl(e,r){e._inFlightCloseRequest._reject(r),e._inFlightCloseRequest=void 0,e._pendingAbortRequest!==void 0&&(e._pendingAbortRequest._reject(r),e._pendingAbortRequest=void 0),zn(e,r)}function be(e){return!(e._closeRequest===void 0&&e._inFlightCloseRequest===void 0)}function Nl(e){return!(e._inFlightWriteRequest===void 0&&e._inFlightCloseRequest===void 0)}function ql(e){e._inFlightCloseRequest=e._closeRequest,e._closeRequest=void 0}function Ml(e){e._inFlightWriteRequest=e._writeRequests.shift()}function Wr(e){e._closeRequest!==void 0&&(e._closeRequest._reject(e._storedError),e._closeRequest=void 0);let r=e._writer;r!==void 0&&Kn(r,e._storedError)}function Gn(e,r){let i=e._writer;i!==void 0&&r!==e._backpressure&&(r?Jl(i):Jn(i)),e._backpressure=r}class Yt{constructor(r){if(Ae(r,1,"WritableStreamDefaultWriter"),Es(r,"First parameter"),bt(r))throw new TypeError("This stream has already been locked for exclusive writing by another writer");this._ownerWritableStream=r,r._writer=this;let i=r._state;if(i==="writable")!be(r)&&r._backpressure?Mr(this):Ns(this),qr(this);else if(i==="erroring")Zn(this,r._storedError),qr(this);else if(i==="closed")Ns(this),Kl(this);else{let u=r._storedError;Zn(this,u),Is(this,u)}}get closed(){return rt(this)?this._closedPromise:S(nt("closed"))}get desiredSize(){if(!rt(this))throw nt("desiredSize");if(this._ownerWritableStream===void 0)throw Qt("desiredSize");return jl(this)}get ready(){return rt(this)?this._readyPromise:S(nt("ready"))}abort(r=void 0){return rt(this)?this._ownerWritableStream===void 0?S(Qt("abort")):Ul(this,r):S(nt("abort"))}close(){if(!rt(this))return S(nt("close"));let r=this._ownerWritableStream;return r===void 0?S(Qt("close")):be(r)?S(new TypeError("Cannot close an already-closing stream")):As(this)}releaseLock(){if(!rt(this))throw nt("releaseLock");this._ownerWritableStream!==void 0&&xs(this)}write(r=void 0){return rt(this)?this._ownerWritableStream===void 0?S(Qt("write to")):Bs(this,r):S(nt("write"))}}Object.defineProperties(Yt.prototype,{abort:{enumerable:!0},close:{enumerable:!0},releaseLock:{enumerable:!0},write:{enumerable:!0},closed:{enumerable:!0},desiredSize:{enumerable:!0},ready:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(Yt.prototype,t.toStringTag,{value:"WritableStreamDefaultWriter",configurable:!0});function rt(e){return!l(e)||!Object.prototype.hasOwnProperty.call(e,"_ownerWritableStream")?!1:e instanceof Yt}function Ul(e,r){let i=e._ownerWritableStream;return Dr(i,r)}function As(e){let r=e._ownerWritableStream;return vs(r)}function $l(e){let r=e._ownerWritableStream,i=r._state;return be(r)||i==="closed"?w(void 0):i==="errored"?S(r._storedError):As(e)}function zl(e,r){e._closedPromiseState==="pending"?Kn(e,r):Zl(e,r)}function ks(e,r){e._readyPromiseState==="pending"?qs(e,r):eu(e,r)}function jl(e){let r=e._ownerWritableStream,i=r._state;return i==="errored"||i==="erroring"?null:i==="closed"?0:Ds(r._writableStreamController)}function xs(e){let r=e._ownerWritableStream,i=new TypeError("Writer was released and can no longer be used to monitor the stream's closedness");ks(e,i),zl(e,i),r._writer=void 0,e._ownerWritableStream=void 0}function Bs(e,r){let i=e._ownerWritableStream,u=i._writableStreamController,d=Vl(u,r);if(i!==e._ownerWritableStream)return S(Qt("write to"));let p=i._state;if(p==="errored")return S(i._storedError);if(be(i)||p==="closed")return S(new TypeError("The stream is closing or closed and cannot be written to"));if(p==="erroring")return S(i._storedError);let _=Ll(i);return Yl(u,r,d),_}let Os={};class yt{constructor(){throw new TypeError("Illegal constructor")}get abortReason(){if(!Vn(this))throw Xn("abortReason");return this._abortReason}get signal(){if(!Vn(this))throw Xn("signal");if(this._abortController===void 0)throw new TypeError("WritableStreamDefaultController.prototype.signal is not supported");return this._abortController.signal}error(r=void 0){if(!Vn(this))throw Xn("error");this._controlledWritableStream._state==="writable"&&Ws(this,r)}[Yo](r){let i=this._abortAlgorithm(r);return Ir(this),i}[Qo](){Me(this)}}Object.defineProperties(yt.prototype,{abortReason:{enumerable:!0},signal:{enumerable:!0},error:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(yt.prototype,t.toStringTag,{value:"WritableStreamDefaultController",configurable:!0});function Vn(e){return!l(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledWritableStream")?!1:e instanceof yt}function Ls(e,r,i,u,d,p,_,R){r._controlledWritableStream=e,e._writableStreamController=r,r._queue=void 0,r._queueTotalSize=void 0,Me(r),r._abortReason=void 0,r._abortController=Bl(),r._started=!1,r._strategySizeAlgorithm=R,r._strategyHWM=_,r._writeAlgorithm=u,r._closeAlgorithm=d,r._abortAlgorithm=p;let k=Qn(r);Gn(e,k);let B=i(),O=w(B);T(O,()=>{r._started=!0,Fr(r)},L=>{r._started=!0,zn(e,L)})}function Hl(e,r,i,u){let d=Object.create(yt.prototype),p=()=>{},_=()=>w(void 0),R=()=>w(void 0),k=()=>w(void 0);r.start!==void 0&&(p=()=>r.start(d)),r.write!==void 0&&(_=B=>r.write(B,d)),r.close!==void 0&&(R=()=>r.close()),r.abort!==void 0&&(k=B=>r.abort(B)),Ls(e,d,p,_,R,k,i,u)}function Ir(e){e._writeAlgorithm=void 0,e._closeAlgorithm=void 0,e._abortAlgorithm=void 0,e._strategySizeAlgorithm=void 0}function Gl(e){In(e,Os,0),Fr(e)}function Vl(e,r){try{return e._strategySizeAlgorithm(r)}catch(i){return Yn(e,i),1}}function Ds(e){return e._strategyHWM-e._queueTotalSize}function Yl(e,r,i){try{In(e,r,i)}catch(d){Yn(e,d);return}let u=e._controlledWritableStream;if(!be(u)&&u._state==="writable"){let d=Qn(e);Gn(u,d)}Fr(e)}function Fr(e){let r=e._controlledWritableStream;if(!e._started||r._inFlightWriteRequest!==void 0)return;if(r._state==="erroring"){Hn(r);return}if(e._queue.length===0)return;let u=pl(e);u===Os?Ql(e):Xl(e,u)}function Yn(e,r){e._controlledWritableStream._state==="writable"&&Ws(e,r)}function Ql(e){let r=e._controlledWritableStream;ql(r),Wn(e);let i=e._closeAlgorithm();Ir(e),T(i,()=>{Il(r)},u=>{Fl(r,u)})}function Xl(e,r){let i=e._controlledWritableStream;Ml(i);let u=e._writeAlgorithm(r);T(u,()=>{Dl(i);let d=i._state;if(Wn(e),!be(i)&&d==="writable"){let p=Qn(e);Gn(i,p)}Fr(e)},d=>{i._state==="writable"&&Ir(e),Wl(i,d)})}function Qn(e){return Ds(e)<=0}function Ws(e,r){let i=e._controlledWritableStream;Ir(e),jn(i,r)}function Nr(e){return new TypeError(`WritableStream.prototype.${e} can only be used on a WritableStream`)}function Xn(e){return new TypeError(`WritableStreamDefaultController.prototype.${e} can only be used on a WritableStreamDefaultController`)}function nt(e){return new TypeError(`WritableStreamDefaultWriter.prototype.${e} can only be used on a WritableStreamDefaultWriter`)}function Qt(e){return new TypeError("Cannot "+e+" a stream using a released writer")}function qr(e){e._closedPromise=g((r,i)=>{e._closedPromise_resolve=r,e._closedPromise_reject=i,e._closedPromiseState="pending"})}function Is(e,r){qr(e),Kn(e,r)}function Kl(e){qr(e),Fs(e)}function Kn(e,r){e._closedPromise_reject!==void 0&&(q(e._closedPromise),e._closedPromise_reject(r),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="rejected")}function Zl(e,r){Is(e,r)}function Fs(e){e._closedPromise_resolve!==void 0&&(e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="resolved")}function Mr(e){e._readyPromise=g((r,i)=>{e._readyPromise_resolve=r,e._readyPromise_reject=i}),e._readyPromiseState="pending"}function Zn(e,r){Mr(e),qs(e,r)}function Ns(e){Mr(e),Jn(e)}function qs(e,r){e._readyPromise_reject!==void 0&&(q(e._readyPromise),e._readyPromise_reject(r),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="rejected")}function Jl(e){Mr(e)}function eu(e,r){Zn(e,r)}function Jn(e){e._readyPromise_resolve!==void 0&&(e._readyPromise_resolve(void 0),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="fulfilled")}let Ms=typeof DOMException<"u"?DOMException:void 0;function tu(e){if(!(typeof e=="function"||typeof e=="object"))return!1;try{return new e,!0}catch{return!1}}function ru(){let e=function(i,u){this.message=i||"",this.name=u||"Error",Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)};return e.prototype=Object.create(Error.prototype),Object.defineProperty(e.prototype,"constructor",{value:e,writable:!0,configurable:!0}),e}let nu=tu(Ms)?Ms:ru();function Us(e,r,i,u,d,p){let _=mt(e),R=Cs(r);e._disturbed=!0;let k=!1,B=w(void 0);return g((O,L)=>{let U;if(p!==void 0){if(U=()=>{let E=new nu("Aborted","AbortError"),x=[];u||x.push(()=>r._state==="writable"?Dr(r,E):w(void 0)),d||x.push(()=>e._state==="readable"?he(e,E):w(void 0)),K(()=>Promise.all(x.map(F=>F())),!0,E)},p.aborted){U();return}p.addEventListener("abort",U)}function me(){return g((E,x)=>{function F(te){te?E():y(wt(),F,x)}F(!1)})}function wt(){return k?w(!0):y(R._readyPromise,()=>g((E,x)=>{Mt(_,{_chunkSteps:F=>{B=y(Bs(R,F),void 0,n),E(!1)},_closeSteps:()=>E(!0),_errorSteps:x})}))}if(ke(e,_._closedPromise,E=>{u?ie(!0,E):K(()=>Dr(r,E),!0,E)}),ke(r,R._closedPromise,E=>{d?ie(!0,E):K(()=>he(e,E),!0,E)}),Q(e,_._closedPromise,()=>{i?ie():K(()=>$l(R))}),be(r)||r._state==="closed"){let E=new TypeError("the destination writable stream closed before all data could be piped to it");d?ie(!0,E):K(()=>he(e,E),!0,E)}q(me());function He(){let E=B;return y(B,()=>E!==B?He():void 0)}function ke(E,x,F){E._state==="errored"?F(E._storedError):A(x,F)}function Q(E,x,F){E._state==="closed"?F():P(x,F)}function K(E,x,F){if(k)return;k=!0,r._state==="writable"&&!be(r)?P(He(),te):te();function te(){T(E(),()=>xe(x,F),Rt=>xe(!0,Rt))}}function ie(E,x){k||(k=!0,r._state==="writable"&&!be(r)?P(He(),()=>xe(E,x)):xe(E,x))}function xe(E,x){xs(R),Pe(_),p!==void 0&&p.removeEventListener("abort",U),E?L(x):O(void 0)}})}class gt{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!Ur(this))throw jr("desiredSize");return eo(this)}close(){if(!Ur(this))throw jr("close");if(!St(this))throw new TypeError("The stream is not in a state that permits close");Kt(this)}enqueue(r=void 0){if(!Ur(this))throw jr("enqueue");if(!St(this))throw new TypeError("The stream is not in a state that permits enqueue");return zr(this,r)}error(r=void 0){if(!Ur(this))throw jr("error");Ue(this,r)}[kn](r){Me(this);let i=this._cancelAlgorithm(r);return $r(this),i}[xn](r){let i=this._controlledReadableStream;if(this._queue.length>0){let u=Wn(this);this._closeRequested&&this._queue.length===0?($r(this),Zt(i)):Xt(this),r._chunkSteps(u)}else es(i,r),Xt(this)}}Object.defineProperties(gt.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},desiredSize:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(gt.prototype,t.toStringTag,{value:"ReadableStreamDefaultController",configurable:!0});function Ur(e){return!l(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledReadableStream")?!1:e instanceof gt}function Xt(e){if(!$s(e))return;if(e._pulling){e._pullAgain=!0;return}e._pulling=!0;let i=e._pullAlgorithm();T(i,()=>{e._pulling=!1,e._pullAgain&&(e._pullAgain=!1,Xt(e))},u=>{Ue(e,u)})}function $s(e){let r=e._controlledReadableStream;return!St(e)||!e._started?!1:!!(je(r)&&Rr(r)>0||eo(e)>0)}function $r(e){e._pullAlgorithm=void 0,e._cancelAlgorithm=void 0,e._strategySizeAlgorithm=void 0}function Kt(e){if(!St(e))return;let r=e._controlledReadableStream;e._closeRequested=!0,e._queue.length===0&&($r(e),Zt(r))}function zr(e,r){if(!St(e))return;let i=e._controlledReadableStream;if(je(i)&&Rr(i)>0)Dn(i,r,!1);else{let u;try{u=e._strategySizeAlgorithm(r)}catch(d){throw Ue(e,d),d}try{In(e,r,u)}catch(d){throw Ue(e,d),d}}Xt(e)}function Ue(e,r){let i=e._controlledReadableStream;i._state==="readable"&&(Me(e),$r(e),Gs(i,r))}function eo(e){let r=e._controlledReadableStream._state;return r==="errored"?null:r==="closed"?0:e._strategyHWM-e._queueTotalSize}function ou(e){return!$s(e)}function St(e){let r=e._controlledReadableStream._state;return!e._closeRequested&&r==="readable"}function zs(e,r,i,u,d,p,_){r._controlledReadableStream=e,r._queue=void 0,r._queueTotalSize=void 0,Me(r),r._started=!1,r._closeRequested=!1,r._pullAgain=!1,r._pulling=!1,r._strategySizeAlgorithm=_,r._strategyHWM=p,r._pullAlgorithm=u,r._cancelAlgorithm=d,e._readableStreamController=r;let R=i();T(w(R),()=>{r._started=!0,Xt(r)},k=>{Ue(r,k)})}function su(e,r,i,u){let d=Object.create(gt.prototype),p=()=>{},_=()=>w(void 0),R=()=>w(void 0);r.start!==void 0&&(p=()=>r.start(d)),r.pull!==void 0&&(_=()=>r.pull(d)),r.cancel!==void 0&&(R=k=>r.cancel(k)),zs(e,d,p,_,R,i,u)}function jr(e){return new TypeError(`ReadableStreamDefaultController.prototype.${e} can only be used on a ReadableStreamDefaultController`)}function iu(e,r){return Je(e._readableStreamController)?lu(e):au(e)}function au(e,r){let i=mt(e),u=!1,d=!1,p=!1,_=!1,R,k,B,O,L,U=g(Q=>{L=Q});function me(){return u?(d=!0,w(void 0)):(u=!0,Mt(i,{_chunkSteps:K=>{W(()=>{d=!1;let ie=K,xe=K;p||zr(B._readableStreamController,ie),_||zr(O._readableStreamController,xe),u=!1,d&&me()})},_closeSteps:()=>{u=!1,p||Kt(B._readableStreamController),_||Kt(O._readableStreamController),(!p||!_)&&L(void 0)},_errorSteps:()=>{u=!1}}),w(void 0))}function wt(Q){if(p=!0,R=Q,_){let K=Ut([R,k]),ie=he(e,K);L(ie)}return U}function He(Q){if(_=!0,k=Q,p){let K=Ut([R,k]),ie=he(e,K);L(ie)}return U}function ke(){}return B=to(ke,me,wt),O=to(ke,me,He),A(i._closedPromise,Q=>{Ue(B._readableStreamController,Q),Ue(O._readableStreamController,Q),(!p||!_)&&L(void 0)}),[B,O]}function lu(e){let r=mt(e),i=!1,u=!1,d=!1,p=!1,_=!1,R,k,B,O,L,U=g(E=>{L=E});function me(E){A(E._closedPromise,x=>{E===r&&(de(B._readableStreamController,x),de(O._readableStreamController,x),(!p||!_)&&L(void 0))})}function wt(){tt(r)&&(Pe(r),r=mt(e),me(r)),Mt(r,{_chunkSteps:x=>{W(()=>{u=!1,d=!1;let F=x,te=x;if(!p&&!_)try{te=fs(x)}catch(Rt){de(B._readableStreamController,Rt),de(O._readableStreamController,Rt),L(he(e,Rt));return}p||Ar(B._readableStreamController,F),_||Ar(O._readableStreamController,te),i=!1,u?ke():d&&Q()})},_closeSteps:()=>{i=!1,p||zt(B._readableStreamController),_||zt(O._readableStreamController),B._readableStreamController._pendingPullIntos.length>0&&kr(B._readableStreamController,0),O._readableStreamController._pendingPullIntos.length>0&&kr(O._readableStreamController,0),(!p||!_)&&L(void 0)},_errorSteps:()=>{i=!1}})}function He(E,x){qe(r)&&(Pe(r),r=Ss(e),me(r));let F=x?O:B,te=x?B:O;Ts(r,E,{_chunkSteps:Tt=>{W(()=>{u=!1,d=!1;let Et=x?_:p;if(x?p:_)Et||xr(F._readableStreamController,Tt);else{let si;try{si=fs(Tt)}catch(no){de(F._readableStreamController,no),de(te._readableStreamController,no),L(he(e,no));return}Et||xr(F._readableStreamController,Tt),Ar(te._readableStreamController,si)}i=!1,u?ke():d&&Q()})},_closeSteps:Tt=>{i=!1;let Et=x?_:p,Jr=x?p:_;Et||zt(F._readableStreamController),Jr||zt(te._readableStreamController),Tt!==void 0&&(Et||xr(F._readableStreamController,Tt),!Jr&&te._readableStreamController._pendingPullIntos.length>0&&kr(te._readableStreamController,0)),(!Et||!Jr)&&L(void 0)},_errorSteps:()=>{i=!1}})}function ke(){if(i)return u=!0,w(void 0);i=!0;let E=Mn(B._readableStreamController);return E===null?wt():He(E._view,!1),w(void 0)}function Q(){if(i)return d=!0,w(void 0);i=!0;let E=Mn(O._readableStreamController);return E===null?wt():He(E._view,!0),w(void 0)}function K(E){if(p=!0,R=E,_){let x=Ut([R,k]),F=he(e,x);L(F)}return U}function ie(E){if(_=!0,k=E,p){let x=Ut([R,k]),F=he(e,x);L(F)}return U}function xe(){}return B=Hs(xe,ke,K),O=Hs(xe,Q,ie),me(r),[B,O]}function uu(e,r){ve(e,r);let i=e,u=i?.autoAllocateChunkSize,d=i?.cancel,p=i?.pull,_=i?.start,R=i?.type;return{autoAllocateChunkSize:u===void 0?void 0:Jo(u,`${r} has member 'autoAllocateChunkSize' that`),cancel:d===void 0?void 0:fu(d,i,`${r} has member 'cancel' that`),pull:p===void 0?void 0:cu(p,i,`${r} has member 'pull' that`),start:_===void 0?void 0:du(_,i,`${r} has member 'start' that`),type:R===void 0?void 0:hu(R,`${r} has member 'type' that`)}}function fu(e,r,i){return ce(e,i),u=>I(e,r,[u])}function cu(e,r,i){return ce(e,i),u=>I(e,r,[u])}function du(e,r,i){return ce(e,i),u=>M(e,r,[u])}function hu(e,r){if(e=`${e}`,e!=="bytes")throw new TypeError(`${r} '${e}' is not a valid enumeration value for ReadableStreamType`);return e}function mu(e,r){ve(e,r);let i=e?.mode;return{mode:i===void 0?void 0:pu(i,`${r} has member 'mode' that`)}}function pu(e,r){if(e=`${e}`,e!=="byob")throw new TypeError(`${r} '${e}' is not a valid enumeration value for ReadableStreamReaderMode`);return e}function _u(e,r){ve(e,r);let i=e?.preventCancel;return{preventCancel:Boolean(i)}}function js(e,r){ve(e,r);let i=e?.preventAbort,u=e?.preventCancel,d=e?.preventClose,p=e?.signal;return p!==void 0&&bu(p,`${r} has member 'signal' that`),{preventAbort:Boolean(i),preventCancel:Boolean(u),preventClose:Boolean(d),signal:p}}function bu(e,r){if(!kl(e))throw new TypeError(`${r} is not an AbortSignal.`)}function yu(e,r){ve(e,r);let i=e?.readable;Bn(i,"readable","ReadableWritablePair"),Ln(i,`${r} has member 'readable' that`);let u=e?.writable;return Bn(u,"writable","ReadableWritablePair"),Es(u,`${r} has member 'writable' that`),{readable:i,writable:u}}class $e{constructor(r={},i={}){r===void 0?r=null:Ko(r,"First parameter");let u=Lr(i,"Second parameter"),d=uu(r,"First parameter");if(ro(this),d.type==="bytes"){if(u.size!==void 0)throw new RangeError("The strategy for a byte stream cannot have a size function");let p=Gt(u,0);Sl(this,d,p)}else{let p=Or(u),_=Gt(u,1);su(this,d,_,p)}}get locked(){if(!ze(this))throw ot("locked");return je(this)}cancel(r=void 0){return ze(this)?je(this)?S(new TypeError("Cannot cancel a stream that already has a reader")):he(this,r):S(ot("cancel"))}getReader(r=void 0){if(!ze(this))throw ot("getReader");return mu(r,"First parameter").mode===void 0?mt(this):Ss(this)}pipeThrough(r,i={}){if(!ze(this))throw ot("pipeThrough");Ae(r,1,"pipeThrough");let u=yu(r,"First parameter"),d=js(i,"Second parameter");if(je(this))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked ReadableStream");if(bt(u.writable))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked WritableStream");let p=Us(this,u.writable,d.preventClose,d.preventAbort,d.preventCancel,d.signal);return q(p),u.readable}pipeTo(r,i={}){if(!ze(this))return S(ot("pipeTo"));if(r===void 0)return S("Parameter 1 is required in 'pipeTo'.");if(!_t(r))return S(new TypeError("ReadableStream.prototype.pipeTo's first argument must be a WritableStream"));let u;try{u=js(i,"Second parameter")}catch(d){return S(d)}return je(this)?S(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked ReadableStream")):bt(r)?S(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked WritableStream")):Us(this,r,u.preventClose,u.preventAbort,u.preventCancel,u.signal)}tee(){if(!ze(this))throw ot("tee");let r=iu(this);return Ut(r)}values(r=void 0){if(!ze(this))throw ot("values");let i=_u(r,"First parameter");return hl(this,i.preventCancel)}}Object.defineProperties($e.prototype,{cancel:{enumerable:!0},getReader:{enumerable:!0},pipeThrough:{enumerable:!0},pipeTo:{enumerable:!0},tee:{enumerable:!0},values:{enumerable:!0},locked:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty($e.prototype,t.toStringTag,{value:"ReadableStream",configurable:!0}),typeof t.asyncIterator=="symbol"&&Object.defineProperty($e.prototype,t.asyncIterator,{value:$e.prototype.values,writable:!0,configurable:!0});function to(e,r,i,u=1,d=()=>1){let p=Object.create($e.prototype);ro(p);let _=Object.create(gt.prototype);return zs(p,_,e,r,i,u,d),p}function Hs(e,r,i){let u=Object.create($e.prototype);ro(u);let d=Object.create(pt.prototype);return gs(u,d,e,r,i,0,void 0),u}function ro(e){e._state="readable",e._reader=void 0,e._storedError=void 0,e._disturbed=!1}function ze(e){return!l(e)||!Object.prototype.hasOwnProperty.call(e,"_readableStreamController")?!1:e instanceof $e}function je(e){return e._reader!==void 0}function he(e,r){if(e._disturbed=!0,e._state==="closed")return w(void 0);if(e._state==="errored")return S(e._storedError);Zt(e);let i=e._reader;i!==void 0&&tt(i)&&(i._readIntoRequests.forEach(d=>{d._closeSteps(void 0)}),i._readIntoRequests=new Y);let u=e._readableStreamController[kn](r);return D(u,n)}function Zt(e){e._state="closed";let r=e._reader;r!==void 0&&(Vo(r),qe(r)&&(r._readRequests.forEach(i=>{i._closeSteps()}),r._readRequests=new Y))}function Gs(e,r){e._state="errored",e._storedError=r;let i=e._reader;i!==void 0&&(An(i,r),qe(i)?(i._readRequests.forEach(u=>{u._errorSteps(r)}),i._readRequests=new Y):(i._readIntoRequests.forEach(u=>{u._errorSteps(r)}),i._readIntoRequests=new Y))}function ot(e){return new TypeError(`ReadableStream.prototype.${e} can only be used on a ReadableStream`)}function Vs(e,r){ve(e,r);let i=e?.highWaterMark;return Bn(i,"highWaterMark","QueuingStrategyInit"),{highWaterMark:On(i)}}let Ys=e=>e.byteLength;Object.defineProperty(Ys,"name",{value:"size",configurable:!0});class Hr{constructor(r){Ae(r,1,"ByteLengthQueuingStrategy"),r=Vs(r,"First parameter"),this._byteLengthQueuingStrategyHighWaterMark=r.highWaterMark}get highWaterMark(){if(!Xs(this))throw Qs("highWaterMark");return this._byteLengthQueuingStrategyHighWaterMark}get size(){if(!Xs(this))throw Qs("size");return Ys}}Object.defineProperties(Hr.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(Hr.prototype,t.toStringTag,{value:"ByteLengthQueuingStrategy",configurable:!0});function Qs(e){return new TypeError(`ByteLengthQueuingStrategy.prototype.${e} can only be used on a ByteLengthQueuingStrategy`)}function Xs(e){return!l(e)||!Object.prototype.hasOwnProperty.call(e,"_byteLengthQueuingStrategyHighWaterMark")?!1:e instanceof Hr}let Ks=()=>1;Object.defineProperty(Ks,"name",{value:"size",configurable:!0});class Gr{constructor(r){Ae(r,1,"CountQueuingStrategy"),r=Vs(r,"First parameter"),this._countQueuingStrategyHighWaterMark=r.highWaterMark}get highWaterMark(){if(!Js(this))throw Zs("highWaterMark");return this._countQueuingStrategyHighWaterMark}get size(){if(!Js(this))throw Zs("size");return Ks}}Object.defineProperties(Gr.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(Gr.prototype,t.toStringTag,{value:"CountQueuingStrategy",configurable:!0});function Zs(e){return new TypeError(`CountQueuingStrategy.prototype.${e} can only be used on a CountQueuingStrategy`)}function Js(e){return!l(e)||!Object.prototype.hasOwnProperty.call(e,"_countQueuingStrategyHighWaterMark")?!1:e instanceof Gr}function gu(e,r){ve(e,r);let i=e?.flush,u=e?.readableType,d=e?.start,p=e?.transform,_=e?.writableType;return{flush:i===void 0?void 0:Su(i,e,`${r} has member 'flush' that`),readableType:u,start:d===void 0?void 0:wu(d,e,`${r} has member 'start' that`),transform:p===void 0?void 0:Ru(p,e,`${r} has member 'transform' that`),writableType:_}}function Su(e,r,i){return ce(e,i),u=>I(e,r,[u])}function wu(e,r,i){return ce(e,i),u=>M(e,r,[u])}function Ru(e,r,i){return ce(e,i),(u,d)=>I(e,r,[u,d])}class Vr{constructor(r={},i={},u={}){r===void 0&&(r=null);let d=Lr(i,"Second parameter"),p=Lr(u,"Third parameter"),_=gu(r,"First parameter");if(_.readableType!==void 0)throw new RangeError("Invalid readableType specified");if(_.writableType!==void 0)throw new RangeError("Invalid writableType specified");let R=Gt(p,0),k=Or(p),B=Gt(d,1),O=Or(d),L,U=g(me=>{L=me});Tu(this,U,B,O,R,k),Cu(this,_),_.start!==void 0?L(_.start(this._transformStreamController)):L(void 0)}get readable(){if(!ei(this))throw oi("readable");return this._readable}get writable(){if(!ei(this))throw oi("writable");return this._writable}}Object.defineProperties(Vr.prototype,{readable:{enumerable:!0},writable:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(Vr.prototype,t.toStringTag,{value:"TransformStream",configurable:!0});function Tu(e,r,i,u,d,p){function _(){return r}function R(U){return Au(e,U)}function k(U){return ku(e,U)}function B(){return xu(e)}e._writable=Ol(_,R,B,k,i,u);function O(){return Bu(e)}function L(U){return Qr(e,U),w(void 0)}e._readable=to(_,O,L,d,p),e._backpressure=void 0,e._backpressureChangePromise=void 0,e._backpressureChangePromise_resolve=void 0,Xr(e,!0),e._transformStreamController=void 0}function ei(e){return!l(e)||!Object.prototype.hasOwnProperty.call(e,"_transformStreamController")?!1:e instanceof Vr}function Yr(e,r){Ue(e._readable._readableStreamController,r),Qr(e,r)}function Qr(e,r){ti(e._transformStreamController),Yn(e._writable._writableStreamController,r),e._backpressure&&Xr(e,!1)}function Xr(e,r){e._backpressureChangePromise!==void 0&&e._backpressureChangePromise_resolve(),e._backpressureChangePromise=g(i=>{e._backpressureChangePromise_resolve=i}),e._backpressure=r}class Jt{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!Kr(this))throw Zr("desiredSize");let r=this._controlledTransformStream._readable._readableStreamController;return eo(r)}enqueue(r=void 0){if(!Kr(this))throw Zr("enqueue");ri(this,r)}error(r=void 0){if(!Kr(this))throw Zr("error");Pu(this,r)}terminate(){if(!Kr(this))throw Zr("terminate");vu(this)}}Object.defineProperties(Jt.prototype,{enqueue:{enumerable:!0},error:{enumerable:!0},terminate:{enumerable:!0},desiredSize:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(Jt.prototype,t.toStringTag,{value:"TransformStreamDefaultController",configurable:!0});function Kr(e){return!l(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledTransformStream")?!1:e instanceof Jt}function Eu(e,r,i,u){r._controlledTransformStream=e,e._transformStreamController=r,r._transformAlgorithm=i,r._flushAlgorithm=u}function Cu(e,r){let i=Object.create(Jt.prototype),u=p=>{try{return ri(i,p),w(void 0)}catch(_){return S(_)}},d=()=>w(void 0);r.transform!==void 0&&(u=p=>r.transform(p,i)),r.flush!==void 0&&(d=()=>r.flush(i)),Eu(e,i,u,d)}function ti(e){e._transformAlgorithm=void 0,e._flushAlgorithm=void 0}function ri(e,r){let i=e._controlledTransformStream,u=i._readable._readableStreamController;if(!St(u))throw new TypeError("Readable side is not in a state that permits enqueue");try{zr(u,r)}catch(p){throw Qr(i,p),i._readable._storedError}ou(u)!==i._backpressure&&Xr(i,!0)}function Pu(e,r){Yr(e._controlledTransformStream,r)}function ni(e,r){let i=e._transformAlgorithm(r);return D(i,void 0,u=>{throw Yr(e._controlledTransformStream,u),u})}function vu(e){let r=e._controlledTransformStream,i=r._readable._readableStreamController;Kt(i);let u=new TypeError("TransformStream terminated");Qr(r,u)}function Au(e,r){let i=e._transformStreamController;if(e._backpressure){let u=e._backpressureChangePromise;return D(u,()=>{let d=e._writable;if(d._state==="erroring")throw d._storedError;return ni(i,r)})}return ni(i,r)}function ku(e,r){return Yr(e,r),w(void 0)}function xu(e){let r=e._readable,i=e._transformStreamController,u=i._flushAlgorithm();return ti(i),D(u,()=>{if(r._state==="errored")throw r._storedError;Kt(r._readableStreamController)},d=>{throw Yr(e,d),r._storedError})}function Bu(e){return Xr(e,!1),e._backpressureChangePromise}function Zr(e){return new TypeError(`TransformStreamDefaultController.prototype.${e} can only be used on a TransformStreamDefaultController`)}function oi(e){return new TypeError(`TransformStream.prototype.${e} can only be used on a TransformStream`)}o.ByteLengthQueuingStrategy=Hr,o.CountQueuingStrategy=Gr,o.ReadableByteStreamController=pt,o.ReadableStream=$e,o.ReadableStreamBYOBReader=Ht,o.ReadableStreamBYOBRequest=$t,o.ReadableStreamDefaultController=gt,o.ReadableStreamDefaultReader=qt,o.TransformStream=Vr,o.TransformStreamDefaultController=Jt,o.WritableStream=Vt,o.WritableStreamDefaultController=yt,o.WritableStreamDefaultWriter=Yt,Object.defineProperty(o,"__esModule",{value:!0})})});var ci=G(()=>{if(!globalThis.ReadableStream)try{let o=require("node:process"),{emitWarning:t}=o;try{o.emitWarning=()=>{},Object.assign(globalThis,require("node:stream/web")),o.emitWarning=t}catch(n){throw o.emitWarning=t,n}}catch{Object.assign(globalThis,fi())}try{let{Blob:o}=require("buffer");o&&!o.prototype.stream&&(o.prototype.stream=function(n){let s=0,a=this;return new ReadableStream({type:"bytes",async pull(l){let m=await a.slice(s,Math.min(a.size,s+65536)).arrayBuffer();s+=m.byteLength,l.enqueue(new Uint8Array(m)),s===a.size&&l.close()}})})}catch{}});async function*oo(o,t=!0){for(let n of o)if("stream"in n)yield*n.stream();else if(ArrayBuffer.isView(n))if(t){let s=n.byteOffset,a=n.byteOffset+n.byteLength;for(;s!==a;){let l=Math.min(a-s,di),f=n.buffer.slice(s,s+l);s+=f.byteLength,yield new Uint8Array(f)}}else yield n;else{let s=0;for(;s!==n.size;){let l=await n.slice(s,Math.min(n.size,s+di)).arrayBuffer();s+=l.byteLength,yield new Uint8Array(l)}}}var Oc,di,hi,qu,it,tr=er(()=>{Oc=st(ci(),1);di=65536;hi=class so{#e=[];#t="";#r=0;constructor(t=[],n={}){if(typeof t!="object"||t===null)throw new TypeError("Failed to construct 'Blob': The provided value cannot be converted to a sequence.");if(typeof t[Symbol.iterator]!="function")throw new TypeError("Failed to construct 'Blob': The object must have a callable @@iterator property.");if(typeof n!="object"&&typeof n!="function")throw new TypeError("Failed to construct 'Blob': parameter 2 cannot convert to dictionary.");n===null&&(n={});let s=new TextEncoder;for(let l of t){let f;ArrayBuffer.isView(l)?f=new Uint8Array(l.buffer.slice(l.byteOffset,l.byteOffset+l.byteLength)):l instanceof ArrayBuffer?f=new Uint8Array(l.slice(0)):l instanceof so?f=l:f=s.encode(l),this.#r+=ArrayBuffer.isView(f)?f.byteLength:f.size,this.#e.push(f)}let a=n.type===void 0?"":String(n.type);this.#t=/^[\x20-\x7E]*$/.test(a)?a:""}get size(){return this.#r}get type(){return this.#t}async text(){let t=new TextDecoder,n="";for await(let s of oo(this.#e,!1))n+=t.decode(s,{stream:!0});return n+=t.decode(),n}async arrayBuffer(){let t=new Uint8Array(this.size),n=0;for await(let s of oo(this.#e,!1))t.set(s,n),n+=s.length;return t.buffer}stream(){let t=oo(this.#e,!0);return new globalThis.ReadableStream({type:"bytes",async pull(n){let s=await t.next();s.done?n.close():n.enqueue(s.value)},async cancel(){await t.return()}})}slice(t=0,n=this.size,s=""){let{size:a}=this,l=t<0?Math.max(a+t,0):Math.min(t,a),f=n<0?Math.max(a+n,0):Math.min(n,a),m=Math.max(f-l,0),c=this.#e,h=[],b=0;for(let w of c){if(b>=m)break;let S=ArrayBuffer.isView(w)?w.byteLength:w.size;if(l&&S<=l)l-=S,f-=S;else{let y;ArrayBuffer.isView(w)?(y=w.subarray(l,Math.min(S,f)),b+=y.byteLength):(y=w.slice(l,Math.min(S,f)),b+=y.size),f-=S,h.push(y),l=0}}let g=new so([],{type:String(s).toLowerCase()});return g.#r=m,g.#e=h,g}get[Symbol.toStringTag](){return"Blob"}static[Symbol.hasInstance](t){return t&&typeof t=="object"&&typeof t.constructor=="function"&&(typeof t.stream=="function"||typeof t.arrayBuffer=="function")&&/^(Blob|File)$/.test(t[Symbol.toStringTag])}};Object.defineProperties(hi.prototype,{size:{enumerable:!0},type:{enumerable:!0},slice:{enumerable:!0}});qu=hi,it=qu});var Mu,Uu,rr,io=er(()=>{tr();Mu=class extends it{#e=0;#t="";constructor(t,n,s={}){if(arguments.length<2)throw new TypeError(`Failed to construct 'File': 2 arguments required, but only ${arguments.length} present.`);super(t,s),s===null&&(s={});let a=s.lastModified===void 0?Date.now():Number(s.lastModified);Number.isNaN(a)||(this.#e=a),this.#t=String(n)}get name(){return this.#t}get lastModified(){return this.#e}get[Symbol.toStringTag](){return"File"}},Uu=Mu,rr=Uu});function _i(o,t=it){var n=`${mi()}${mi()}`.replace(/\./g,"").slice(-28).padStart(32,"-"),s=[],a=`--${n}\r
Content-Disposition: form-data; name="`;return o.forEach((l,f)=>typeof l=="string"?s.push(a+ao(f)+`"\r
\r
${l.replace(/\r(?!\n)|(?<!\r)\n/g,`\r
`)}\r
`):s.push(a+ao(f)+`"; filename="${ao(l.name,1)}"\r
Content-Type: ${l.type||"application/octet-stream"}\r
\r
`,l,`\r
`)),s.push(`--${n}--`),new t(s,{type:"multipart/form-data; boundary="+n})}var nr,$u,zu,mi,ju,pi,ao,at,Ct,lo=er(()=>{tr();io();({toStringTag:nr,iterator:$u,hasInstance:zu}=Symbol),mi=Math.random,ju="append,set,get,getAll,delete,keys,values,entries,forEach,constructor".split(","),pi=(o,t,n)=>(o+="",/^(Blob|File)$/.test(t&&t[nr])?[(n=n!==void 0?n+"":t[nr]=="File"?t.name:"blob",o),t.name!==n||t[nr]=="blob"?new rr([t],n,t):t]:[o,t+""]),ao=(o,t)=>(t?o:o.replace(/\r?\n|\r/g,`\r
`)).replace(/\n/g,"%0A").replace(/\r/g,"%0D").replace(/"/g,"%22"),at=(o,t,n)=>{if(t.length<n)throw new TypeError(`Failed to execute '${o}' on 'FormData': ${n} arguments required, but only ${t.length} present.`)},Ct=class{#e=[];constructor(...t){if(t.length)throw new TypeError("Failed to construct 'FormData': parameter 1 is not of type 'HTMLFormElement'.")}get[nr](){return"FormData"}[$u](){return this.entries()}static[zu](t){return t&&typeof t=="object"&&t[nr]==="FormData"&&!ju.some(n=>typeof t[n]!="function")}append(...t){at("append",arguments,2),this.#e.push(pi(...t))}delete(t){at("delete",arguments,1),t+="",this.#e=this.#e.filter(([n])=>n!==t)}get(t){at("get",arguments,1),t+="";for(var n=this.#e,s=n.length,a=0;a<s;a++)if(n[a][0]===t)return n[a][1];return null}getAll(t,n){return at("getAll",arguments,1),n=[],t+="",this.#e.forEach(s=>s[0]===t&&n.push(s[1])),n}has(t){return at("has",arguments,1),t+="",this.#e.some(n=>n[0]===t)}forEach(t,n){at("forEach",arguments,1);for(var[s,a]of this)t.call(n,a,s,this)}set(...t){at("set",arguments,2);var n=[],s=!0;t=pi(...t),this.#e.forEach(a=>{a[0]===t[0]?s&&(s=!n.push(t)):n.push(a)}),s&&n.push(t),this.#e=n}*entries(){yield*this.#e}*keys(){for(var[t]of this)yield t}*values(){for(var[,t]of this)yield t}}});var sr,yi,Hu,Gu,nn,gi=er(()=>{sr=require("node:fs"),yi=require("node:worker_threads");io();tr();({stat:Hu}=sr.promises),Gu=globalThis.DOMException||(()=>{let o=new yi.MessageChannel().port1,t=new ArrayBuffer(0);try{o.postMessage(t,[t,t])}catch(n){return n.constructor}})(),nn=class{#e;#t;constructor(t){this.#e=t.path,this.#t=t.start,this.size=t.size,this.lastModified=t.lastModified}slice(t,n){return new nn({path:this.#e,lastModified:this.lastModified,size:n-t,start:t})}async*stream(){let{mtimeMs:t}=await Hu(this.#e);if(t>this.lastModified)throw new Gu("The requested file could not be read, typically due to permission problems that have occurred after a reference to a file was acquired.","NotReadableError");yield*(0,sr.createReadStream)(this.#e,{start:this.#t,end:this.#t+this.size-1})}get[Symbol.toStringTag](){return"Blob"}}});var wi={};ii(wi,{toFormData:()=>Ju});function Zu(o){let t=o.match(/\bfilename=("(.*?)"|([^()<>@,;:\\"/[\]?={}\s\t]+))($|;\s)/i);if(!t)return;let n=t[2]||t[3]||"",s=n.slice(n.lastIndexOf("\\")+1);return s=s.replace(/%22/g,'"'),s=s.replace(/&#(\d{4});/g,(a,l)=>String.fromCharCode(l)),s}async function Ju(o,t){if(!/multipart/i.test(t))throw new TypeError("Failed to fetch");let n=t.match(/boundary=(?:"([^"]+)"|([^;]+))/i);if(!n)throw new TypeError("no or bad content-type header, no multipart boundary");let s=new fo(n[1]||n[2]),a,l,f,m,c,h,b=[],g=new Ct,w=A=>{f+=P.decode(A,{stream:!0})},S=A=>{b.push(A)},y=()=>{let A=new rr(b,h,{type:c});g.append(m,A)},T=()=>{g.append(m,f)},P=new TextDecoder("utf-8");P.decode(),s.onPartBegin=function(){s.onPartData=w,s.onPartEnd=T,a="",l="",f="",m="",c="",h=null,b.length=0},s.onHeaderField=function(A){a+=P.decode(A,{stream:!0})},s.onHeaderValue=function(A){l+=P.decode(A,{stream:!0})},s.onHeaderEnd=function(){if(l+=P.decode(),a=a.toLowerCase(),a==="content-disposition"){let A=l.match(/\bname=("([^"]*)"|([^()<>@,;:\\"/[\]?={}\s\t]+))/i);A&&(m=A[2]||A[3]||""),h=Zu(l),h&&(s.onPartData=S,s.onPartEnd=y)}else a==="content-type"&&(c=l);l="",a=""};for await(let A of o)s.write(A);return s.end(),g}var ye,N,Si,Ge,on,sn,Vu,ir,Yu,Qu,Xu,Ku,lt,fo,Ri=er(()=>{gi();lo();ye=0,N={START_BOUNDARY:ye++,HEADER_FIELD_START:ye++,HEADER_FIELD:ye++,HEADER_VALUE_START:ye++,HEADER_VALUE:ye++,HEADER_VALUE_ALMOST_DONE:ye++,HEADERS_ALMOST_DONE:ye++,PART_DATA_START:ye++,PART_DATA:ye++,END:ye++},Si=1,Ge={PART_BOUNDARY:Si,LAST_BOUNDARY:Si*=2},on=10,sn=13,Vu=32,ir=45,Yu=58,Qu=97,Xu=122,Ku=o=>o|32,lt=()=>{},fo=class{constructor(t){this.index=0,this.flags=0,this.onHeaderEnd=lt,this.onHeaderField=lt,this.onHeadersEnd=lt,this.onHeaderValue=lt,this.onPartBegin=lt,this.onPartData=lt,this.onPartEnd=lt,this.boundaryChars={},t=`\r
--`+t;let n=new Uint8Array(t.length);for(let s=0;s<t.length;s++)n[s]=t.charCodeAt(s),this.boundaryChars[n[s]]=!0;this.boundary=n,this.lookbehind=new Uint8Array(this.boundary.length+8),this.state=N.START_BOUNDARY}write(t){let n=0,s=t.length,a=this.index,{lookbehind:l,boundary:f,boundaryChars:m,index:c,state:h,flags:b}=this,g=this.boundary.length,w=g-1,S=t.length,y,T,P=W=>{this[W+"Mark"]=n},A=W=>{delete this[W+"Mark"]},D=(W,M,I,fe)=>{(M===void 0||M!==I)&&this[W](fe&&fe.subarray(M,I))},q=(W,M)=>{let I=W+"Mark";I in this&&(M?(D(W,this[I],n,t),delete this[I]):(D(W,this[I],t.length,t),this[I]=0))};for(n=0;n<s;n++)switch(y=t[n],h){case N.START_BOUNDARY:if(c===f.length-2){if(y===ir)b|=Ge.LAST_BOUNDARY;else if(y!==sn)return;c++;break}else if(c-1===f.length-2){if(b&Ge.LAST_BOUNDARY&&y===ir)h=N.END,b=0;else if(!(b&Ge.LAST_BOUNDARY)&&y===on)c=0,D("onPartBegin"),h=N.HEADER_FIELD_START;else return;break}y!==f[c+2]&&(c=-2),y===f[c+2]&&c++;break;case N.HEADER_FIELD_START:h=N.HEADER_FIELD,P("onHeaderField"),c=0;case N.HEADER_FIELD:if(y===sn){A("onHeaderField"),h=N.HEADERS_ALMOST_DONE;break}if(c++,y===ir)break;if(y===Yu){if(c===1)return;q("onHeaderField",!0),h=N.HEADER_VALUE_START;break}if(T=Ku(y),T<Qu||T>Xu)return;break;case N.HEADER_VALUE_START:if(y===Vu)break;P("onHeaderValue"),h=N.HEADER_VALUE;case N.HEADER_VALUE:y===sn&&(q("onHeaderValue",!0),D("onHeaderEnd"),h=N.HEADER_VALUE_ALMOST_DONE);break;case N.HEADER_VALUE_ALMOST_DONE:if(y!==on)return;h=N.HEADER_FIELD_START;break;case N.HEADERS_ALMOST_DONE:if(y!==on)return;D("onHeadersEnd"),h=N.PART_DATA_START;break;case N.PART_DATA_START:h=N.PART_DATA,P("onPartData");case N.PART_DATA:if(a=c,c===0){for(n+=w;n<S&&!(t[n]in m);)n+=g;n-=w,y=t[n]}if(c<f.length)f[c]===y?(c===0&&q("onPartData",!0),c++):c=0;else if(c===f.length)c++,y===sn?b|=Ge.PART_BOUNDARY:y===ir?b|=Ge.LAST_BOUNDARY:c=0;else if(c-1===f.length)if(b&Ge.PART_BOUNDARY){if(c=0,y===on){b&=~Ge.PART_BOUNDARY,D("onPartEnd"),D("onPartBegin"),h=N.HEADER_FIELD_START;break}}else b&Ge.LAST_BOUNDARY&&y===ir?(D("onPartEnd"),h=N.END,b=0):c=0;if(c>0)l[c-1]=y;else if(a>0){let W=new Uint8Array(l.buffer,l.byteOffset,l.byteLength);D("onPartData",0,a,W),a=0,P("onPartData"),n--}break;case N.END:break;default:throw new Error(`Unexpected state entered: ${h}`)}q("onHeaderField"),q("onHeaderValue"),q("onPartData"),this.index=c,this.state=h,this.flags=b}end(){if(this.state===N.HEADER_FIELD_START&&this.index===0||this.state===N.PART_DATA&&this.index===this.boundary.length)this.onPartEnd();else if(this.state!==N.END)throw new Error("MultipartParser.end(): stream ended unexpectedly")}}});var Qe=G((Id,Hi)=>{"use strict";Hi.exports={BINARY_TYPES:["nodebuffer","arraybuffer","fragments"],EMPTY_BUFFER:Buffer.alloc(0),GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",kForOnEventAttribute:Symbol("kIsForOnEventAttribute"),kListener:Symbol("kListener"),kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),NOOP:()=>{}}});var cr=G((Fd,go)=>{"use strict";var{EMPTY_BUFFER:cf}=Qe();function Gi(o,t){if(o.length===0)return cf;if(o.length===1)return o[0];let n=Buffer.allocUnsafe(t),s=0;for(let a=0;a<o.length;a++){let l=o[a];n.set(l,s),s+=l.length}return s<t?n.slice(0,s):n}function Vi(o,t,n,s,a){for(let l=0;l<a;l++)n[s+l]=o[l]^t[l&3]}function Yi(o,t){for(let n=0;n<o.length;n++)o[n]^=t[n&3]}function Qi(o){return o.byteLength===o.buffer.byteLength?o.buffer:o.buffer.slice(o.byteOffset,o.byteOffset+o.byteLength)}function mn(o){if(mn.readOnly=!0,Buffer.isBuffer(o))return o;let t;return o instanceof ArrayBuffer?t=Buffer.from(o):ArrayBuffer.isView(o)?t=Buffer.from(o.buffer,o.byteOffset,o.byteLength):(t=Buffer.from(o),mn.readOnly=!1),t}try{let o=require("bufferutil");go.exports={concat:Gi,mask(t,n,s,a,l){l<48?Vi(t,n,s,a,l):o.mask(t,n,s,a,l)},toArrayBuffer:Qi,toBuffer:mn,unmask(t,n){t.length<32?Yi(t,n):o.unmask(t,n)}}}catch{go.exports={concat:Gi,mask:Vi,toArrayBuffer:Qi,toBuffer:mn,unmask:Yi}}});var Zi=G((Nd,Ki)=>{"use strict";var Xi=Symbol("kDone"),So=Symbol("kRun"),wo=class{constructor(t){this[Xi]=()=>{this.pending--,this[So]()},this.concurrency=t||1/0,this.jobs=[],this.pending=0}add(t){this.jobs.push(t),this[So]()}[So](){if(this.pending!==this.concurrency&&this.jobs.length){let t=this.jobs.shift();this.pending++,t(this[Xi])}}};Ki.exports=wo});var mr=G((qd,ra)=>{"use strict";var dr=require("zlib"),Ji=cr(),df=Zi(),{kStatusCode:ea}=Qe(),hf=Buffer.from([0,0,255,255]),bn=Symbol("permessage-deflate"),Le=Symbol("total-length"),hr=Symbol("callback"),Xe=Symbol("buffers"),_n=Symbol("error"),pn,Ro=class{constructor(t,n,s){if(this._maxPayload=s|0,this._options=t||{},this._threshold=this._options.threshold!==void 0?this._options.threshold:1024,this._isServer=!!n,this._deflate=null,this._inflate=null,this.params=null,!pn){let a=this._options.concurrencyLimit!==void 0?this._options.concurrencyLimit:10;pn=new df(a)}}static get extensionName(){return"permessage-deflate"}offer(){let t={};return this._options.serverNoContextTakeover&&(t.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(t.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(t.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?t.client_max_window_bits=this._options.clientMaxWindowBits:this._options.clientMaxWindowBits==null&&(t.client_max_window_bits=!0),t}accept(t){return t=this.normalizeParams(t),this.params=this._isServer?this.acceptAsServer(t):this.acceptAsClient(t),this.params}cleanup(){if(this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate){let t=this._deflate[hr];this._deflate.close(),this._deflate=null,t&&t(new Error("The deflate stream was closed while data was being processed"))}}acceptAsServer(t){let n=this._options,s=t.find(a=>!(n.serverNoContextTakeover===!1&&a.server_no_context_takeover||a.server_max_window_bits&&(n.serverMaxWindowBits===!1||typeof n.serverMaxWindowBits=="number"&&n.serverMaxWindowBits>a.server_max_window_bits)||typeof n.clientMaxWindowBits=="number"&&!a.client_max_window_bits));if(!s)throw new Error("None of the extension offers can be accepted");return n.serverNoContextTakeover&&(s.server_no_context_takeover=!0),n.clientNoContextTakeover&&(s.client_no_context_takeover=!0),typeof n.serverMaxWindowBits=="number"&&(s.server_max_window_bits=n.serverMaxWindowBits),typeof n.clientMaxWindowBits=="number"?s.client_max_window_bits=n.clientMaxWindowBits:(s.client_max_window_bits===!0||n.clientMaxWindowBits===!1)&&delete s.client_max_window_bits,s}acceptAsClient(t){let n=t[0];if(this._options.clientNoContextTakeover===!1&&n.client_no_context_takeover)throw new Error('Unexpected parameter "client_no_context_takeover"');if(!n.client_max_window_bits)typeof this._options.clientMaxWindowBits=="number"&&(n.client_max_window_bits=this._options.clientMaxWindowBits);else if(this._options.clientMaxWindowBits===!1||typeof this._options.clientMaxWindowBits=="number"&&n.client_max_window_bits>this._options.clientMaxWindowBits)throw new Error('Unexpected or invalid parameter "client_max_window_bits"');return n}normalizeParams(t){return t.forEach(n=>{Object.keys(n).forEach(s=>{let a=n[s];if(a.length>1)throw new Error(`Parameter "${s}" must have only a single value`);if(a=a[0],s==="client_max_window_bits"){if(a!==!0){let l=+a;if(!Number.isInteger(l)||l<8||l>15)throw new TypeError(`Invalid value for parameter "${s}": ${a}`);a=l}else if(!this._isServer)throw new TypeError(`Invalid value for parameter "${s}": ${a}`)}else if(s==="server_max_window_bits"){let l=+a;if(!Number.isInteger(l)||l<8||l>15)throw new TypeError(`Invalid value for parameter "${s}": ${a}`);a=l}else if(s==="client_no_context_takeover"||s==="server_no_context_takeover"){if(a!==!0)throw new TypeError(`Invalid value for parameter "${s}": ${a}`)}else throw new Error(`Unknown parameter "${s}"`);n[s]=a})}),t}decompress(t,n,s){pn.add(a=>{this._decompress(t,n,(l,f)=>{a(),s(l,f)})})}compress(t,n,s){pn.add(a=>{this._compress(t,n,(l,f)=>{a(),s(l,f)})})}_decompress(t,n,s){let a=this._isServer?"client":"server";if(!this._inflate){let l=`${a}_max_window_bits`,f=typeof this.params[l]!="number"?dr.Z_DEFAULT_WINDOWBITS:this.params[l];this._inflate=dr.createInflateRaw({...this._options.zlibInflateOptions,windowBits:f}),this._inflate[bn]=this,this._inflate[Le]=0,this._inflate[Xe]=[],this._inflate.on("error",pf),this._inflate.on("data",ta)}this._inflate[hr]=s,this._inflate.write(t),n&&this._inflate.write(hf),this._inflate.flush(()=>{let l=this._inflate[_n];if(l){this._inflate.close(),this._inflate=null,s(l);return}let f=Ji.concat(this._inflate[Xe],this._inflate[Le]);this._inflate._readableState.endEmitted?(this._inflate.close(),this._inflate=null):(this._inflate[Le]=0,this._inflate[Xe]=[],n&&this.params[`${a}_no_context_takeover`]&&this._inflate.reset()),s(null,f)})}_compress(t,n,s){let a=this._isServer?"server":"client";if(!this._deflate){let l=`${a}_max_window_bits`,f=typeof this.params[l]!="number"?dr.Z_DEFAULT_WINDOWBITS:this.params[l];this._deflate=dr.createDeflateRaw({...this._options.zlibDeflateOptions,windowBits:f}),this._deflate[Le]=0,this._deflate[Xe]=[],this._deflate.on("data",mf)}this._deflate[hr]=s,this._deflate.write(t),this._deflate.flush(dr.Z_SYNC_FLUSH,()=>{if(!this._deflate)return;let l=Ji.concat(this._deflate[Xe],this._deflate[Le]);n&&(l=l.slice(0,l.length-4)),this._deflate[hr]=null,this._deflate[Le]=0,this._deflate[Xe]=[],n&&this.params[`${a}_no_context_takeover`]&&this._deflate.reset(),s(null,l)})}};ra.exports=Ro;function mf(o){this[Xe].push(o),this[Le]+=o.length}function ta(o){if(this[Le]+=o.length,this[bn]._maxPayload<1||this[Le]<=this[bn]._maxPayload){this[Xe].push(o);return}this[_n]=new RangeError("Max payload size exceeded"),this[_n].code="WS_ERR_UNSUPPORTED_MESSAGE_LENGTH",this[_n][ea]=1009,this.removeListener("data",ta),this.reset()}function pf(o){this[bn]._inflate=null,o[ea]=1007,this[hr](o)}});var pr=G((Md,To)=>{"use strict";var na=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0];function oa(o){return o>=1e3&&o<=1014&&o!==1004&&o!==1005&&o!==1006||o>=3e3&&o<=4999}function sa(o){let t=o.length,n=0;for(;n<t;)if((o[n]&128)===0)n++;else if((o[n]&224)===192){if(n+1===t||(o[n+1]&192)!==128||(o[n]&254)===192)return!1;n+=2}else if((o[n]&240)===224){if(n+2>=t||(o[n+1]&192)!==128||(o[n+2]&192)!==128||o[n]===224&&(o[n+1]&224)===128||o[n]===237&&(o[n+1]&224)===160)return!1;n+=3}else if((o[n]&248)===240){if(n+3>=t||(o[n+1]&192)!==128||(o[n+2]&192)!==128||(o[n+3]&192)!==128||o[n]===240&&(o[n+1]&240)===128||o[n]===244&&o[n+1]>143||o[n]>244)return!1;n+=4}else return!1;return!0}try{let o=require("utf-8-validate");To.exports={isValidStatusCode:oa,isValidUTF8(t){return t.length<150?sa(t):o(t)},tokenChars:na}}catch{To.exports={isValidStatusCode:oa,isValidUTF8:sa,tokenChars:na}}});var vo=G((Ud,da)=>{"use strict";var{Writable:_f}=require("stream"),ia=mr(),{BINARY_TYPES:bf,EMPTY_BUFFER:aa,kStatusCode:yf,kWebSocket:gf}=Qe(),{concat:Eo,toArrayBuffer:Sf,unmask:wf}=cr(),{isValidStatusCode:Rf,isValidUTF8:la}=pr(),_r=0,ua=1,fa=2,ca=3,Co=4,Tf=5,Po=class extends _f{constructor(t={}){super(),this._binaryType=t.binaryType||bf[0],this._extensions=t.extensions||{},this._isServer=!!t.isServer,this._maxPayload=t.maxPayload|0,this._skipUTF8Validation=!!t.skipUTF8Validation,this[gf]=void 0,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._state=_r,this._loop=!1}_write(t,n,s){if(this._opcode===8&&this._state==_r)return s();this._bufferedBytes+=t.length,this._buffers.push(t),this.startLoop(s)}consume(t){if(this._bufferedBytes-=t,t===this._buffers[0].length)return this._buffers.shift();if(t<this._buffers[0].length){let s=this._buffers[0];return this._buffers[0]=s.slice(t),s.slice(0,t)}let n=Buffer.allocUnsafe(t);do{let s=this._buffers[0],a=n.length-t;t>=s.length?n.set(this._buffers.shift(),a):(n.set(new Uint8Array(s.buffer,s.byteOffset,t),a),this._buffers[0]=s.slice(t)),t-=s.length}while(t>0);return n}startLoop(t){let n;this._loop=!0;do switch(this._state){case _r:n=this.getInfo();break;case ua:n=this.getPayloadLength16();break;case fa:n=this.getPayloadLength64();break;case ca:this.getMask();break;case Co:n=this.getData(t);break;default:this._loop=!1;return}while(this._loop);t(n)}getInfo(){if(this._bufferedBytes<2){this._loop=!1;return}let t=this.consume(2);if((t[0]&48)!==0)return this._loop=!1,$(RangeError,"RSV2 and RSV3 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_2_3");let n=(t[0]&64)===64;if(n&&!this._extensions[ia.extensionName])return this._loop=!1,$(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(this._fin=(t[0]&128)===128,this._opcode=t[0]&15,this._payloadLength=t[1]&127,this._opcode===0){if(n)return this._loop=!1,$(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(!this._fragmented)return this._loop=!1,$(RangeError,"invalid opcode 0",!0,1002,"WS_ERR_INVALID_OPCODE");this._opcode=this._fragmented}else if(this._opcode===1||this._opcode===2){if(this._fragmented)return this._loop=!1,$(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");this._compressed=n}else if(this._opcode>7&&this._opcode<11){if(!this._fin)return this._loop=!1,$(RangeError,"FIN must be set",!0,1002,"WS_ERR_EXPECTED_FIN");if(n)return this._loop=!1,$(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(this._payloadLength>125)return this._loop=!1,$(RangeError,`invalid payload length ${this._payloadLength}`,!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH")}else return this._loop=!1,$(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");if(!this._fin&&!this._fragmented&&(this._fragmented=this._opcode),this._masked=(t[1]&128)===128,this._isServer){if(!this._masked)return this._loop=!1,$(RangeError,"MASK must be set",!0,1002,"WS_ERR_EXPECTED_MASK")}else if(this._masked)return this._loop=!1,$(RangeError,"MASK must be clear",!0,1002,"WS_ERR_UNEXPECTED_MASK");if(this._payloadLength===126)this._state=ua;else if(this._payloadLength===127)this._state=fa;else return this.haveLength()}getPayloadLength16(){if(this._bufferedBytes<2){this._loop=!1;return}return this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength()}getPayloadLength64(){if(this._bufferedBytes<8){this._loop=!1;return}let t=this.consume(8),n=t.readUInt32BE(0);return n>Math.pow(2,53-32)-1?(this._loop=!1,$(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009,"WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH")):(this._payloadLength=n*Math.pow(2,32)+t.readUInt32BE(4),this.haveLength())}haveLength(){if(this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0))return this._loop=!1,$(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH");this._masked?this._state=ca:this._state=Co}getMask(){if(this._bufferedBytes<4){this._loop=!1;return}this._mask=this.consume(4),this._state=Co}getData(t){let n=aa;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength){this._loop=!1;return}n=this.consume(this._payloadLength),this._masked&&(this._mask[0]|this._mask[1]|this._mask[2]|this._mask[3])!==0&&wf(n,this._mask)}if(this._opcode>7)return this.controlMessage(n);if(this._compressed){this._state=Tf,this.decompress(n,t);return}return n.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(n)),this.dataMessage()}decompress(t,n){this._extensions[ia.extensionName].decompress(t,this._fin,(a,l)=>{if(a)return n(a);if(l.length){if(this._messageLength+=l.length,this._messageLength>this._maxPayload&&this._maxPayload>0)return n($(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH"));this._fragments.push(l)}let f=this.dataMessage();if(f)return n(f);this.startLoop(n)})}dataMessage(){if(this._fin){let t=this._messageLength,n=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],this._opcode===2){let s;this._binaryType==="nodebuffer"?s=Eo(n,t):this._binaryType==="arraybuffer"?s=Sf(Eo(n,t)):s=n,this.emit("message",s,!0)}else{let s=Eo(n,t);if(!this._skipUTF8Validation&&!la(s))return this._loop=!1,$(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");this.emit("message",s,!1)}}this._state=_r}controlMessage(t){if(this._opcode===8)if(this._loop=!1,t.length===0)this.emit("conclude",1005,aa),this.end();else{if(t.length===1)return $(RangeError,"invalid payload length 1",!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH");{let n=t.readUInt16BE(0);if(!Rf(n))return $(RangeError,`invalid status code ${n}`,!0,1002,"WS_ERR_INVALID_CLOSE_CODE");let s=t.slice(2);if(!this._skipUTF8Validation&&!la(s))return $(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");this.emit("conclude",n,s),this.end()}}else this._opcode===9?this.emit("ping",t):this.emit("pong",t);this._state=_r}};da.exports=Po;function $(o,t,n,s,a){let l=new o(n?`Invalid WebSocket frame: ${t}`:t);return Error.captureStackTrace(l,$),l.code=a,l[yf]=s,l}});var Ao=G((jd,pa)=>{"use strict";var $d=require("net"),zd=require("tls"),{randomFillSync:Ef}=require("crypto"),ha=mr(),{EMPTY_BUFFER:Cf}=Qe(),{isValidStatusCode:Pf}=pr(),{mask:ma,toBuffer:De}=cr(),vf=Buffer.alloc(4),we=class{constructor(t,n,s){this._extensions=n||{},s&&(this._generateMask=s,this._maskBuffer=Buffer.alloc(4)),this._socket=t,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._deflating=!1,this._queue=[]}static frame(t,n){let s,a=!1,l=2,f=!1;n.mask&&(s=n.maskBuffer||vf,n.generateMask?n.generateMask(s):Ef(s,0,4),f=(s[0]|s[1]|s[2]|s[3])===0,n.readOnly&&!f&&(a=!0),l=6);let m=t.length;t.length>=65536?(l+=8,m=127):t.length>125&&(l+=2,m=126);let c=Buffer.allocUnsafe(a?t.length+l:l);return c[0]=n.fin?n.opcode|128:n.opcode,n.rsv1&&(c[0]|=64),c[1]=m,m===126?c.writeUInt16BE(t.length,2):m===127&&(c[2]=c[3]=0,c.writeUIntBE(t.length,4,6)),n.mask?(c[1]|=128,c[l-4]=s[0],c[l-3]=s[1],c[l-2]=s[2],c[l-1]=s[3],f?[c,t]:a?(ma(t,s,c,l,t.length),[c]):(ma(t,s,t,0,t.length),[c,t])):[c,t]}close(t,n,s,a){let l;if(t===void 0)l=Cf;else{if(typeof t!="number"||!Pf(t))throw new TypeError("First argument must be a valid error code number");if(n===void 0||!n.length)l=Buffer.allocUnsafe(2),l.writeUInt16BE(t,0);else{let f=Buffer.byteLength(n);if(f>123)throw new RangeError("The message must not be greater than 123 bytes");l=Buffer.allocUnsafe(2+f),l.writeUInt16BE(t,0),typeof n=="string"?l.write(n,2):l.set(n,2)}}this._deflating?this.enqueue([this.doClose,l,s,a]):this.doClose(l,s,a)}doClose(t,n,s){this.sendFrame(we.frame(t,{fin:!0,rsv1:!1,opcode:8,mask:n,maskBuffer:this._maskBuffer,generateMask:this._generateMask,readOnly:!1}),s)}ping(t,n,s){let a=De(t);if(a.length>125)throw new RangeError("The data size must not be greater than 125 bytes");this._deflating?this.enqueue([this.doPing,a,n,De.readOnly,s]):this.doPing(a,n,De.readOnly,s)}doPing(t,n,s,a){this.sendFrame(we.frame(t,{fin:!0,rsv1:!1,opcode:9,mask:n,maskBuffer:this._maskBuffer,generateMask:this._generateMask,readOnly:s}),a)}pong(t,n,s){let a=De(t);if(a.length>125)throw new RangeError("The data size must not be greater than 125 bytes");this._deflating?this.enqueue([this.doPong,a,n,De.readOnly,s]):this.doPong(a,n,De.readOnly,s)}doPong(t,n,s,a){this.sendFrame(we.frame(t,{fin:!0,rsv1:!1,opcode:10,mask:n,maskBuffer:this._maskBuffer,generateMask:this._generateMask,readOnly:s}),a)}send(t,n,s){let a=De(t),l=this._extensions[ha.extensionName],f=n.binary?2:1,m=n.compress;if(this._firstFragment?(this._firstFragment=!1,m&&l&&l.params[l._isServer?"server_no_context_takeover":"client_no_context_takeover"]&&(m=a.length>=l._threshold),this._compress=m):(m=!1,f=0),n.fin&&(this._firstFragment=!0),l){let c={fin:n.fin,rsv1:m,opcode:f,mask:n.mask,maskBuffer:this._maskBuffer,generateMask:this._generateMask,readOnly:De.readOnly};this._deflating?this.enqueue([this.dispatch,a,this._compress,c,s]):this.dispatch(a,this._compress,c,s)}else this.sendFrame(we.frame(a,{fin:n.fin,rsv1:!1,opcode:f,mask:n.mask,maskBuffer:this._maskBuffer,generateMask:this._generateMask,readOnly:De.readOnly}),s)}dispatch(t,n,s,a){if(!n){this.sendFrame(we.frame(t,s),a);return}let l=this._extensions[ha.extensionName];this._bufferedBytes+=t.length,this._deflating=!0,l.compress(t,s.fin,(f,m)=>{if(this._socket.destroyed){let c=new Error("The socket was closed while data was being compressed");typeof a=="function"&&a(c);for(let h=0;h<this._queue.length;h++){let b=this._queue[h][4];typeof b=="function"&&b(c)}return}this._bufferedBytes-=t.length,this._deflating=!1,s.readOnly=!1,this.sendFrame(we.frame(m,s),a),this.dequeue()})}dequeue(){for(;!this._deflating&&this._queue.length;){let t=this._queue.shift();this._bufferedBytes-=t[1].length,Reflect.apply(t[0],this,t.slice(1))}}enqueue(t){this._bufferedBytes+=t[1].length,this._queue.push(t)}sendFrame(t,n){t.length===2?(this._socket.cork(),this._socket.write(t[0]),this._socket.write(t[1],n),this._socket.uncork()):this._socket.write(t[0],n)}};pa.exports=we});var Ca=G((Hd,Ea)=>{"use strict";var{kForOnEventAttribute:ko,kListener:_a}=Qe(),ba=Symbol("kCode"),ya=Symbol("kData"),ga=Symbol("kError"),Sa=Symbol("kMessage"),wa=Symbol("kReason"),Ot=Symbol("kTarget"),Ra=Symbol("kType"),Ta=Symbol("kWasClean"),We=class{constructor(t){this[Ot]=null,this[Ra]=t}get target(){return this[Ot]}get type(){return this[Ra]}};Object.defineProperty(We.prototype,"target",{enumerable:!0});Object.defineProperty(We.prototype,"type",{enumerable:!0});var ft=class extends We{constructor(t,n={}){super(t),this[ba]=n.code===void 0?0:n.code,this[wa]=n.reason===void 0?"":n.reason,this[Ta]=n.wasClean===void 0?!1:n.wasClean}get code(){return this[ba]}get reason(){return this[wa]}get wasClean(){return this[Ta]}};Object.defineProperty(ft.prototype,"code",{enumerable:!0});Object.defineProperty(ft.prototype,"reason",{enumerable:!0});Object.defineProperty(ft.prototype,"wasClean",{enumerable:!0});var Lt=class extends We{constructor(t,n={}){super(t),this[ga]=n.error===void 0?null:n.error,this[Sa]=n.message===void 0?"":n.message}get error(){return this[ga]}get message(){return this[Sa]}};Object.defineProperty(Lt.prototype,"error",{enumerable:!0});Object.defineProperty(Lt.prototype,"message",{enumerable:!0});var br=class extends We{constructor(t,n={}){super(t),this[ya]=n.data===void 0?null:n.data}get data(){return this[ya]}};Object.defineProperty(br.prototype,"data",{enumerable:!0});var Af={addEventListener(o,t,n={}){let s;if(o==="message")s=function(l,f){let m=new br("message",{data:f?l:l.toString()});m[Ot]=this,t.call(this,m)};else if(o==="close")s=function(l,f){let m=new ft("close",{code:l,reason:f.toString(),wasClean:this._closeFrameReceived&&this._closeFrameSent});m[Ot]=this,t.call(this,m)};else if(o==="error")s=function(l){let f=new Lt("error",{error:l,message:l.message});f[Ot]=this,t.call(this,f)};else if(o==="open")s=function(){let l=new We("open");l[Ot]=this,t.call(this,l)};else return;s[ko]=!!n[ko],s[_a]=t,n.once?this.once(o,s):this.on(o,s)},removeEventListener(o,t){for(let n of this.listeners(o))if(n[_a]===t&&!n[ko]){this.removeListener(o,n);break}}};Ea.exports={CloseEvent:ft,ErrorEvent:Lt,Event:We,EventTarget:Af,MessageEvent:br}});var xo=G((Gd,Pa)=>{"use strict";var{tokenChars:yr}=pr();function Re(o,t,n){o[t]===void 0?o[t]=[n]:o[t].push(n)}function kf(o){let t=Object.create(null),n=Object.create(null),s=!1,a=!1,l=!1,f,m,c=-1,h=-1,b=-1,g=0;for(;g<o.length;g++)if(h=o.charCodeAt(g),f===void 0)if(b===-1&&yr[h]===1)c===-1&&(c=g);else if(g!==0&&(h===32||h===9))b===-1&&c!==-1&&(b=g);else if(h===59||h===44){if(c===-1)throw new SyntaxError(`Unexpected character at index ${g}`);b===-1&&(b=g);let S=o.slice(c,b);h===44?(Re(t,S,n),n=Object.create(null)):f=S,c=b=-1}else throw new SyntaxError(`Unexpected character at index ${g}`);else if(m===void 0)if(b===-1&&yr[h]===1)c===-1&&(c=g);else if(h===32||h===9)b===-1&&c!==-1&&(b=g);else if(h===59||h===44){if(c===-1)throw new SyntaxError(`Unexpected character at index ${g}`);b===-1&&(b=g),Re(n,o.slice(c,b),!0),h===44&&(Re(t,f,n),n=Object.create(null),f=void 0),c=b=-1}else if(h===61&&c!==-1&&b===-1)m=o.slice(c,g),c=b=-1;else throw new SyntaxError(`Unexpected character at index ${g}`);else if(a){if(yr[h]!==1)throw new SyntaxError(`Unexpected character at index ${g}`);c===-1?c=g:s||(s=!0),a=!1}else if(l)if(yr[h]===1)c===-1&&(c=g);else if(h===34&&c!==-1)l=!1,b=g;else if(h===92)a=!0;else throw new SyntaxError(`Unexpected character at index ${g}`);else if(h===34&&o.charCodeAt(g-1)===61)l=!0;else if(b===-1&&yr[h]===1)c===-1&&(c=g);else if(c!==-1&&(h===32||h===9))b===-1&&(b=g);else if(h===59||h===44){if(c===-1)throw new SyntaxError(`Unexpected character at index ${g}`);b===-1&&(b=g);let S=o.slice(c,b);s&&(S=S.replace(/\\/g,""),s=!1),Re(n,m,S),h===44&&(Re(t,f,n),n=Object.create(null),f=void 0),m=void 0,c=b=-1}else throw new SyntaxError(`Unexpected character at index ${g}`);if(c===-1||l||h===32||h===9)throw new SyntaxError("Unexpected end of input");b===-1&&(b=g);let w=o.slice(c,b);return f===void 0?Re(t,w,n):(m===void 0?Re(n,w,!0):s?Re(n,m,w.replace(/\\/g,"")):Re(n,m,w),Re(t,f,n)),t}function xf(o){return Object.keys(o).map(t=>{let n=o[t];return Array.isArray(n)||(n=[n]),n.map(s=>[t].concat(Object.keys(s).map(a=>{let l=s[a];return Array.isArray(l)||(l=[l]),l.map(f=>f===!0?a:`${a}=${f}`).join("; ")})).join("; ")).join(", ")}).join(", ")}Pa.exports={format:xf,parse:kf}});var Io=G((Yd,Ia)=>{"use strict";var Bf=require("events"),Of=require("https"),Lf=require("http"),ka=require("net"),Df=require("tls"),{randomBytes:Wf,createHash:If}=require("crypto"),{Readable:Vd}=require("stream"),{URL:Bo}=require("url"),Ke=mr(),Ff=vo(),Nf=Ao(),{BINARY_TYPES:va,EMPTY_BUFFER:yn,GUID:qf,kForOnEventAttribute:Oo,kListener:Mf,kStatusCode:Uf,kWebSocket:V,NOOP:xa}=Qe(),{EventTarget:{addEventListener:$f,removeEventListener:zf}}=Ca(),{format:jf,parse:Hf}=xo(),{toBuffer:Gf}=cr(),Ie=["CONNECTING","OPEN","CLOSING","CLOSED"],Vf=/^[!#$%&'*+\-.0-9A-Z^_`|a-z~]+$/,Lo=[8,13],Yf=30*1e3,v=class extends Bf{constructor(t,n,s){super(),this._binaryType=va[0],this._closeCode=1006,this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage=yn,this._closeTimer=null,this._extensions={},this._paused=!1,this._protocol="",this._readyState=v.CONNECTING,this._receiver=null,this._sender=null,this._socket=null,t!==null?(this._bufferedAmount=0,this._isServer=!1,this._redirects=0,n===void 0?n=[]:Array.isArray(n)||(typeof n=="object"&&n!==null?(s=n,n=[]):n=[n]),Ba(this,t,n,s)):this._isServer=!0}get binaryType(){return this._binaryType}set binaryType(t){!va.includes(t)||(this._binaryType=t,this._receiver&&(this._receiver._binaryType=t))}get bufferedAmount(){return this._socket?this._socket._writableState.length+this._sender._bufferedBytes:this._bufferedAmount}get extensions(){return Object.keys(this._extensions).join()}get isPaused(){return this._paused}get onclose(){return null}get onerror(){return null}get onopen(){return null}get onmessage(){return null}get protocol(){return this._protocol}get readyState(){return this._readyState}get url(){return this._url}setSocket(t,n,s){let a=new Ff({binaryType:this.binaryType,extensions:this._extensions,isServer:this._isServer,maxPayload:s.maxPayload,skipUTF8Validation:s.skipUTF8Validation});this._sender=new Nf(t,this._extensions,s.generateMask),this._receiver=a,this._socket=t,a[V]=this,t[V]=this,a.on("conclude",Kf),a.on("drain",Zf),a.on("error",Jf),a.on("message",ec),a.on("ping",tc),a.on("pong",rc),t.setTimeout(0),t.setNoDelay(),n.length>0&&t.unshift(n),t.on("close",La),t.on("data",gn),t.on("end",Da),t.on("error",Wa),this._readyState=v.OPEN,this.emit("open")}emitClose(){if(!this._socket){this._readyState=v.CLOSED,this.emit("close",this._closeCode,this._closeMessage);return}this._extensions[Ke.extensionName]&&this._extensions[Ke.extensionName].cleanup(),this._receiver.removeAllListeners(),this._readyState=v.CLOSED,this.emit("close",this._closeCode,this._closeMessage)}close(t,n){if(this.readyState!==v.CLOSED){if(this.readyState===v.CONNECTING){let s="WebSocket was closed before the connection was established";return ae(this,this._req,s)}if(this.readyState===v.CLOSING){this._closeFrameSent&&(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end();return}this._readyState=v.CLOSING,this._sender.close(t,n,!this._isServer,s=>{s||(this._closeFrameSent=!0,(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end())}),this._closeTimer=setTimeout(this._socket.destroy.bind(this._socket),Yf)}}pause(){this.readyState===v.CONNECTING||this.readyState===v.CLOSED||(this._paused=!0,this._socket.pause())}ping(t,n,s){if(this.readyState===v.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof t=="function"?(s=t,t=n=void 0):typeof n=="function"&&(s=n,n=void 0),typeof t=="number"&&(t=t.toString()),this.readyState!==v.OPEN){Wo(this,t,s);return}n===void 0&&(n=!this._isServer),this._sender.ping(t||yn,n,s)}pong(t,n,s){if(this.readyState===v.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof t=="function"?(s=t,t=n=void 0):typeof n=="function"&&(s=n,n=void 0),typeof t=="number"&&(t=t.toString()),this.readyState!==v.OPEN){Wo(this,t,s);return}n===void 0&&(n=!this._isServer),this._sender.pong(t||yn,n,s)}resume(){this.readyState===v.CONNECTING||this.readyState===v.CLOSED||(this._paused=!1,this._receiver._writableState.needDrain||this._socket.resume())}send(t,n,s){if(this.readyState===v.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof n=="function"&&(s=n,n={}),typeof t=="number"&&(t=t.toString()),this.readyState!==v.OPEN){Wo(this,t,s);return}let a={binary:typeof t!="string",mask:!this._isServer,compress:!0,fin:!0,...n};this._extensions[Ke.extensionName]||(a.compress=!1),this._sender.send(t||yn,a,s)}terminate(){if(this.readyState!==v.CLOSED){if(this.readyState===v.CONNECTING){let t="WebSocket was closed before the connection was established";return ae(this,this._req,t)}this._socket&&(this._readyState=v.CLOSING,this._socket.destroy())}}};Object.defineProperty(v,"CONNECTING",{enumerable:!0,value:Ie.indexOf("CONNECTING")});Object.defineProperty(v.prototype,"CONNECTING",{enumerable:!0,value:Ie.indexOf("CONNECTING")});Object.defineProperty(v,"OPEN",{enumerable:!0,value:Ie.indexOf("OPEN")});Object.defineProperty(v.prototype,"OPEN",{enumerable:!0,value:Ie.indexOf("OPEN")});Object.defineProperty(v,"CLOSING",{enumerable:!0,value:Ie.indexOf("CLOSING")});Object.defineProperty(v.prototype,"CLOSING",{enumerable:!0,value:Ie.indexOf("CLOSING")});Object.defineProperty(v,"CLOSED",{enumerable:!0,value:Ie.indexOf("CLOSED")});Object.defineProperty(v.prototype,"CLOSED",{enumerable:!0,value:Ie.indexOf("CLOSED")});["binaryType","bufferedAmount","extensions","isPaused","protocol","readyState","url"].forEach(o=>{Object.defineProperty(v.prototype,o,{enumerable:!0})});["open","error","close","message"].forEach(o=>{Object.defineProperty(v.prototype,`on${o}`,{enumerable:!0,get(){for(let t of this.listeners(o))if(t[Oo])return t[Mf];return null},set(t){for(let n of this.listeners(o))if(n[Oo]){this.removeListener(o,n);break}typeof t=="function"&&this.addEventListener(o,t,{[Oo]:!0})}})});v.prototype.addEventListener=$f;v.prototype.removeEventListener=zf;Ia.exports=v;function Ba(o,t,n,s){let a={protocolVersion:Lo[1],maxPayload:104857600,skipUTF8Validation:!1,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10,...s,createConnection:void 0,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:void 0,host:void 0,path:void 0,port:void 0};if(!Lo.includes(a.protocolVersion))throw new RangeError(`Unsupported protocol version: ${a.protocolVersion} (supported versions: ${Lo.join(", ")})`);let l;if(t instanceof Bo)l=t,o._url=t.href;else{try{l=new Bo(t)}catch{throw new SyntaxError(`Invalid URL: ${t}`)}o._url=t}let f=l.protocol==="wss:",m=l.protocol==="ws+unix:",c;if(l.protocol!=="ws:"&&!f&&!m?c=`The URL's protocol must be one of "ws:", "wss:", or "ws+unix:"`:m&&!l.pathname?c="The URL's pathname is empty":l.hash&&(c="The URL contains a fragment identifier"),c){let T=new SyntaxError(c);if(o._redirects===0)throw T;Do(o,T);return}let h=f?443:80,b=Wf(16).toString("base64"),g=f?Of.get:Lf.get,w=new Set,S;if(a.createConnection=f?Xf:Qf,a.defaultPort=a.defaultPort||h,a.port=l.port||h,a.host=l.hostname.startsWith("[")?l.hostname.slice(1,-1):l.hostname,a.headers={"Sec-WebSocket-Version":a.protocolVersion,"Sec-WebSocket-Key":b,Connection:"Upgrade",Upgrade:"websocket",...a.headers},a.path=l.pathname+l.search,a.timeout=a.handshakeTimeout,a.perMessageDeflate&&(S=new Ke(a.perMessageDeflate!==!0?a.perMessageDeflate:{},!1,a.maxPayload),a.headers["Sec-WebSocket-Extensions"]=jf({[Ke.extensionName]:S.offer()})),n.length){for(let T of n){if(typeof T!="string"||!Vf.test(T)||w.has(T))throw new SyntaxError("An invalid or duplicated subprotocol was specified");w.add(T)}a.headers["Sec-WebSocket-Protocol"]=n.join(",")}if(a.origin&&(a.protocolVersion<13?a.headers["Sec-WebSocket-Origin"]=a.origin:a.headers.Origin=a.origin),(l.username||l.password)&&(a.auth=`${l.username}:${l.password}`),m){let T=a.path.split(":");a.socketPath=T[0],a.path=T[1]}let y=o._req=g(a);a.timeout&&y.on("timeout",()=>{ae(o,y,"Opening handshake has timed out")}),y.on("error",T=>{y===null||y.aborted||(y=o._req=null,Do(o,T))}),y.on("response",T=>{let P=T.headers.location,A=T.statusCode;if(P&&a.followRedirects&&A>=300&&A<400){if(++o._redirects>a.maxRedirects){ae(o,y,"Maximum redirects exceeded");return}y.abort();let D;try{D=new Bo(P,t)}catch{let W=new SyntaxError(`Invalid URL: ${P}`);Do(o,W);return}Ba(o,D,n,s)}else o.emit("unexpected-response",y,T)||ae(o,y,`Unexpected server response: ${T.statusCode}`)}),y.on("upgrade",(T,P,A)=>{if(o.emit("upgrade",T),o.readyState!==v.CONNECTING)return;y=o._req=null;let D=If("sha1").update(b+qf).digest("base64");if(T.headers["sec-websocket-accept"]!==D){ae(o,P,"Invalid Sec-WebSocket-Accept header");return}let q=T.headers["sec-websocket-protocol"],W;if(q!==void 0?w.size?w.has(q)||(W="Server sent an invalid subprotocol"):W="Server sent a subprotocol but none was requested":w.size&&(W="Server sent no subprotocol"),W){ae(o,P,W);return}q&&(o._protocol=q);let M=T.headers["sec-websocket-extensions"];if(M!==void 0){if(!S){ae(o,P,"Server sent a Sec-WebSocket-Extensions header but no extension was requested");return}let I;try{I=Hf(M)}catch{ae(o,P,"Invalid Sec-WebSocket-Extensions header");return}let fe=Object.keys(I);if(fe.length!==1||fe[0]!==Ke.extensionName){ae(o,P,"Server indicated an extension that was not requested");return}try{S.accept(I[Ke.extensionName])}catch{ae(o,P,"Invalid Sec-WebSocket-Extensions header");return}o._extensions[Ke.extensionName]=S}o.setSocket(P,A,{generateMask:a.generateMask,maxPayload:a.maxPayload,skipUTF8Validation:a.skipUTF8Validation})})}function Do(o,t){o._readyState=v.CLOSING,o.emit("error",t),o.emitClose()}function Qf(o){return o.path=o.socketPath,ka.connect(o)}function Xf(o){return o.path=void 0,!o.servername&&o.servername!==""&&(o.servername=ka.isIP(o.host)?"":o.host),Df.connect(o)}function ae(o,t,n){o._readyState=v.CLOSING;let s=new Error(n);Error.captureStackTrace(s,ae),t.setHeader?(t.abort(),t.socket&&!t.socket.destroyed&&t.socket.destroy(),t.once("abort",o.emitClose.bind(o)),o.emit("error",s)):(t.destroy(s),t.once("error",o.emit.bind(o,"error")),t.once("close",o.emitClose.bind(o)))}function Wo(o,t,n){if(t){let s=Gf(t).length;o._socket?o._sender._bufferedBytes+=s:o._bufferedAmount+=s}if(n){let s=new Error(`WebSocket is not open: readyState ${o.readyState} (${Ie[o.readyState]})`);n(s)}}function Kf(o,t){let n=this[V];n._closeFrameReceived=!0,n._closeMessage=t,n._closeCode=o,n._socket[V]!==void 0&&(n._socket.removeListener("data",gn),process.nextTick(Oa,n._socket),o===1005?n.close():n.close(o,t))}function Zf(){let o=this[V];o.isPaused||o._socket.resume()}function Jf(o){let t=this[V];t._socket[V]!==void 0&&(t._socket.removeListener("data",gn),process.nextTick(Oa,t._socket),t.close(o[Uf])),t.emit("error",o)}function Aa(){this[V].emitClose()}function ec(o,t){this[V].emit("message",o,t)}function tc(o){let t=this[V];t.pong(o,!t._isServer,xa),t.emit("ping",o)}function rc(o){this[V].emit("pong",o)}function Oa(o){o.resume()}function La(){let o=this[V];this.removeListener("close",La),this.removeListener("data",gn),this.removeListener("end",Da),o._readyState=v.CLOSING;let t;!this._readableState.endEmitted&&!o._closeFrameReceived&&!o._receiver._writableState.errorEmitted&&(t=o._socket.read())!==null&&o._receiver.write(t),o._receiver.end(),this[V]=void 0,clearTimeout(o._closeTimer),o._receiver._writableState.finished||o._receiver._writableState.errorEmitted?o.emitClose():(o._receiver.on("error",Aa),o._receiver.on("finish",Aa))}function gn(o){this[V]._receiver.write(o)||this.pause()}function Da(){let o=this[V];o._readyState=v.CLOSING,o._receiver.end(),this.end()}function Wa(){let o=this[V];this.removeListener("error",Wa),this.on("error",xa),o&&(o._readyState=v.CLOSING,this.destroy())}});var Ma=G((Qd,qa)=>{"use strict";var{Duplex:nc}=require("stream");function Fa(o){o.emit("close")}function oc(){!this.destroyed&&this._writableState.finished&&this.destroy()}function Na(o){this.removeListener("error",Na),this.destroy(),this.listenerCount("error")===0&&this.emit("error",o)}function sc(o,t){let n=!0,s=new nc({...t,autoDestroy:!1,emitClose:!1,objectMode:!1,writableObjectMode:!1});return o.on("message",function(l,f){let m=!f&&s._readableState.objectMode?l.toString():l;s.push(m)||o.pause()}),o.once("error",function(l){s.destroyed||(n=!1,s.destroy(l))}),o.once("close",function(){s.destroyed||s.push(null)}),s._destroy=function(a,l){if(o.readyState===o.CLOSED){l(a),process.nextTick(Fa,s);return}let f=!1;o.once("error",function(c){f=!0,l(c)}),o.once("close",function(){f||l(a),process.nextTick(Fa,s)}),n&&o.terminate()},s._final=function(a){if(o.readyState===o.CONNECTING){o.once("open",function(){s._final(a)});return}o._socket!==null&&(o._socket._writableState.finished?(a(),s._readableState.endEmitted&&s.destroy()):(o._socket.once("finish",function(){a()}),o.close()))},s._read=function(){o.isPaused&&o.resume()},s._write=function(a,l,f){if(o.readyState===o.CONNECTING){o.once("open",function(){s._write(a,l,f)});return}o.send(a,f)},s.on("end",oc),s.on("error",Na),s}qa.exports=sc});var $a=G((Xd,Ua)=>{"use strict";var{tokenChars:ic}=pr();function ac(o){let t=new Set,n=-1,s=-1,a=0;for(a;a<o.length;a++){let f=o.charCodeAt(a);if(s===-1&&ic[f]===1)n===-1&&(n=a);else if(a!==0&&(f===32||f===9))s===-1&&n!==-1&&(s=a);else if(f===44){if(n===-1)throw new SyntaxError(`Unexpected character at index ${a}`);s===-1&&(s=a);let m=o.slice(n,s);if(t.has(m))throw new SyntaxError(`The "${m}" subprotocol is duplicated`);t.add(m),n=s=-1}else throw new SyntaxError(`Unexpected character at index ${a}`)}if(n===-1||s!==-1)throw new SyntaxError("Unexpected end of input");let l=o.slice(n,a);if(t.has(l))throw new SyntaxError(`The "${l}" subprotocol is duplicated`);return t.add(l),t}Ua.exports={parse:ac}});var Ya=G((eh,Va)=>{"use strict";var lc=require("events"),Sn=require("http"),Kd=require("https"),Zd=require("net"),Jd=require("tls"),{createHash:uc}=require("crypto"),za=xo(),ct=mr(),fc=$a(),cc=Io(),{GUID:dc,kWebSocket:hc}=Qe(),mc=/^[+/0-9A-Za-z]{22}==$/,ja=0,Ha=1,Ga=2,Fo=class extends lc{constructor(t,n){if(super(),t={maxPayload:100*1024*1024,skipUTF8Validation:!1,perMessageDeflate:!1,handleProtocols:null,clientTracking:!0,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null,...t},t.port==null&&!t.server&&!t.noServer||t.port!=null&&(t.server||t.noServer)||t.server&&t.noServer)throw new TypeError('One and only one of the "port", "server", or "noServer" options must be specified');if(t.port!=null?(this._server=Sn.createServer((s,a)=>{let l=Sn.STATUS_CODES[426];a.writeHead(426,{"Content-Length":l.length,"Content-Type":"text/plain"}),a.end(l)}),this._server.listen(t.port,t.host,t.backlog,n)):t.server&&(this._server=t.server),this._server){let s=this.emit.bind(this,"connection");this._removeListeners=pc(this._server,{listening:this.emit.bind(this,"listening"),error:this.emit.bind(this,"error"),upgrade:(a,l,f)=>{this.handleUpgrade(a,l,f,s)}})}t.perMessageDeflate===!0&&(t.perMessageDeflate={}),t.clientTracking&&(this.clients=new Set,this._shouldEmitClose=!1),this.options=t,this._state=ja}address(){if(this.options.noServer)throw new Error('The server is operating in "noServer" mode');return this._server?this._server.address():null}close(t){if(this._state===Ga){t&&this.once("close",()=>{t(new Error("The server is not running"))}),process.nextTick(gr,this);return}if(t&&this.once("close",t),this._state!==Ha)if(this._state=Ha,this.options.noServer||this.options.server)this._server&&(this._removeListeners(),this._removeListeners=this._server=null),this.clients?this.clients.size?this._shouldEmitClose=!0:process.nextTick(gr,this):process.nextTick(gr,this);else{let n=this._server;this._removeListeners(),this._removeListeners=this._server=null,n.close(()=>{gr(this)})}}shouldHandle(t){if(this.options.path){let n=t.url.indexOf("?");if((n!==-1?t.url.slice(0,n):t.url)!==this.options.path)return!1}return!0}handleUpgrade(t,n,s,a){n.on("error",No);let l=t.headers["sec-websocket-key"]!==void 0?t.headers["sec-websocket-key"]:!1,f=+t.headers["sec-websocket-version"];if(t.method!=="GET"||t.headers.upgrade.toLowerCase()!=="websocket"||!l||!mc.test(l)||f!==8&&f!==13||!this.shouldHandle(t))return Dt(n,400);let m=t.headers["sec-websocket-protocol"],c=new Set;if(m!==void 0)try{c=fc.parse(m)}catch{return Dt(n,400)}let h=t.headers["sec-websocket-extensions"],b={};if(this.options.perMessageDeflate&&h!==void 0){let g=new ct(this.options.perMessageDeflate,!0,this.options.maxPayload);try{let w=za.parse(h);w[ct.extensionName]&&(g.accept(w[ct.extensionName]),b[ct.extensionName]=g)}catch{return Dt(n,400)}}if(this.options.verifyClient){let g={origin:t.headers[`${f===8?"sec-websocket-origin":"origin"}`],secure:!!(t.socket.authorized||t.socket.encrypted),req:t};if(this.options.verifyClient.length===2){this.options.verifyClient(g,(w,S,y,T)=>{if(!w)return Dt(n,S||401,y,T);this.completeUpgrade(b,l,c,t,n,s,a)});return}if(!this.options.verifyClient(g))return Dt(n,401)}this.completeUpgrade(b,l,c,t,n,s,a)}completeUpgrade(t,n,s,a,l,f,m){if(!l.readable||!l.writable)return l.destroy();if(l[hc])throw new Error("server.handleUpgrade() was called more than once with the same socket, possibly due to a misconfiguration");if(this._state>ja)return Dt(l,503);let c=uc("sha1").update(n+dc).digest("base64"),h=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade",`Sec-WebSocket-Accept: ${c}`],b=new cc(null);if(s.size){let g=this.options.handleProtocols?this.options.handleProtocols(s,a):s.values().next().value;g&&(h.push(`Sec-WebSocket-Protocol: ${g}`),b._protocol=g)}if(t[ct.extensionName]){let g=t[ct.extensionName].params,w=za.format({[ct.extensionName]:[g]});h.push(`Sec-WebSocket-Extensions: ${w}`),b._extensions=t}this.emit("headers",h,a),l.write(h.concat(`\r
`).join(`\r
`)),l.removeListener("error",No),b.setSocket(l,f,{maxPayload:this.options.maxPayload,skipUTF8Validation:this.options.skipUTF8Validation}),this.clients&&(this.clients.add(b),b.on("close",()=>{this.clients.delete(b),this._shouldEmitClose&&!this.clients.size&&process.nextTick(gr,this)})),m(b,a)}};Va.exports=Fo;function pc(o,t){for(let n of Object.keys(t))o.on(n,t[n]);return function(){for(let s of Object.keys(t))o.removeListener(s,t[s])}}function gr(o){o._state=Ga,o.emit("close")}function No(){this.destroy()}function Dt(o,t,n,s){o.writable&&(n=n||Sn.STATUS_CODES[t],s={Connection:"close","Content-Type":"text/html","Content-Length":Buffer.byteLength(n),...s},o.write(`HTTP/1.1 ${t} ${Sn.STATUS_CODES[t]}\r
`+Object.keys(s).map(a=>`${a}: ${s[a]}`).join(`\r
`)+`\r
\r
`+n)),o.removeListener("error",No),o.destroy()}});var Xa=G((th,Qa)=>{"use strict";var Fe=Io();Fe.createWebSocketStream=Ma();Fe.Server=Ya();Fe.Receiver=vo();Fe.Sender=Ao();Fe.WebSocket=Fe;Fe.WebSocketServer=Fe.Server;Qa.exports=Fe});var Cc={};ii(Cc,{default:()=>il});module.exports=Fu(Cc);var C=require("@raycast/api"),Bt=require("react");var Ve=require("@raycast/api");var Ii=st(require("node:http"),1),Fi=st(require("node:https"),1),ut=st(require("node:zlib"),1),ne=st(require("node:stream"),1);function Nu(o){if(!/^data:/i.test(o))throw new TypeError('`uri` does not appear to be a Data URI (must begin with "data:")');o=o.replace(/\r?\n/g,"");let t=o.indexOf(",");if(t===-1||t<=4)throw new TypeError("malformed data: URI");let n=o.substring(5,t).split(";"),s="",a=!1,l=n[0]||"text/plain",f=l;for(let b=1;b<n.length;b++)n[b]==="base64"?a=!0:(f+=`;${n[b]}`,n[b].indexOf("charset=")===0&&(s=n[b].substring(8)));!n[0]&&!s.length&&(f+=";charset=US-ASCII",s="US-ASCII");let m=a?"base64":"ascii",c=unescape(o.substring(t+1)),h=Buffer.from(c,m);return h.type=l,h.typeFull=f,h.charset=s,h}var li=Nu;var pe=st(require("node:stream"),1),Pt=require("node:util");tr();lo();var Be=class extends Error{constructor(t,n){super(t),Error.captureStackTrace(this,this.constructor),this.type=n}get name(){return this.constructor.name}get[Symbol.toStringTag](){return this.constructor.name}};var re=class extends Be{constructor(t,n,s){super(t,n),s&&(this.code=this.errno=s.code,this.erroredSysCall=s.syscall)}};var rn=Symbol.toStringTag,uo=o=>typeof o=="object"&&typeof o.append=="function"&&typeof o.delete=="function"&&typeof o.get=="function"&&typeof o.getAll=="function"&&typeof o.has=="function"&&typeof o.set=="function"&&typeof o.sort=="function"&&o[rn]==="URLSearchParams",or=o=>o&&typeof o=="object"&&typeof o.arrayBuffer=="function"&&typeof o.type=="string"&&typeof o.stream=="function"&&typeof o.constructor=="function"&&/^(Blob|File)$/.test(o[rn]),bi=o=>typeof o=="object"&&(o[rn]==="AbortSignal"||o[rn]==="EventTarget");var Z=Symbol("Body internals"),ge=class{constructor(t,{size:n=0}={}){let s=null;t===null?t=null:uo(t)?t=Buffer.from(t.toString()):or(t)||Buffer.isBuffer(t)||(Pt.types.isAnyArrayBuffer(t)?t=Buffer.from(t):ArrayBuffer.isView(t)?t=Buffer.from(t.buffer,t.byteOffset,t.byteLength):t instanceof pe.default||(t instanceof Ct?(t=_i(t),s=t.type.split("=")[1]):t=Buffer.from(String(t))));let a=t;Buffer.isBuffer(t)?a=pe.default.Readable.from(t):or(t)&&(a=pe.default.Readable.from(t.stream())),this[Z]={body:t,stream:a,boundary:s,disturbed:!1,error:null},this.size=n,t instanceof pe.default&&t.on("error",l=>{let f=l instanceof Be?l:new re(`Invalid response body while trying to fetch ${this.url}: ${l.message}`,"system",l);this[Z].error=f})}get body(){return this[Z].stream}get bodyUsed(){return this[Z].disturbed}async arrayBuffer(){let{buffer:t,byteOffset:n,byteLength:s}=await an(this);return t.slice(n,n+s)}async formData(){let t=this.headers.get("content-type");if(t.startsWith("application/x-www-form-urlencoded")){let s=new Ct,a=new URLSearchParams(await this.text());for(let[l,f]of a)s.append(l,f);return s}let{toFormData:n}=await Promise.resolve().then(()=>(Ri(),wi));return n(this.body,t)}async blob(){let t=this.headers&&this.headers.get("content-type")||this[Z].body&&this[Z].body.type||"",n=await this.buffer();return new it([n],{type:t})}async json(){let t=await an(this);return JSON.parse(t.toString())}async text(){return(await an(this)).toString()}buffer(){return an(this)}};ge.prototype.buffer=(0,Pt.deprecate)(ge.prototype.buffer,"Please use 'response.arrayBuffer()' instead of 'response.buffer()'","node-fetch#buffer");Object.defineProperties(ge.prototype,{body:{enumerable:!0},bodyUsed:{enumerable:!0},arrayBuffer:{enumerable:!0},blob:{enumerable:!0},json:{enumerable:!0},text:{enumerable:!0}});async function an(o){if(o[Z].disturbed)throw new TypeError(`body used already for: ${o.url}`);if(o[Z].disturbed=!0,o[Z].error)throw o[Z].error;let{body:t}=o;if(t===null||!(t instanceof pe.default))return Buffer.alloc(0);let n=[],s=0;try{for await(let a of t){if(o.size>0&&s+a.length>o.size){let l=new re(`content size at ${o.url} over limit: ${o.size}`,"max-size");throw t.destroy(l),l}s+=a.length,n.push(a)}}catch(a){throw a instanceof Be?a:new re(`Invalid response body while trying to fetch ${o.url}: ${a.message}`,"system",a)}if(t.readableEnded===!0||t._readableState.ended===!0)try{return n.every(a=>typeof a=="string")?Buffer.from(n.join("")):Buffer.concat(n,s)}catch(a){throw new re(`Could not create Buffer from response body for ${o.url}: ${a.message}`,"system",a)}else throw new re(`Premature close of server response while trying to fetch ${o.url}`)}var vt=(o,t)=>{let n,s,{body:a}=o[Z];if(o.bodyUsed)throw new Error("cannot clone body after it is used");return a instanceof pe.default&&typeof a.getBoundary!="function"&&(n=new pe.PassThrough({highWaterMark:t}),s=new pe.PassThrough({highWaterMark:t}),a.pipe(n),a.pipe(s),o[Z].stream=n,a=s),a},ef=(0,Pt.deprecate)(o=>o.getBoundary(),"form-data doesn't follow the spec and requires special treatment. Use alternative package","https://github.com/node-fetch/node-fetch/issues/1167"),ln=(o,t)=>o===null?null:typeof o=="string"?"text/plain;charset=UTF-8":uo(o)?"application/x-www-form-urlencoded;charset=UTF-8":or(o)?o.type||null:Buffer.isBuffer(o)||Pt.types.isAnyArrayBuffer(o)||ArrayBuffer.isView(o)?null:o instanceof Ct?`multipart/form-data; boundary=${t[Z].boundary}`:o&&typeof o.getBoundary=="function"?`multipart/form-data;boundary=${ef(o)}`:o instanceof pe.default?null:"text/plain;charset=UTF-8",Ti=o=>{let{body:t}=o[Z];return t===null?0:or(t)?t.size:Buffer.isBuffer(t)?t.length:t&&typeof t.getLengthSync=="function"&&t.hasKnownLength&&t.hasKnownLength()?t.getLengthSync():null},Ei=(o,{body:t})=>{t===null?o.end():t.pipe(o)};var co=require("node:util"),ar=st(require("node:http"),1),un=typeof ar.default.validateHeaderName=="function"?ar.default.validateHeaderName:o=>{if(!/^[\^`\-\w!#$%&'*+.|~]+$/.test(o)){let t=new TypeError(`Header name must be a valid HTTP token [${o}]`);throw Object.defineProperty(t,"code",{value:"ERR_INVALID_HTTP_TOKEN"}),t}},ho=typeof ar.default.validateHeaderValue=="function"?ar.default.validateHeaderValue:(o,t)=>{if(/[^\t\u0020-\u007E\u0080-\u00FF]/.test(t)){let n=new TypeError(`Invalid character in header content ["${o}"]`);throw Object.defineProperty(n,"code",{value:"ERR_INVALID_CHAR"}),n}},J=class extends URLSearchParams{constructor(t){let n=[];if(t instanceof J){let s=t.raw();for(let[a,l]of Object.entries(s))n.push(...l.map(f=>[a,f]))}else if(t!=null)if(typeof t=="object"&&!co.types.isBoxedPrimitive(t)){let s=t[Symbol.iterator];if(s==null)n.push(...Object.entries(t));else{if(typeof s!="function")throw new TypeError("Header pairs must be iterable");n=[...t].map(a=>{if(typeof a!="object"||co.types.isBoxedPrimitive(a))throw new TypeError("Each header pair must be an iterable object");return[...a]}).map(a=>{if(a.length!==2)throw new TypeError("Each header pair must be a name/value tuple");return[...a]})}}else throw new TypeError("Failed to construct 'Headers': The provided value is not of type '(sequence<sequence<ByteString>> or record<ByteString, ByteString>)");return n=n.length>0?n.map(([s,a])=>(un(s),ho(s,String(a)),[String(s).toLowerCase(),String(a)])):void 0,super(n),new Proxy(this,{get(s,a,l){switch(a){case"append":case"set":return(f,m)=>(un(f),ho(f,String(m)),URLSearchParams.prototype[a].call(s,String(f).toLowerCase(),String(m)));case"delete":case"has":case"getAll":return f=>(un(f),URLSearchParams.prototype[a].call(s,String(f).toLowerCase()));case"keys":return()=>(s.sort(),new Set(URLSearchParams.prototype.keys.call(s)).keys());default:return Reflect.get(s,a,l)}}})}get[Symbol.toStringTag](){return this.constructor.name}toString(){return Object.prototype.toString.call(this)}get(t){let n=this.getAll(t);if(n.length===0)return null;let s=n.join(", ");return/^content-encoding$/i.test(t)&&(s=s.toLowerCase()),s}forEach(t,n=void 0){for(let s of this.keys())Reflect.apply(t,n,[this.get(s),s,this])}*values(){for(let t of this.keys())yield this.get(t)}*entries(){for(let t of this.keys())yield[t,this.get(t)]}[Symbol.iterator](){return this.entries()}raw(){return[...this.keys()].reduce((t,n)=>(t[n]=this.getAll(n),t),{})}[Symbol.for("nodejs.util.inspect.custom")](){return[...this.keys()].reduce((t,n)=>{let s=this.getAll(n);return n==="host"?t[n]=s[0]:t[n]=s.length>1?s:s[0],t},{})}};Object.defineProperties(J.prototype,["get","entries","forEach","values"].reduce((o,t)=>(o[t]={enumerable:!0},o),{}));function Ci(o=[]){return new J(o.reduce((t,n,s,a)=>(s%2===0&&t.push(a.slice(s,s+2)),t),[]).filter(([t,n])=>{try{return un(t),ho(t,String(n)),!0}catch{return!1}}))}var tf=new Set([301,302,303,307,308]),fn=o=>tf.has(o);var _e=Symbol("Response internals"),X=class extends ge{constructor(t=null,n={}){super(t,n);let s=n.status!=null?n.status:200,a=new J(n.headers);if(t!==null&&!a.has("Content-Type")){let l=ln(t,this);l&&a.append("Content-Type",l)}this[_e]={type:"default",url:n.url,status:s,statusText:n.statusText||"",headers:a,counter:n.counter,highWaterMark:n.highWaterMark}}get type(){return this[_e].type}get url(){return this[_e].url||""}get status(){return this[_e].status}get ok(){return this[_e].status>=200&&this[_e].status<300}get redirected(){return this[_e].counter>0}get statusText(){return this[_e].statusText}get headers(){return this[_e].headers}get highWaterMark(){return this[_e].highWaterMark}clone(){return new X(vt(this,this.highWaterMark),{type:this.type,url:this.url,status:this.status,statusText:this.statusText,headers:this.headers,ok:this.ok,redirected:this.redirected,size:this.size,highWaterMark:this.highWaterMark})}static redirect(t,n=302){if(!fn(n))throw new RangeError('Failed to execute "redirect" on "response": Invalid status code');return new X(null,{headers:{location:new URL(t).toString()},status:n})}static error(){let t=new X(null,{status:0,statusText:""});return t[_e].type="error",t}get[Symbol.toStringTag](){return"Response"}};Object.defineProperties(X.prototype,{type:{enumerable:!0},url:{enumerable:!0},status:{enumerable:!0},ok:{enumerable:!0},redirected:{enumerable:!0},statusText:{enumerable:!0},headers:{enumerable:!0},clone:{enumerable:!0}});var Di=require("node:url");var Pi=o=>{if(o.search)return o.search;let t=o.href.length-1,n=o.hash||(o.href[t]==="#"?"#":"");return o.href[t-n.length]==="?"?"?":""};var Ai=require("net");function vi(o,t=!1){return o==null||(o=new URL(o),/^(about|blob|data):$/.test(o.protocol))?"no-referrer":(o.username="",o.password="",o.hash="",t&&(o.pathname="",o.search=""),o)}var ki=new Set(["","no-referrer","no-referrer-when-downgrade","same-origin","origin","strict-origin","origin-when-cross-origin","strict-origin-when-cross-origin","unsafe-url"]),xi="strict-origin-when-cross-origin";function Bi(o){if(!ki.has(o))throw new TypeError(`Invalid referrerPolicy: ${o}`);return o}function rf(o){if(/^(http|ws)s:$/.test(o.protocol))return!0;let t=o.host.replace(/(^\[)|(]$)/g,""),n=(0,Ai.isIP)(t);return n===4&&/^127\./.test(t)||n===6&&/^(((0+:){7})|(::(0+:){0,6}))0*1$/.test(t)?!0:/^(.+\.)*localhost$/.test(o.host)?!1:o.protocol==="file:"}function At(o){return/^about:(blank|srcdoc)$/.test(o)||o.protocol==="data:"||/^(blob|filesystem):$/.test(o.protocol)?!0:rf(o)}function Oi(o,{referrerURLCallback:t,referrerOriginCallback:n}={}){if(o.referrer==="no-referrer"||o.referrerPolicy==="")return null;let s=o.referrerPolicy;if(o.referrer==="about:client")return"no-referrer";let a=o.referrer,l=vi(a),f=vi(a,!0);l.toString().length>4096&&(l=f),t&&(l=t(l)),n&&(f=n(f));let m=new URL(o.url);switch(s){case"no-referrer":return"no-referrer";case"origin":return f;case"unsafe-url":return l;case"strict-origin":return At(l)&&!At(m)?"no-referrer":f.toString();case"strict-origin-when-cross-origin":return l.origin===m.origin?l:At(l)&&!At(m)?"no-referrer":f;case"same-origin":return l.origin===m.origin?l:"no-referrer";case"origin-when-cross-origin":return l.origin===m.origin?l:f;case"no-referrer-when-downgrade":return At(l)&&!At(m)?"no-referrer":l;default:throw new TypeError(`Invalid referrerPolicy: ${s}`)}}function Li(o){let t=(o.get("referrer-policy")||"").split(/[,\s]+/),n="";for(let s of t)s&&ki.has(s)&&(n=s);return n}var j=Symbol("Request internals"),cn=o=>typeof o=="object"&&typeof o[j]=="object",Oe=class extends ge{constructor(t,n={}){let s;if(cn(t)?s=new URL(t.url):(s=new URL(t),t={}),s.username!==""||s.password!=="")throw new TypeError(`${s} is an url with embedded credentails.`);let a=n.method||t.method||"GET";if(a=a.toUpperCase(),(n.body!=null||cn(t))&&t.body!==null&&(a==="GET"||a==="HEAD"))throw new TypeError("Request with GET/HEAD method cannot have body");let l=n.body?n.body:cn(t)&&t.body!==null?vt(t):null;super(l,{size:n.size||t.size||0});let f=new J(n.headers||t.headers||{});if(l!==null&&!f.has("Content-Type")){let h=ln(l,this);h&&f.set("Content-Type",h)}let m=cn(t)?t.signal:null;if("signal"in n&&(m=n.signal),m!=null&&!bi(m))throw new TypeError("Expected signal to be an instanceof AbortSignal or EventTarget");let c=n.referrer==null?t.referrer:n.referrer;if(c==="")c="no-referrer";else if(c){let h=new URL(c);c=/^about:(\/\/)?client$/.test(h)?"client":h}else c=void 0;this[j]={method:a,redirect:n.redirect||t.redirect||"follow",headers:f,parsedURL:s,signal:m,referrer:c},this.follow=n.follow===void 0?t.follow===void 0?20:t.follow:n.follow,this.compress=n.compress===void 0?t.compress===void 0?!0:t.compress:n.compress,this.counter=n.counter||t.counter||0,this.agent=n.agent||t.agent,this.highWaterMark=n.highWaterMark||t.highWaterMark||16384,this.insecureHTTPParser=n.insecureHTTPParser||t.insecureHTTPParser||!1,this.referrerPolicy=n.referrerPolicy||t.referrerPolicy||""}get method(){return this[j].method}get url(){return(0,Di.format)(this[j].parsedURL)}get headers(){return this[j].headers}get redirect(){return this[j].redirect}get signal(){return this[j].signal}get referrer(){if(this[j].referrer==="no-referrer")return"";if(this[j].referrer==="client")return"about:client";if(this[j].referrer)return this[j].referrer.toString()}get referrerPolicy(){return this[j].referrerPolicy}set referrerPolicy(t){this[j].referrerPolicy=Bi(t)}clone(){return new Oe(this)}get[Symbol.toStringTag](){return"Request"}};Object.defineProperties(Oe.prototype,{method:{enumerable:!0},url:{enumerable:!0},headers:{enumerable:!0},redirect:{enumerable:!0},clone:{enumerable:!0},signal:{enumerable:!0},referrer:{enumerable:!0},referrerPolicy:{enumerable:!0}});var Wi=o=>{let{parsedURL:t}=o[j],n=new J(o[j].headers);n.has("Accept")||n.set("Accept","*/*");let s=null;if(o.body===null&&/^(post|put)$/i.test(o.method)&&(s="0"),o.body!==null){let m=Ti(o);typeof m=="number"&&!Number.isNaN(m)&&(s=String(m))}s&&n.set("Content-Length",s),o.referrerPolicy===""&&(o.referrerPolicy=xi),o.referrer&&o.referrer!=="no-referrer"?o[j].referrer=Oi(o):o[j].referrer="no-referrer",o[j].referrer instanceof URL&&n.set("Referer",o.referrer),n.has("User-Agent")||n.set("User-Agent","node-fetch"),o.compress&&!n.has("Accept-Encoding")&&n.set("Accept-Encoding","gzip,deflate,br");let{agent:a}=o;typeof a=="function"&&(a=a(t)),!n.has("Connection")&&!a&&n.set("Connection","close");let l=Pi(t),f={path:t.pathname+l,method:o.method,headers:n[Symbol.for("nodejs.util.inspect.custom")](),insecureHTTPParser:o.insecureHTTPParser,agent:a};return{parsedURL:t,options:f}};var dn=class extends Be{constructor(t,n="aborted"){super(t,n)}};var nf=new Set(["data:","http:","https:"]);async function hn(o,t){return new Promise((n,s)=>{let a=new Oe(o,t),{parsedURL:l,options:f}=Wi(a);if(!nf.has(l.protocol))throw new TypeError(`node-fetch cannot load ${o}. URL scheme "${l.protocol.replace(/:$/,"")}" is not supported.`);if(l.protocol==="data:"){let y=li(a.url),T=new X(y,{headers:{"Content-Type":y.typeFull}});n(T);return}let m=(l.protocol==="https:"?Fi.default:Ii.default).request,{signal:c}=a,h=null,b=()=>{let y=new dn("The operation was aborted.");s(y),a.body&&a.body instanceof ne.default.Readable&&a.body.destroy(y),!(!h||!h.body)&&h.body.emit("error",y)};if(c&&c.aborted){b();return}let g=()=>{b(),S()},w=m(l,f);c&&c.addEventListener("abort",g);let S=()=>{w.abort(),c&&c.removeEventListener("abort",g)};w.on("error",y=>{s(new re(`request to ${a.url} failed, reason: ${y.message}`,"system",y)),S()}),of(w,y=>{h.body.destroy(y)}),process.version<"v14"&&w.on("socket",y=>{let T;y.prependListener("end",()=>{T=y._eventsCount}),y.prependListener("close",P=>{if(h&&T<y._eventsCount&&!P){let A=new Error("Premature close");A.code="ERR_STREAM_PREMATURE_CLOSE",h.body.emit("error",A)}})}),w.on("response",y=>{w.setTimeout(0);let T=Ci(y.rawHeaders);if(fn(y.statusCode)){let W=T.get("Location"),M=W===null?null:new URL(W,a.url);switch(a.redirect){case"error":s(new re(`uri requested responds with a redirect, redirect mode is set to error: ${a.url}`,"no-redirect")),S();return;case"manual":M!==null&&T.set("Location",M);break;case"follow":{if(M===null)break;if(a.counter>=a.follow){s(new re(`maximum redirect reached at: ${a.url}`,"max-redirect")),S();return}let I={headers:new J(a.headers),follow:a.follow,counter:a.counter+1,agent:a.agent,compress:a.compress,method:a.method,body:vt(a),signal:a.signal,size:a.size,referrer:a.referrer,referrerPolicy:a.referrerPolicy};if(y.statusCode!==303&&a.body&&t.body instanceof ne.default.Readable){s(new re("Cannot follow redirect with body being a readable stream","unsupported-redirect")),S();return}(y.statusCode===303||(y.statusCode===301||y.statusCode===302)&&a.method==="POST")&&(I.method="GET",I.body=void 0,I.headers.delete("content-length"));let fe=Li(T);fe&&(I.referrerPolicy=fe),n(hn(new Oe(M,I))),S();return}default:return s(new TypeError(`Redirect option '${a.redirect}' is not a valid value of RequestRedirect`))}}c&&y.once("end",()=>{c.removeEventListener("abort",g)});let P=(0,ne.pipeline)(y,new ne.PassThrough,s);process.version<"v12.10"&&y.on("aborted",g);let A={url:a.url,status:y.statusCode,statusText:y.statusMessage,headers:T,size:a.size,counter:a.counter,highWaterMark:a.highWaterMark},D=T.get("Content-Encoding");if(!a.compress||a.method==="HEAD"||D===null||y.statusCode===204||y.statusCode===304){h=new X(P,A),n(h);return}let q={flush:ut.default.Z_SYNC_FLUSH,finishFlush:ut.default.Z_SYNC_FLUSH};if(D==="gzip"||D==="x-gzip"){P=(0,ne.pipeline)(P,ut.default.createGunzip(q),s),h=new X(P,A),n(h);return}if(D==="deflate"||D==="x-deflate"){(0,ne.pipeline)(y,new ne.PassThrough,s).once("data",M=>{P=(M[0]&15)===8?(0,ne.pipeline)(P,ut.default.createInflate(),s):(0,ne.pipeline)(P,ut.default.createInflateRaw(),s),h=new X(P,A),n(h)});return}if(D==="br"){P=(0,ne.pipeline)(P,ut.default.createBrotliDecompress(),s),h=new X(P,A),n(h);return}h=new X(P,A),n(h)}),Ei(w,a)})}function of(o,t){let n=Buffer.from(`0\r
\r
`),s=!1,a=!1,l;o.on("response",f=>{let{headers:m}=f;s=m["transfer-encoding"]==="chunked"&&!m["content-length"]}),o.on("socket",f=>{let m=()=>{if(s&&!a){let c=new Error("Premature close");c.code="ERR_STREAM_PREMATURE_CLOSE",t(c)}};f.prependListener("close",m),o.on("abort",()=>{f.removeListener("close",m)}),f.on("data",c=>{a=Buffer.compare(c.slice(-5),n)===0,!a&&l&&(a=Buffer.compare(l.slice(-3),n.slice(0,3))===0&&Buffer.compare(c.slice(-2),n.slice(3))===0),l=c})})}var po=require("url");var kt=require("@raycast/api");var lr=new Error("No avaliable backend"),mo=new Error("Current backend deleted"),Se=function(o){switch(o){case lr:{(0,kt.showToast)(kt.Toast.Style.Failure,lr.message,"Configure in 'Backends'");break}case mo:{(0,kt.showToast)(kt.Toast.Style.Failure,lr.message,"Configure in 'Backends'");break}default:console.error(o),ur("Request failed",o)}};var Ni=["B","KB","MB","GB","TB","PB","EB","ZB","YB"];function Ye(o){if(o<1e3)return o+" B";let t=Math.min(Math.floor(Math.log10(o)/3),Ni.length-1);o=Number((o/Math.pow(1e3,t)).toPrecision(3));let n=Ni[t];return o+" "+n}async function _o(){return await Ve.LocalStorage.getItem("current")}async function sf(o){return await Ve.LocalStorage.getItem(o)}async function qi(){let o=await _o();if(o){let t=await sf(o);if(t==null)throw mo;return[o,t]}else throw lr}async function xt({endpoint:o,method:t="GET",body:n}){let[s,a]=await qi(),l=new po.URL(s),f=`${Ui(l.href)}${o}`;return hn(f,{method:t,headers:a?{Authorization:`Bearer ${a}`}:{},body:n?JSON.stringify(n):void 0})}async function Mi(o,t={}){let[n,s]=await qi(),a=new po.URL(n);a.protocol==="https:"?a.protocol="wss:":a.protocol="ws:";let l=new URLSearchParams(t);l.set("token",s);let f="?"+l.toString();return`${Ui(a.href)}${o}${f}`}function Ui(o){return o.replace(/\/$/,"")}async function bo(o){await Ve.LocalStorage.setItem("current",o)}async function ur(o,t){console.error(o,t),await(0,Ve.showToast)(Ve.Toast.Style.Failure,o,t instanceof Error?t.message:t.toString())}function $i(o){return new Promise(t=>setTimeout(t,o))}function fr(o,t){let n=String(o);for(;n.length<t;)n="0"+n;return n}function af(o){let t=o.getFullYear()%100,n=fr(o.getMonth()+1,2),s=fr(o.getDate(),2),a=fr(o.getHours(),2),l=fr(o.getMinutes(),2),f=fr(o.getSeconds(),2);return`${t}-${n}-${s} ${a}:${l}:${f}`}function zi(){return af(new Date).toString()}function ji(o){return o.charAt(0).toUpperCase()+o.slice(1)}var H=require("react/jsx-runtime");async function lf(){return await C.LocalStorage.allItems()}async function uf(o,t){await C.LocalStorage.setItem(o,t)}async function ff(o){await C.LocalStorage.removeItem(o)}function yo(){let[o,t]=(0,Bt.useState)(0),{pop:n}=(0,C.useNavigation)(),[s,a]=(0,Bt.useState)({}),[l,f]=(0,Bt.useState)("");(0,Bt.useEffect)(()=>{(async()=>{let h=await _o();h&&f(h);let b=await lf();a(b)})()},[o]);let m=Object.entries(s).filter(([c])=>c!="current").sort((c,h)=>c[0].localeCompare(h[0]));return(0,H.jsxs)(C.List,{children:[m.map(([c,h],b)=>(0,H.jsx)(C.List.Item,{title:c,icon:{source:C.Icon.Circle,tintColor:c==l?C.Color.Green:C.Color.PrimaryText},subtitle:h&&h.length!=0?h:"(no secret)",accessoryTitle:c==l?"Current":"",actions:(0,H.jsxs)(C.ActionPanel,{children:[(0,H.jsx)(C.Action,{title:"Use Backend",onAction:async()=>{await bo(c),f(c)}}),(0,H.jsx)(C.Action,{title:"Remove",onAction:async()=>{await(0,C.confirmAlert)({title:"Delete this backend?",primaryAction:{title:"Confirm",onAction:async()=>{await ff(c),t(w=>w+1),(0,C.showToast)(C.Toast.Style.Success,"Delete Success",c)}}})}})]})},b)),(0,H.jsx)(C.List.Item,{title:"Add Backend",icon:{source:C.Icon.Plus,tintColor:C.Color.Blue},actions:(0,H.jsx)(C.ActionPanel,{children:(0,H.jsx)(C.Action.Push,{title:"Add Backend",target:(0,H.jsxs)(C.Form,{actions:(0,H.jsx)(C.ActionPanel,{children:(0,H.jsx)(C.Action.SubmitForm,{title:"Submit",onSubmit:async c=>{c.url.startsWith("http://")||c.url.startsWith("https://")?(await uf(c.url,c.secret),await bo(c.url),f(c.url),t(h=>h+1),(0,C.showToast)(C.Toast.Style.Success,"Add Success",c.url),n()):await(0,C.showToast)(C.Toast.Style.Failure,"invalid url")}})}),children:[(0,H.jsx)(C.Form.TextField,{id:"url",title:"url",defaultValue:"http://127.0.0.1:9090"}),(0,H.jsx)(C.Form.TextField,{id:"secret",title:"secret",defaultValue:""})]})})})},m.length),(0,H.jsx)(C.List.Item,{title:"Delete All Data",icon:{source:C.Icon.Trash,tintColor:C.Color.Red},actions:(0,H.jsx)(C.ActionPanel,{children:(0,H.jsx)(C.Action,{title:"Remove",onAction:async()=>{await(0,C.confirmAlert)({title:"Delete All Data?",primaryAction:{title:"Confirm",onAction:async()=>{await C.LocalStorage.clear(),t(h=>h+1),(0,C.showToast)(C.Toast.Style.Success,"Delete Success")}}})}})})},m.length+1)]})}var Ee=require("@raycast/api"),Wt=require("react");var Ne=require("react");var Te=require("react");var _c=Xa(),qo=[{key:0,value:"connecting"},{key:1,value:"connection ready"},{key:2,value:"connection is closing"},{key:3,value:"connection closed or error"}],bc=(o,t={})=>{let n=(0,Te.useRef)(null),s=(0,Te.useRef)(!0),[a,l]=(0,Te.useState)(0),[f,m]=(0,Te.useState)(""),[c,h]=(0,Te.useState)(""),[b,g]=(0,Te.useState)({key:0,value:"connecting"}),w=()=>{Mi(o,t).then(P=>{s.current&&m(P),n.current=new _c(P),n.current.onopen=A=>s.current&&g(qo[n.current?.readyState??0]),n.current.onclose=A=>{s.current&&g(qo[n.current?.readyState??0])},n.current.onerror=A=>{s.current&&g(qo[n.current?.readyState??0])},n.current.onmessage=A=>{s.current&&h(A.data.toString())}}).catch(Se)},S=()=>{(!n.current||n.current.readyState===3)&&w()},y=()=>{n.current?.close()},T=()=>{s.current&&a<=10&&(console.log(`reconnect after ${a}s(${a}/10)`),ur(`Reconnect after ${a}s(${a}/10)`,""),$i(a*1e3).then(()=>{console.log("reconnect"),s.current&&l(P=>P+1);try{y(),n.current=null,s.current&&w()}catch(P){ur("Websocket failed",P)}}))};return(0,Te.useEffect)(()=>(S(),()=>{n.current?.close(),s.current=!1}),[n]),{url:f,wsData:c,readyState:b,closeWebSocket:y,reconnect:T}},wn=bc;function Ka(){let[o,t]=(0,Ne.useState)({up:0,down:0}),{url:n,wsData:s,readyState:a,reconnect:l}=wn("/traffic");return(0,Ne.useEffect)(()=>{if(a.key===3&&l(),s){let f=JSON.parse(s);t(f)}},[s,a]),[n,o]}function Rn(){let[o,t]=(0,Ne.useState)({downloadTotal:0,uploadTotal:0,connections:[]}),{url:n,wsData:s,readyState:a,reconnect:l}=wn("/connections");return(0,Ne.useEffect)(()=>{if(a.key===3&&l(),s){let f=JSON.parse(s);t(f)}},[s,a]),[n,o]}function Za(o){let[t,n]=(0,Ne.useState)([]),{url:s,wsData:a,readyState:l,reconnect:f,closeWebSocket:m}=wn("/logs",{level:o});return(0,Ne.useEffect)(()=>{if(l.key===3&&f(),a){let c=JSON.parse(a);n(h=>[{...c,time:zi()},...h])}},[a,l]),(0,Ne.useEffect)(()=>{s&&(m(),f())},[o]),[s,t]}var oe=require("react/jsx-runtime");function yc(o,t){return`${t.metadata.host?t.metadata.host:t.metadata.destinationIP}:${t.metadata.destinationPort}`}function gc(o,t){return o?`${t.chains.join(" / ")}`:`${t.rule}(${t.rulePayload})`}function Sc(o,t){return o?`${Ye(t.download)} \u2193 ${Ye(t.upload)} \u2191`:`${t.metadata.type}(${t.metadata.network})`}function Mo(){let[o,t]=Rn(),[n,s]=(0,Wt.useState)(!0),[a,l]=(0,Wt.useState)(""),[f,m]=(0,Wt.useState)(t.connections);return(0,Wt.useEffect)(()=>{m(o?t.connections.filter(c=>c.metadata.host.includes(a)||c.metadata.destinationIP.includes(a)||c.metadata.destinationPort.includes(a)):[])},[a,t.connections.length]),(0,oe.jsx)(Ee.List,{enableFiltering:!1,onSearchTextChange:l,children:o?(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(Ee.List.Item,{title:"Host",subtitle:n?"Chains":"Rules",accessoryTitle:`${n?"Overview":"Detail"} Mode`,actions:(0,oe.jsx)(Ee.ActionPanel,{children:(0,oe.jsx)(Ee.Action,{title:"Switch Mode",onAction:()=>{s(c=>!c)}})})},-1),f.map((c,h)=>(0,oe.jsx)(Ee.List.Item,{title:yc(n,c),subtitle:gc(n,c),accessoryTitle:Sc(n,c),actions:(0,oe.jsx)(Ee.ActionPanel,{children:(0,oe.jsx)(Ee.Action,{title:"Switch Mode",onAction:()=>{s(b=>!b)}})})},h))]}):(0,oe.jsx)(oe.Fragment,{})})}var z=require("@raycast/api"),It=require("react");var ee=require("react/jsx-runtime"),Tn=["error","warning","info","debug"],wc={debug:z.Color.Green,info:z.Color.Blue,warning:z.Color.Yellow,error:z.Color.Red};function Uo(){let[o,t]=(0,It.useState)("info"),[n,s]=Za(o),[a,l]=(0,It.useState)(""),[f,m]=(0,It.useState)(s);return(0,It.useEffect)(()=>{m(n?s.filter(c=>c.payload.includes(a)):[])},[a,s.length]),(0,ee.jsx)(z.List,{enableFiltering:!1,onSearchTextChange:l,children:n?(0,ee.jsxs)(ee.Fragment,{children:[(0,ee.jsx)(z.List.Item,{title:"Time",subtitle:"Payload",accessoryTitle:`LogLevel(${o})`,actions:(0,ee.jsx)(z.ActionPanel,{children:(0,ee.jsx)(z.Action,{title:"Swith Level",onAction:()=>{t(c=>{let h=Tn.indexOf(c);return h>=Tn.length-1?Tn[0]:Tn[h+1]})}})})},-1),f.map((c,h)=>(0,ee.jsx)(z.List.Item,{icon:{source:z.Icon.Circle,tintColor:wc[c.type]},title:c.time?c.time:"",subtitle:c.payload,accessoryTitle:c.type,actions:(0,ee.jsx)(z.ActionPanel,{children:(0,ee.jsx)(z.Action.Push,{title:"Show Detail",target:(0,ee.jsx)(z.Detail,{markdown:`\`\`\`
${c.payload}
\`\`\``})})})},h))]}):(0,ee.jsx)(ee.Fragment,{})})}var se=require("@raycast/api");var le=require("react/jsx-runtime");function $o(){let[o,t]=Ka(),[n,s]=Rn();return(0,le.jsx)(se.List,{children:o&&n?(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)(se.List.Item,{icon:se.Icon.ChevronUp,title:"Upload",accessoryTitle:`${Ye(t.up)}/s`},"1"),(0,le.jsx)(se.List.Item,{icon:se.Icon.ChevronDown,title:"Download",accessoryTitle:`${Ye(t.down)}/s`},"2"),(0,le.jsx)(se.List.Item,{icon:se.Icon.Upload,title:"Upload Total",accessoryTitle:`${Ye(s.uploadTotal)}`},"3"),(0,le.jsx)(se.List.Item,{icon:se.Icon.Download,title:"Download Total",accessoryTitle:`${Ye(s.downloadTotal)}`},"4"),(0,le.jsx)(se.List.Item,{icon:se.Icon.LevelMeter,title:"Active Connections",accessoryTitle:`${s.connections.length}`},"5")]}):(0,le.jsx)(le.Fragment,{})})}var ue=require("@raycast/api"),Ze=require("react");async function Ja(){return(await(await xt({endpoint:"/proxies"})).json()).proxies}async function el(){return(await(await xt({endpoint:"/rules"})).json()).rules}async function tl(){return await(await xt({endpoint:"/configs"})).json()}async function rl(o){let t=await xt({endpoint:"/configs",method:"PATCH",body:o});if(t.status===400)throw new Error("Format error");if(t.status===404)throw new Error("Proxy not found");if(t.status!==204)throw new Error(`Unexpected status code: ${t.status}`)}async function nl(o,t){let n=await xt({endpoint:`/proxies/${o}`,method:"PUT",body:{name:t}});if(n.status===400)throw new Error("Format error");if(n.status===404)throw new Error("Proxy not found");if(n.status!==204)throw new Error(`Unexpected status code: ${n.status}`)}var Ce=require("react/jsx-runtime");function Rc({name:o,proxies:t,current:n,refresh:s,selectable:a}){let[l,f]=(0,Ze.useState)(n),[m,c]=(0,Ze.useState)(!1);return(0,Ce.jsx)(ue.List,{isLoading:m,children:t.map((h,b)=>a?(0,Ce.jsx)(ue.List.Item,{title:h,accessoryTitle:h==l?"Current":"",actions:(0,Ce.jsx)(ue.ActionPanel,{children:(0,Ce.jsx)(ue.Action,{title:"Select",onAction:async()=>{try{c(!0),await nl(o,h),s(),f(h)}catch(g){Se(g)}finally{c(!1)}}})})},b):(0,Ce.jsx)(ue.List.Item,{title:h,accessoryTitle:h==l?"Current":""},b))})}var Tc=["Selector","URLTest","Fallback","LoadBalance","Relay"];function zo(){let[o,t]=(0,Ze.useState)(!0),[n,s]=(0,Ze.useState)([]),[a,l]=(0,Ze.useState)(!1);return(0,Ze.useEffect)(()=>{(async()=>{try{t(!0);let m=await Ja(),c=[];for(let[b,g]of Object.entries(n))b==="GLOBAL"&&g.all&&(c=g.all);let h=Object.values(m).filter(({type:b})=>Tc.includes(b)).sort(({name:b},{name:g})=>c.indexOf(b)-c.indexOf(g));s(h)}catch(m){Se(m)}finally{t(!1)}})()},[a]),(0,Ce.jsx)(ue.List,{isLoading:o,children:n.map((f,m)=>(0,Ce.jsx)(ue.List.Item,{title:f.name,subtitle:f.type,accessoryTitle:f.now,actions:(0,Ce.jsx)(ue.ActionPanel,{children:(0,Ce.jsx)(ue.Action.Push,{title:"Show Proxies",target:(0,Ce.jsx)(Rc,{name:f.name,proxies:f.all,current:f.now,refresh:()=>l(!a),selectable:f.type=="Selector"})})})},m))})}var Sr=require("@raycast/api"),Ft=require("react");var En=require("react/jsx-runtime"),ol=["Domain","DomainSuffix","DomainKeyword","GeoIP","IPCIDR","SrcIPCIDR","SrcPort","DstPort","Process","ProcessPath","Match"];function jo(){let[o,t]=(0,Ft.useState)(!0),[n,s]=(0,Ft.useState)([]),[a,l]=(0,Ft.useState)(ol[0]);return(0,Ft.useEffect)(()=>{(async()=>{try{t(!0);let m=await el();s(m)}catch(m){Se(m)}finally{t(!1)}})()},[]),(0,En.jsx)(Sr.List,{isLoading:o,searchBarAccessory:(0,En.jsx)(Sr.List.Dropdown,{tooltip:"Type",storeValue:!1,onChange:f=>l(f),children:ol.map((f,m)=>(0,En.jsx)(Sr.List.Dropdown.Item,{title:f,value:f},m))}),children:n.filter(f=>f.type===a).map((f,m)=>(0,En.jsx)(Sr.List.Item,{title:f.payload,subtitle:f.type,accessoryTitle:f.proxy},m))})}var dt=require("@raycast/api"),Nt=require("react");var Cn=require("react/jsx-runtime"),Ec=["rule","global","direct","script"];function Ho(){let[o,t]=(0,Nt.useState)(!1),[n,s]=(0,Nt.useState)(""),[a,l]=(0,Nt.useState)(!1);return(0,Nt.useEffect)(()=>{(async()=>{try{t(!0);let m=await tl();s(m.mode)}catch(m){Se(m)}finally{t(!1)}})()},[a]),(0,Cn.jsx)(dt.List,{isLoading:o,children:Ec.map((f,m)=>(0,Cn.jsx)(dt.List.Item,{title:ji(f),accessoryTitle:f==n?"Current":"",actions:(0,Cn.jsx)(dt.ActionPanel,{children:(0,Cn.jsx)(dt.Action,{title:"Select",onAction:async()=>{try{t(!0),await rl({mode:f}),l(!a)}catch(c){Se(c)}finally{t(!1)}}})})},m))})}var sl={Overview:$o,Proxies:zo,Backends:yo,Conns:Mo,Rules:jo,Logs:Uo,Mode:Ho};var Pc=require("react/jsx-runtime");function il(){return(0,Pc.jsx)(sl.Mode,{})}0&&(module.exports={});
/*! fetch-blob. MIT License. Jimmy Wrting <https://jimmy.warting.se/opensource> */
/*! formdata-polyfill. MIT License. Jimmy Wrting <https://jimmy.warting.se/opensource> */
